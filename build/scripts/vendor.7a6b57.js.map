{"version":3,"sources":["webpack:///scripts/vendor.7a6b57.js","webpack:///external \"angular\"","webpack:///external \"jQuery\"","webpack:///./app/commons/wangEditor/js/wangEditor.js","webpack:///(webpack)/buildin/module.js","webpack:///./app/commons/wangEditor/css/wangEditor.css","webpack:///(webpack)/buildin/global.js","webpack:///./~/base64-js/index.js","webpack:///./~/buffer/index.js","webpack:///./~/css-loader/lib/css-base.js","webpack:///./app/commons/wangEditor/fonts/icomoon.svg","webpack:///./app/commons/wangEditor/fonts/icomoon.woff","webpack:///./app/commons/wangEditor/fonts/icomoon.eot","webpack:///./app/commons/wangEditor/fonts/icomoon.ttf","webpack:///./app/commons/wangEditor/wangEditorDirective.ts","webpack:///./~/style-loader/addStyles.js","webpack:///./~/style-loader/fixUrls.js","webpack:///./~/isarray/index.js","webpack:///./app/commons/wangEditor/fonts/icomoon.eot?3ee4","webpack:///./~/ieee754/index.js","webpack:///./app/commons/wangEditor/css/wangEditor.css?f4ea"],"names":["webpackJsonp","0","module","exports","angular","1","jQuery","1Ufw","__webpack_require__","_typeof","Symbol","iterator","obj","constructor","prototype","factory","window","define","amd","cmd","require","$","fn","jquery","alert","_e","E","wangEditor","elem","$elem","length","nodeName","this","valueNodeName","toLowerCase","$valueContainer","$prev","prev","$parent","parent","init","$body","$document","document","$window","userAgent","navigator","getComputedStyle","w3cRange","createRange","hostname","location","websiteHost","isOnWebsite","indexOf","docsite","plugin","_plugins","push","initDefaultConfig","addEditorContainer","addTxt","addMenuContainer","menus","commandHooks","ready","readyFns","readyHeadler","fns","shift","call","updateValue","editor","$txt","txt","value","html","val","getInitValue","currentValue","updateMenuStyle","each","k","menu","updateSelected","enableMenusExcept","menuIds","_disabled","disabled","disableMenusExcept","hideDropPanelAndModal","m","dropPanel","dropList","modal","hide","emptyFn","ieRange","currentRange","cr","_rangeData","collapseRange","range","opt","collapse","getRangeText","toString","getRangeElem","dom","commonAncestorContainer","nodeType","parentNode","isRangeEmpty","startContainer","endContainer","startOffset","endOffset","saveSelection","_parentElem","selection","self","get","getSelection","getRangeAt","rangeCount","contains","restoreSelection","removeAllRanges","addRange","ex","error","restoreSelectionByElem","setRangeByElem","initSelection","$firstChild","children","first","txtElem","firstTextNode","firstChild","lastTextNode","lastChild","setStart","setEnd","textContent","text","parentElement","setEndPoint","select","insertHtml","targetElem","rangeElem","getLegalTags","after","command","e","commandName","commandValue","callback","commandFn","queryCommandSupported","execCommand","hooks","customCommand","commandForElem","elemOpt","selector","check","getSelfOrParentByName","hidePanelAndModal","preventDefault","undoRecord","insertEmptyP","wrapImgAndText","setTimeout","queryCommandValue","result","queryCommandState","_matchesSelectorForIE","$elems","matchesSelector","legalTags","config","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","_getRedoList","_redoList","_getUndoList","_undoList","_handle","data","type","redo","undo","onchange","undoList","redoList","unshift","pop","create","addMenus","renderMenus","renderMenuContainer","renderTxt","renderEditorContainer","eventMenus","eventMenuContainer","eventTxt","disable","removeAttr","enable","attr","destroy","$editorContainer","show","undestroy","$menuContainer","menuContainer","clear","find","MenuContainer","changeShadow","on","scrollTop","addClass","removeClass","render","append","height","appendMenu","groupIdx","_addGroup","_addOneMenu","$menuGroup","$currentGroup","currentGroupIdx","$menuNormal","$domNormal","$menuSelected","$domSelected","$item","Menu","id","title","commandNameSelected","commandValueSelected","initUI","uiConfig","UI","menuId","menuUI","warn","normal","test","selected","clone","slice","$menuItem","onRender","_renderTip","$tip","$tempDiv","tipWidth","titleWidth","outerWidth","currentWidth","currentMarginLeft","parseFloat","css","remove","width","margin-left","timeoutId","active","clearTimeout","bindEvent","clickEvent","dropObj","isShowing","clickEventSelected","click","updateSelectedEvent","changeSelectedState","state","_activeState","activeStyle","$dom","DropList","tpl","selectorForELemCommand","beforeEvent","afterEvent","initDOM","initHideEvent","itemContent","$list","replace","currentTarget","thisList","menuDom","trigger","target","scroll","_render","rendered","_position","$menuDom","menuPosition","offsetParent","position","menuTop","top","menuLeft","left","menuHeight","menuWidth","listWidth","txtWidth","marginLeft","valWithTxt","_isMenufixed","offset","outerHeight","DropPanel","$content","$panel","$triangle","thisPanle","panelWidth","marginLeft2","focusFirstInput","$input","focus","placeholderForIE8","Modal","initDom","$modal","$close","zindex","marginTop","sTop","margin-top","Txt","contentEmptyHandle","bindEnterForDiv","bindEnterForText","bindTabEvent","bindPasteFilter","bindFormatText","bindHtml","$p","keyCode","trim","txtHtml","divHandler","$keydownDivElem","$pElem","$targetElem","handle","childNodesClone","childNodes","index","item","legalTagArr","resultHtml","getResult","removeAttrs","htmlForP","htmlForLi","tag","$li","attrs","attributes","attrNames","exception","key","removeAttribute","split","pasteFilter","currentNodeName","pasteHtml","$paste","docSplitHtml","clipboardData","originalEvent","ieData","pasteText","getData","match","link","RegExp","clearEmptyOrNestP","regArr","reg","formatText","$temp","matchStr","undefined","a","b","c","change","txtChangeEventNames","initHeight","valueContainerHeight","txtHeight","initMaxHeight","$wrap","maxHeight","parseInt","isNaN","fullscreen","useMaxHeight","max-height","overflow-y","min-height","wrap","saveSelectionEvent","save","saveSync","Date","now","dt","saveAync","off","updateValueEvent","doOnchange","oldValue","updateMenuStyleEvent","$children","last","i","childNode","$imgs","childrenLength","showHeightOnHover","addAndShowTip","$target","isTipInTxt","paddingTop","marginBottom","paddingBottom","removeTip","Array","lastIndexOf","valueOf","console","info","printLog","random","Math","placeholder","createElement","$container","langs","bold","underline","italic","forecolor","bgcolor","strikethrough","eraser","source","quote","fontfamily","fontsize","head","orderlist","unorderlist","alignleft","aligncenter","alignright","submit","cancel","unlink","table","emotion","img","uploadImg","linkImg","video","loading","searchlocation","dynamicMap","clearLocation","langDynamicOneLocation","insertcode","openLink","en","menuFixed","jsFilter","lang","colors","#880000","#800080","#ff0000","#ff00ff","#000080","#0000ff","#00ffff","#008080","#008000","#808000","#00ff00","#ffcc00","#808080","#c0c0c0","#000000","#ffffff","familys","fontsizes","2","3","4","5","6","7","emotionsShow","emotions","weibo","icon","mapAk","uploadImgUrl","uploadTimeout","uploadImgFns","customUpload","uploadParams","uploadHeaders","withCredentials","hideLinkImg","codeDefaultLang","default","extend","createMenuFns","createMenu","createMenuFn","configColors","v","join","checkElemFn","cssText","style","pElem","quoteElem","$quoteElem","listElem","$listElem","$clearElem","$code","$codeTextarea","isShowCode","txtOuterHeight","$quote","$rangeElem","currentQuote","$lastChild","isPrevEnter","currentRangeElem","$currentRangeElem","configFamilys","configSize","isOrderedList","<h1>","<h2>","<h3>","<h4>","<h5>","$div1","$div2","$div3","$textInput","$urlInput","$btnSubmit","$btnCancel","url","href","innerHTML","$linkElem","linkHtml","$oldLinks","$newLinks","uniqId","not","$a","$span","aElem","$tr","j","$table","$row","$rowspan","$col","$colspan","$currentTd","currentTdIndex","$currentTr","currentTrIndex","trIndex","$td","tdIndex","rownum","colnum","tableHtml","insertEmotionImgs","$tabContent","src","$command","$img","emotionUrls","configEmotions","$panelContent","$tabContainer","$contentContainer","log","$tab","parseJSON","Object","imgLoaded","_src","linkContentHandler","$linkContent","$urlContainer","imgHtml","tabToggle","$uploadTab","$uploadContent","$linkTab","hideUploadImg","customUploadInit","hidePanel","$linkInputContainer","$linkInput","$sizeContainer","$widthInput","$heightInput","$btnContainer","$howToCopy","$link","$div","inputKeyup","input","baiduMapAk","numberOfLocation","$searchInput","ak","mapData","markers","mapContainerId","clearLocations","map","clearOverlays","searchMap","myGeo","marker","BMap","cityName","$cityInput","locationName","centerAndZoom","Geocoder","getPoint","point","Marker","addOverlay","enableDragging","hasCallback","baiduMapCallBack","locationFun","name","setCenter","searchFn","is","currentCity","currentSearch","city","search","Map","Point","addControl","MapTypeControl","setCurrentCity","enableScrollWheelZoom","LocalCity","addEventListener","lng","lat","loadMapScript","script","body","appendChild","initMap","$inputContainer","text-align","$clearBtn","$map","border","$mapLoading","$checkLabel","$check","iframe","isDynamic","center","getCenter","centerLng","centerLat","zoom","getZoom","size","getSize","sizeWidth","sizeHeight","getPosition","firstTime","loadHljs","hljs","updateMenu","$textarea","listLanguages","$langSelect","className","$textareaContainer","margin","padding","codeTpl","doHightlight","langClass","block","$block","highlightBlock","ctrlKey","scrollTopWhenFullScreen","zIndex","zIndexConfig","isSelected","$wrapper","isFullScreen","prepend","onload","resultText","xhr","originalName","uploadImgOriginalName","onerror","ontimeout","FileReader","FormData","convertBase64UrlToBlob","urlData","filetype","bytes","atob","ab","ArrayBuffer","ia","Uint8Array","charCodeAt","Blob","insertImg","event","updateProgress","lengthComputable","percentComplete","loaded","total","showUploadProgress","xhrUploadImg","timeoutCallback","abort","timeoutfn","hideUploadProgress","fileName","filename","base64","fileType","loadfn","errorfn","params","headers","fileExt","XMLHttpRequest","formData","responseText","upload","onprogress","open","setRequestHeader","send","isRender","$progress","hideProgress","progress","time","$uploadIcon","upfile","UploadFile","uploadUrl","timeout","fileAccept","selectFiles","multiple","_hasRender","acceptTpl","multipleTpl","files","file","clearInput","uploadFileName","uploadImgFileName","reader","readAsDataURL","hideModal","iframeId","$iframe","$btn","$form","bindLoadEvent","onloadFn","iframeWindow","fileFullName","fileOriginalName","_hasBindLoad","contentWindow","attachEvent","findPasteImgAndUpload","flag","$imgsBeforePaste","pasteEvent","items","getAsFile","dragEvent","dataTransfer","isRendered","$toolbar","$delete","$zoomSmall","$zoomBig","cb","$currentTable","tablePosition","tableTop","tableLeft","tableHeight","tableWidth","txtTop","$currentTxt","stopPropagation","imgLink","$currentImg","currentLink","inLink","unwrap","bindToolbarEvent","bindDragEvent","$alignLeft","$alignCenter","$alignRight","$unLink","$linkBtnCancel","$linkBtnSubmit","$dragPoint","parents","mousemove","diffX","diffY","pageX","_x","pageY","_y","currentDragMarginLeft","dragMarginLeft","currentDragMarginTop","dragMarginTop","currentImgWidth","imgWidth","currentImggHeight","imgHeight","isOnDrag","imgPosition","imgTop","imgLeft","isEmotion","imgSrc","$triggerLink","setPosition","$currentLink","topResult","isShow","showTimeoutId","hideTimeoutId","showTimeoutIdByToolbar","hasClass","menuFixedFunc","editorTop","editorHeight","bodyMarginTop","menuCssPosition","menuCssTop","resize","p","indent","lineHeight","1.0","1.5","1.8","2.0","2.5","3.0","btnId","containerId","customUploadBtnId","customUploadContainerId","3IRH","webpackPolyfill","deprecate","paths","defineProperty","enumerable","l","Cgxu","DuR2","g","Function","eval","EKta","placeHoldersCount","b64","len","Error","byteLength","toByteArray","tmp","placeHolders","arr","Arr","L","revLookup","tripletToBase64","num","lookup","encodeChunk","uint8","start","end","output","fromByteArray","extraBytes","parts","len2","code","EuP9","global","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","__proto__","arg","encodingOrOffset","allocUnsafe","from","TypeError","fromArrayBuffer","fromString","fromObject","assertSize","alloc","fill","encoding","checked","string","isEncoding","actual","write","fromArrayLike","array","byteOffset","isBuffer","copy","buffer","isnan","isArray","SlowBuffer","isView","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","n","bidirectionalIndexOf","dir","arrayIndexOf","read","buf","indexSize","readUInt16BE","arrLength","valLength","String","foundIndex","found","hexWrite","Number","remaining","strLen","parsed","substr","utf8Write","blitBuffer","asciiWrite","asciiToBytes","latin1Write","base64Write","ucs2Write","utf16leToBytes","min","res","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","decodeCodePointsArray","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","apply","ret","out","toHex","checkOffset","ext","checkInt","max","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","ieee754","writeDouble","base64clean","str","stringtrim","INVALID_BASE64_RE","units","Infinity","leadSurrogate","byteArray","hi","lo","dst","INSPECT_MAX_BYTES","foo","subarray","poolSize","_augment","species","configurable","allocUnsafeSlow","_isBuffer","compare","x","y","concat","list","pos","swap16","swap32","swap64","arguments","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","FZ+f","cssWithMappingToString","useSourceMap","content","cssMapping","sourceMapping","toComment","sourceURLs","sources","sourceRoot","sourceMap","JSON","stringify","modules","mediaQuery","alreadyImportedModules","SY6W","Vdmf","ZB9v","bjMF","eZkf","contentEditable","restrict","scope","element","ngModel","readViewText","stripBr","$setViewValue","$render","$viewValue","$apply","directive","fjbf","addStylesToDom","styles","options","domStyle","stylesInDom","refs","addStyle","listToStyles","newStyles","media","part","insertStyleElement","styleElement","styleTarget","getElement","insertInto","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","removeStyleElement","removeChild","idx","splice","createStyleElement","attachTagAttrs","createLinkElement","linkElement","rel","keys","forEach","setAttribute","update","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","URL","createObjectURL","revokeObjectURL","btoa","updateLink","applyToTag","newObj","styleSheet","replaceText","cssNode","createTextNode","autoFixUrls","convertToAbsoluteUrls","fixUrls","unescape","encodeURIComponent","blob","oldSrc","isOldIE","memo","all","querySelector","DEBUG","newList","mayRemove","textStore","replacement","filter","Boolean","quY5","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","unquotedOrigUrl","o","$1","newUrl","sOR5","sP74","ujcs","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","s","NaN","rt","abs","LN2","x7Ro","locals"],"mappings":"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","file":"scripts/vendor.7a6b57.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 0:\n/***/ (function(module, exports) {\n\nmodule.exports = angular;\n\n/***/ }),\n\n/***/ 1:\n/***/ (function(module, exports) {\n\nmodule.exports = jQuery;\n\n/***/ }),\n\n/***/ \"1Ufw\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(module) {\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n(function (factory) {\n    if (typeof window.define === 'function') {\n        if (window.define.amd) {\n            // AMD模式\n            window.define('wangEditor', [\"jquery\"], factory);\n        } else if (window.define.cmd) {\n            // CMD模式\n            window.define(function (require, exports, module) {\n                return factory;\n            });\n        } else {\n            // 全局模式\n            factory(window.jQuery);\n        }\n    } else if (( false ? 'undefined' : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n        // commonjs\n\n        // 引用 css —— webapck\n        __webpack_require__(\"x7Ro\");\n        module.exports = factory(\n        // 传入 jquery ，支持使用 npm 方式或者自己定义jquery的路径\n        __webpack_require__(1));\n    } else {\n        // 全局模式\n        factory(window.jQuery);\n    }\n})(function ($) {\n\n    // 验证是否引用jquery\n    if (!$ || !$.fn || !$.fn.jquery) {\n        alert('在引用wangEditor.js之前，先引用jQuery，否则无法使用 wangEditor');\n        return;\n    }\n\n    // 定义扩展函数\n    var _e = function _e(fn) {\n        var E = window.wangEditor;\n        if (E) {\n            // 执行传入的函数\n            fn(E, $);\n        }\n    };\n    // 定义构造函数\n    (function (window, $) {\n        if (window.wangEditor) {\n            // 重复引用\n            alert('一个页面不能重复引用 wangEditor.js 或 wangEditor.min.js ！！！');\n            return;\n        }\n\n        // 编辑器（整体）构造函数\n        var E = function E(elem) {\n            // 支持 id 和 element 两种形式\n            if (typeof elem === 'string') {\n                elem = '#' + elem;\n            }\n\n            // ---------------获取基本节点------------------\n            var $elem = $(elem);\n            if ($elem.length !== 1) {\n                return;\n            }\n            var nodeName = $elem[0].nodeName;\n            if (nodeName !== 'TEXTAREA' && nodeName !== 'DIV') {\n                // 只能是 textarea 和 div ，其他类型的元素不行\n                return;\n            }\n            this.valueNodeName = nodeName.toLowerCase();\n            this.$valueContainer = $elem;\n\n            // 记录 elem 的 prev 和 parent（最后渲染 editor 要用到）\n            this.$prev = $elem.prev();\n            this.$parent = $elem.parent();\n\n            // ------------------初始化------------------\n            this.init();\n        };\n\n        E.fn = E.prototype;\n\n        E.$body = $('body');\n        E.$document = $(document);\n        E.$window = $(window);\n        E.userAgent = navigator.userAgent;\n        E.getComputedStyle = window.getComputedStyle;\n        E.w3cRange = typeof document.createRange === 'function';\n        E.hostname = location.hostname.toLowerCase();\n        E.websiteHost = 'wangeditor.github.io|www.wangeditor.com|wangeditor.coding.me';\n        E.isOnWebsite = E.websiteHost.indexOf(E.hostname) >= 0;\n        E.docsite = 'http://www.kancloud.cn/wangfupeng/wangeditor2/113961';\n\n        // 暴露给全局对象\n        window.wangEditor = E;\n\n        // 注册 plugin 事件，用于用户自定义插件\n        // 用户在引用 wangEditor.js 之后，还可以通过 E.plugin() 注入自定义函数，\n        // 该函数将会在 editor.create() 方法的最后一步执行\n        E.plugin = function (fn) {\n            if (!E._plugins) {\n                E._plugins = [];\n            }\n\n            if (typeof fn === 'function') {\n                E._plugins.push(fn);\n            }\n        };\n    })(window, $);\n    // editor 绑定事件\n    _e(function (E, $) {\n\n        E.fn.init = function () {\n\n            // 初始化 editor 默认配置\n            this.initDefaultConfig();\n\n            // 增加container\n            this.addEditorContainer();\n\n            // 增加编辑区域\n            this.addTxt();\n\n            // 增加menuContainer\n            this.addMenuContainer();\n\n            // 初始化菜单集合\n            this.menus = {};\n\n            // 初始化commandHooks\n            this.commandHooks();\n        };\n    });\n    // editor api\n    _e(function (E, $) {\n\n        // 预定义 ready 事件\n        E.fn.ready = function (fn) {\n\n            if (!this.readyFns) {\n                this.readyFns = [];\n            }\n\n            this.readyFns.push(fn);\n        };\n\n        // 处理ready事件\n        E.fn.readyHeadler = function () {\n            var fns = this.readyFns;\n\n            while (fns.length) {\n                fns.shift().call(this);\n            }\n        };\n\n        // 更新内容到 $valueContainer\n        E.fn.updateValue = function () {\n            var editor = this;\n            var $valueContainer = editor.$valueContainer;\n            var $txt = editor.txt.$txt;\n\n            if ($valueContainer === $txt) {\n                // 传入生成编辑器的div，即是编辑区域\n                return;\n            }\n\n            var value = $txt.html();\n            $valueContainer.val(value);\n        };\n\n        // 获取初始化的内容\n        E.fn.getInitValue = function () {\n            var editor = this;\n            var $valueContainer = editor.$valueContainer;\n            var currentValue = '';\n            var nodeName = editor.valueNodeName;\n            if (nodeName === 'div') {\n                currentValue = $valueContainer.html();\n            } else if (nodeName === 'textarea') {\n                currentValue = $valueContainer.val();\n            }\n\n            return currentValue;\n        };\n\n        // 触发菜单updatestyle\n        E.fn.updateMenuStyle = function () {\n            var menus = this.menus;\n\n            $.each(menus, function (k, menu) {\n                menu.updateSelected();\n            });\n        };\n\n        // 除了传入的 menuIds，其他全部启用\n        E.fn.enableMenusExcept = function (menuIds) {\n            if (this._disabled) {\n                // 编辑器处于禁用状态，则不执行改操作\n                return;\n            }\n            // menuIds参数：支持数组和字符串\n            menuIds = menuIds || [];\n            if (typeof menuIds === 'string') {\n                menuIds = [menuIds];\n            }\n\n            $.each(this.menus, function (k, menu) {\n                if (menuIds.indexOf(k) >= 0) {\n                    return;\n                }\n                menu.disabled(false);\n            });\n        };\n\n        // 除了传入的 menuIds，其他全部禁用\n        E.fn.disableMenusExcept = function (menuIds) {\n            if (this._disabled) {\n                // 编辑器处于禁用状态，则不执行改操作\n                return;\n            }\n            // menuIds参数：支持数组和字符串\n            menuIds = menuIds || [];\n            if (typeof menuIds === 'string') {\n                menuIds = [menuIds];\n            }\n\n            $.each(this.menus, function (k, menu) {\n                if (menuIds.indexOf(k) >= 0) {\n                    return;\n                }\n                menu.disabled(true);\n            });\n        };\n\n        // 隐藏所有 dropPanel droplist modal\n        E.fn.hideDropPanelAndModal = function () {\n            var menus = this.menus;\n\n            $.each(menus, function (k, menu) {\n                var m = menu.dropPanel || menu.dropList || menu.modal;\n                if (m && m.hide) {\n                    m.hide();\n                }\n            });\n        };\n    });\n    // selection range API\n    _e(function (E, $) {\n\n        // 用到 w3c range 的函数，如果检测到浏览器不支持 w3c range，则赋值为空函数\n        var ieRange = !E.w3cRange;\n        function emptyFn() {}\n\n        // 设置或读取当前的range\n        E.fn.currentRange = function (cr) {\n            if (cr) {\n                this._rangeData = cr;\n            } else {\n                return this._rangeData;\n            }\n        };\n\n        // 将当前选区折叠\n        E.fn.collapseRange = function (range, opt) {\n            // opt 参数说明：'start'-折叠到开始; 'end'-折叠到结束\n            opt = opt || 'end';\n            opt = opt === 'start' ? true : false;\n\n            range = range || this.currentRange();\n\n            if (range) {\n                // 合并，保存\n                range.collapse(opt);\n                this.currentRange(range);\n            }\n        };\n\n        // 获取选区的文字\n        E.fn.getRangeText = ieRange ? emptyFn : function (range) {\n            range = range || this.currentRange();\n            if (!range) {\n                return;\n            }\n            return range.toString();\n        };\n\n        // 获取选区对应的DOM对象\n        E.fn.getRangeElem = ieRange ? emptyFn : function (range) {\n            range = range || this.currentRange();\n            var dom = range.commonAncestorContainer;\n\n            if (dom.nodeType === 1) {\n                return dom;\n            } else {\n                return dom.parentNode;\n            }\n        };\n\n        // 选区内容是否为空？\n        E.fn.isRangeEmpty = ieRange ? emptyFn : function (range) {\n            range = range || this.currentRange();\n\n            if (range && range.startContainer) {\n                if (range.startContainer === range.endContainer) {\n                    if (range.startOffset === range.endOffset) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        };\n\n        // 保存选区数据\n        E.fn.saveSelection = ieRange ? emptyFn : function (range) {\n            var self = this,\n                _parentElem,\n                selection,\n                txt = self.txt.$txt.get(0);\n\n            if (range) {\n                _parentElem = range.commonAncestorContainer;\n            } else {\n                selection = document.getSelection();\n                if (selection.getRangeAt && selection.rangeCount) {\n                    range = document.getSelection().getRangeAt(0);\n                    _parentElem = range.commonAncestorContainer;\n                }\n            }\n            // 确定父元素一定要包含在编辑器区域内\n            if (_parentElem && ($.contains(txt, _parentElem) || txt === _parentElem)) {\n                // 保存选择区域\n                self.currentRange(range);\n            }\n        };\n\n        // 恢复选中区域\n        E.fn.restoreSelection = ieRange ? emptyFn : function (range) {\n            var selection;\n\n            range = range || this.currentRange();\n\n            if (!range) {\n                return;\n            }\n\n            // 使用 try catch 来防止 IE 某些情况报错\n            try {\n                selection = document.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n            } catch (ex) {\n                E.error('执行 editor.restoreSelection 时，IE可能会有异常，不影响使用');\n            }\n        };\n\n        // 根据elem恢复选区\n        E.fn.restoreSelectionByElem = ieRange ? emptyFn : function (elem, opt) {\n            // opt参数说明：'start'-折叠到开始，'end'-折叠到结束，'all'-全部选中\n            if (!elem) {\n                return;\n            }\n            opt = opt || 'end'; // 默认为折叠到结束\n\n            // 根据elem获取选区\n            this.setRangeByElem(elem);\n\n            // 根据 opt 折叠选区\n            if (opt === 'start') {\n                this.collapseRange(this.currentRange(), 'start');\n            }\n            if (opt === 'end') {\n                this.collapseRange(this.currentRange(), 'end');\n            }\n\n            // 恢复选区\n            this.restoreSelection();\n        };\n\n        // 初始化选区\n        E.fn.initSelection = ieRange ? emptyFn : function () {\n            var editor = this;\n            if (editor.currentRange()) {\n                //如果currentRange有值，则不用再初始化\n                return;\n            }\n\n            var range;\n            var $txt = editor.txt.$txt;\n            var $firstChild = $txt.children().first();\n\n            if ($firstChild.length) {\n                editor.restoreSelectionByElem($firstChild.get(0));\n            }\n        };\n\n        // 根据元素创建选区\n        E.fn.setRangeByElem = ieRange ? emptyFn : function (elem) {\n            var editor = this;\n            var txtElem = editor.txt.$txt.get(0);\n            if (!elem || !$.contains(txtElem, elem)) {\n                return;\n            }\n\n            // 找到elem的第一个 textNode 和 最后一个 textNode\n            var firstTextNode = elem.firstChild;\n            while (firstTextNode) {\n                if (firstTextNode.nodeType === 3) {\n                    break;\n                }\n                // 继续向下\n                firstTextNode = firstTextNode.firstChild;\n            }\n            var lastTextNode = elem.lastChild;\n            while (lastTextNode) {\n                if (lastTextNode.nodeType === 3) {\n                    break;\n                }\n                // 继续向下\n                lastTextNode = lastTextNode.lastChild;\n            }\n\n            var range = document.createRange();\n            if (firstTextNode && lastTextNode) {\n                // 说明 elem 有内容，能取到子元素\n                range.setStart(firstTextNode, 0);\n                range.setEnd(lastTextNode, lastTextNode.textContent.length);\n            } else {\n                // 说明 elem 无内容\n                range.setStart(elem, 0);\n                range.setEnd(elem, 0);\n            }\n\n            // 保存选区\n            editor.saveSelection(range);\n        };\n    });\n    // selection range API - IE8及以下\n    _e(function (E, $) {\n\n        if (E.w3cRange) {\n            // 说明支持 W3C 的range方法\n            return;\n        }\n\n        // -----------------IE8时，需要重写以下方法-------------------\n\n        // 获取选区的文字\n        E.fn.getRangeText = function (range) {\n            range = range || this.currentRange();\n            if (!range) {\n                return;\n            }\n            return range.text;\n        };\n\n        // 获取选区对应的DOM对象\n        E.fn.getRangeElem = function (range) {\n            range = range || this.currentRange();\n            if (!range) {\n                return;\n            }\n            var dom = range.parentElement();\n\n            if (dom.nodeType === 1) {\n                return dom;\n            } else {\n                return dom.parentNode;\n            }\n        };\n\n        // 选区内容是否为空？\n        E.fn.isRangeEmpty = function (range) {\n            range = range || this.currentRange();\n\n            if (range && range.text) {\n                return false;\n            }\n\n            return true;\n        };\n\n        // 保存选区数据\n        E.fn.saveSelection = function (range) {\n            var self = this,\n                _parentElem,\n                selection,\n                txt = self.txt.$txt.get(0);\n\n            if (range) {\n                _parentElem = range.parentElement();\n            } else {\n                range = document.selection.createRange();\n                if (typeof range.parentElement === 'undefined') {\n                    //IE6、7中，insertImage后会执行此处\n                    //由于找不到range.parentElement，所以干脆将_parentElem赋值为null\n                    _parentElem = null;\n                } else {\n                    _parentElem = range.parentElement();\n                }\n            }\n\n            // 确定父元素一定要包含在编辑器区域内\n            if (_parentElem && ($.contains(txt, _parentElem) || txt === _parentElem)) {\n                // 保存选择区域\n                self.currentRange(range);\n            }\n        };\n\n        // 恢复选中区域\n        E.fn.restoreSelection = function (currentRange) {\n            var editor = this,\n                selection,\n                range;\n\n            currentRange = currentRange || editor.currentRange();\n            if (!currentRange) {\n                return;\n            }\n\n            range = document.selection.createRange();\n            try {\n                // 此处，plupload上传上传图片时，IE8-会报一个『参数无效』的错误\n                range.setEndPoint('EndToEnd', currentRange);\n            } catch (ex) {}\n\n            if (currentRange.text.length === 0) {\n                try {\n                    // IE8 插入表情会报错\n                    range.collapse(false);\n                } catch (ex) {}\n            } else {\n                range.setEndPoint('StartToStart', currentRange);\n            }\n            range.select();\n        };\n    });\n    // editor command hooks\n    _e(function (E, $) {\n\n        E.fn.commandHooks = function () {\n            var editor = this;\n            var commandHooks = {};\n\n            // insertHtml\n            commandHooks.insertHtml = function (html) {\n                var $elem = $(html);\n                var rangeElem = editor.getRangeElem();\n                var targetElem;\n\n                targetElem = editor.getLegalTags(rangeElem);\n                if (!targetElem) {\n                    return;\n                }\n\n                $(targetElem).after($elem);\n            };\n\n            // 保存到对象\n            editor.commandHooks = commandHooks;\n        };\n    });\n    // editor command API\n    _e(function (E, $) {\n\n        // 基本命令\n        E.fn.command = function (e, commandName, commandValue, callback) {\n            var editor = this;\n            var hooks;\n\n            function commandFn() {\n                if (!commandName) {\n                    return;\n                }\n                if (editor.queryCommandSupported(commandName)) {\n                    // 默认命令\n                    document.execCommand(commandName, false, commandValue);\n                } else {\n                    // hooks 命令\n                    hooks = editor.commandHooks;\n                    if (commandName in hooks) {\n                        hooks[commandName](commandValue);\n                    }\n                }\n            }\n\n            this.customCommand(e, commandFn, callback);\n        };\n\n        // 针对一个elem对象执行基础命令\n        E.fn.commandForElem = function (elemOpt, e, commandName, commandValue, callback) {\n            // 取得查询elem的查询条件和验证函数\n            var selector;\n            var check;\n            if (typeof elemOpt === 'string') {\n                selector = elemOpt;\n            } else {\n                selector = elemOpt.selector;\n                check = elemOpt.check;\n            }\n\n            // 查询elem\n            var rangeElem = this.getRangeElem();\n            rangeElem = this.getSelfOrParentByName(rangeElem, selector, check);\n\n            // 根据elem设置range\n            if (rangeElem) {\n                this.setRangeByElem(rangeElem);\n            }\n\n            // 然后执行基础命令\n            this.command(e, commandName, commandValue, callback);\n        };\n\n        // 自定义命令\n        E.fn.customCommand = function (e, commandFn, callback) {\n            var editor = this;\n            var range = editor.currentRange();\n\n            if (!range) {\n                // 目前没有选区，则无法执行命令\n                e && e.preventDefault();\n                return;\n            }\n            // 记录内容，以便撤销（执行命令之前就要记录）\n            editor.undoRecord();\n\n            // 恢复选区（有 range 参数）\n            this.restoreSelection(range);\n\n            // 执行命令事件\n            commandFn.call(editor);\n\n            // 保存选区（无参数，要从浏览器直接获取range信息）\n            this.saveSelection();\n            // 重新恢复选区（无参数，要取得刚刚从浏览器得到的range信息）\n            this.restoreSelection();\n\n            // 执行 callback\n            if (callback && typeof callback === 'function') {\n                callback.call(editor);\n            }\n\n            // 最后插入空行\n            editor.txt.insertEmptyP();\n\n            // 包裹暴露的img和text\n            editor.txt.wrapImgAndText();\n\n            // 更新内容\n            editor.updateValue();\n\n            // 更新菜单样式\n            editor.updateMenuStyle();\n\n            // 隐藏 dropPanel dropList modal  设置 200ms 间隔\n            function hidePanelAndModal() {\n                editor.hideDropPanelAndModal();\n            }\n            setTimeout(hidePanelAndModal, 200);\n\n            if (e) {\n                e.preventDefault();\n            }\n        };\n\n        // 封装 document.queryCommandValue 函数\n        // IE8 直接执行偶尔会报错，因此直接用 try catch 封装一下\n        E.fn.queryCommandValue = function (commandName) {\n            var result = '';\n            try {\n                result = document.queryCommandValue(commandName);\n            } catch (ex) {}\n            return result;\n        };\n\n        // 封装 document.queryCommandState 函数\n        // IE8 直接执行偶尔会报错，因此直接用 try catch 封装一下\n        E.fn.queryCommandState = function (commandName) {\n            var result = false;\n            try {\n                result = document.queryCommandState(commandName);\n            } catch (ex) {}\n            return result;\n        };\n\n        // 封装 document.queryCommandSupported 函数\n        E.fn.queryCommandSupported = function (commandName) {\n            var result = false;\n            try {\n                result = document.queryCommandSupported(commandName);\n            } catch (ex) {}\n            return result;\n        };\n    });\n    // dom selector\n    _e(function (E, $) {\n\n        var matchesSelector;\n\n        // matchesSelector hook\n        function _matchesSelectorForIE(selector) {\n            var elem = this;\n            var $elems = $(selector);\n            var result = false;\n\n            // 用jquery查找 selector 所有对象，如果其中有一个和传入 elem 相同，则证明 elem 符合 selector\n            $elems.each(function () {\n                if (this === elem) {\n                    result = true;\n                    return false;\n                }\n            });\n\n            return result;\n        }\n\n        // 从当前的elem，往上去查找合法标签 如 p head table blockquote ul ol 等\n        E.fn.getLegalTags = function (elem) {\n            var legalTags = this.config.legalTags;\n            if (!legalTags) {\n                E.error('配置项中缺少 legalTags 的配置');\n                return;\n            }\n            return this.getSelfOrParentByName(elem, legalTags);\n        };\n\n        // 根据条件，查询自身或者父元素，符合即返回\n        E.fn.getSelfOrParentByName = function (elem, selector, check) {\n\n            if (!elem || !selector) {\n                return;\n            }\n\n            if (!matchesSelector) {\n                // 定义 matchesSelector 函数\n                matchesSelector = elem.webkitMatchesSelector || elem.mozMatchesSelector || elem.oMatchesSelector || elem.matchesSelector;\n            }\n            if (!matchesSelector) {\n                // 如果浏览器本身不支持 matchesSelector 则使用自定义的hook\n                matchesSelector = _matchesSelectorForIE;\n            }\n\n            var txt = this.txt.$txt.get(0);\n\n            while (elem && txt !== elem && $.contains(txt, elem)) {\n                if (matchesSelector.call(elem, selector)) {\n                    // 符合 selector 查询条件\n\n                    if (!check) {\n                        // 没有 check 验证函数，直接返回即可\n                        return elem;\n                    }\n\n                    if (check(elem)) {\n                        // 如果有 check 验证函数，还需 check 函数的确认\n                        return elem;\n                    }\n                }\n\n                // 如果上一步没经过验证，则将跳转到父元素\n                elem = elem.parentNode;\n            }\n\n            return;\n        };\n    });\n    // undo redo\n    _e(function (E, $) {\n\n        var length = 20; // 缓存的最大长度\n        function _getRedoList(editor) {\n            if (editor._redoList == null) {\n                editor._redoList = [];\n            }\n            return editor._redoList;\n        }\n        function _getUndoList(editor) {\n            if (editor._undoList == null) {\n                editor._undoList = [];\n            }\n            return editor._undoList;\n        }\n\n        // 数据处理\n        function _handle(editor, data, type) {\n            // var range = data.range;\n            // var range2 = range.cloneRange && range.cloneRange();\n            var val = data.val;\n            var html = editor.txt.$txt.html();\n\n            if (val == null) {\n                return;\n            }\n\n            if (val === html) {\n                if (type === 'redo') {\n                    editor.redo();\n                    return;\n                } else if (type === 'undo') {\n                    editor.undo();\n                    return;\n                } else {\n                    return;\n                }\n            }\n\n            // 保存数据\n            editor.txt.$txt.html(val);\n            // 更新数据到textarea（有必要的话）\n            editor.updateValue();\n\n            // onchange 事件\n            if (editor.onchange && typeof editor.onchange === 'function') {\n                editor.onchange.call(editor);\n            }\n\n            // ?????\n            // 注释：$txt 被重新赋值之后，range会被重置，cloneRange() 也不好使\n            // // 重置选区\n            // if (range2) {\n            //     editor.restoreSelection(range2);\n            // }\n        }\n\n        // 记录\n        E.fn.undoRecord = function () {\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            var val = $txt.html();\n            var undoList = _getUndoList(editor);\n            var redoList = _getRedoList(editor);\n            var currentVal = undoList.length ? undoList[0] : '';\n\n            if (val === currentVal.val) {\n                return;\n            }\n\n            // 清空 redolist\n            if (redoList.length) {\n                redoList = [];\n            }\n\n            // 添加数据到 undoList\n            undoList.unshift({\n                range: editor.currentRange(), // 将当前的range也记录下\n                val: val\n            });\n\n            // 限制 undoList 长度\n            if (undoList.length > length) {\n                undoList.pop();\n            }\n        };\n\n        // undo 操作\n        E.fn.undo = function () {\n            var editor = this;\n            var undoList = _getUndoList(editor);\n            var redoList = _getRedoList(editor);\n\n            if (!undoList.length) {\n                return;\n            }\n\n            // 取出 undolist 第一个值，加入 redolist\n            var data = undoList.shift();\n            redoList.unshift(data);\n\n            // 并修改编辑器的内容\n            _handle(this, data, 'undo');\n        };\n\n        // redo 操作\n        E.fn.redo = function () {\n            var editor = this;\n            var undoList = _getUndoList(editor);\n            var redoList = _getRedoList(editor);\n            if (!redoList.length) {\n                return;\n            }\n\n            // 取出 redolist 第一个值，加入 undolist\n            var data = redoList.shift();\n            undoList.unshift(data);\n\n            // 并修改编辑器的内容\n            _handle(this, data, 'redo');\n        };\n    });\n    // 暴露给用户的 API\n    _e(function (E, $) {\n\n        // 创建编辑器\n        E.fn.create = function () {\n            var editor = this;\n\n            // 检查 E.$body 是否有值\n            // 如果在 body 之前引用了 js 文件，body 尚未加载，可能没有值\n            if (!E.$body || E.$body.length === 0) {\n                E.$body = $('body');\n                E.$document = $(document);\n                E.$window = $(window);\n            }\n\n            // 执行 addMenus 之前：\n            // 1. 允许用户修改 editor.UI 自定义配置UI\n            // 2. 允许用户通过修改 editor.menus 来自定义配置菜单\n            // 因此要在 create 时执行，而不是 init           \n            editor.addMenus();\n\n            // 渲染\n            editor.renderMenus();\n            editor.renderMenuContainer();\n            editor.renderTxt();\n            editor.renderEditorContainer();\n\n            // 绑定事件\n            editor.eventMenus();\n            editor.eventMenuContainer();\n            editor.eventTxt();\n\n            // 处理ready事件\n            editor.readyHeadler();\n\n            // 初始化选区\n            editor.initSelection();\n\n            // $txt 快捷方式\n            editor.$txt = editor.txt.$txt;\n\n            // 执行用户自定义事件，通过 E.ready() 添加\n            var _plugins = E._plugins;\n            if (_plugins && _plugins.length) {\n                $.each(_plugins, function (k, val) {\n                    val.call(editor);\n                });\n            }\n        };\n\n        // 禁用编辑器\n        E.fn.disable = function () {\n            this.txt.$txt.removeAttr('contenteditable');\n            this.disableMenusExcept();\n\n            // 先禁用，再记录状态\n            this._disabled = true;\n        };\n        // 启用编辑器\n        E.fn.enable = function () {\n            // 先解除状态记录，再启用\n            this._disabled = false;\n            this.txt.$txt.attr('contenteditable', 'true');\n            this.enableMenusExcept();\n        };\n\n        // 销毁编辑器\n        E.fn.destroy = function () {\n            var self = this;\n            var $valueContainer = self.$valueContainer;\n            var $editorContainer = self.$editorContainer;\n            var valueNodeName = self.valueNodeName;\n\n            if (valueNodeName === 'div') {\n                // div 生成的编辑器\n                $valueContainer.removeAttr('contenteditable');\n                $editorContainer.after($valueContainer);\n                $editorContainer.hide();\n            } else {\n                // textarea 生成的编辑器\n                $valueContainer.show();\n                $editorContainer.hide();\n            }\n        };\n\n        // 撤销 销毁编辑器\n        E.fn.undestroy = function () {\n            var self = this;\n            var $valueContainer = self.$valueContainer;\n            var $editorContainer = self.$editorContainer;\n            var $menuContainer = self.menuContainer.$menuContainer;\n            var valueNodeName = self.valueNodeName;\n\n            if (valueNodeName === 'div') {\n                // div 生成的编辑器\n                $valueContainer.attr('contenteditable', 'true');\n                $menuContainer.after($valueContainer);\n                $editorContainer.show();\n            } else {\n                // textarea 生成的编辑器\n                $valueContainer.hide();\n                $editorContainer.show();\n            }\n        };\n\n        // 清空内容的快捷方式\n        E.fn.clear = function () {\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            $txt.html('<p><br></p>');\n            editor.restoreSelectionByElem($txt.find('p').get(0));\n        };\n    });\n    // menuContainer 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var MenuContainer = function MenuContainer(editor) {\n            this.editor = editor;\n            this.init();\n        };\n\n        MenuContainer.fn = MenuContainer.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.MenuContainer = MenuContainer;\n    });\n    // MenuContainer.fn bind fn\n    _e(function (E, $) {\n\n        var MenuContainer = E.MenuContainer;\n\n        // 初始化\n        MenuContainer.fn.init = function () {\n            var self = this;\n            var $menuContainer = $('<div class=\"wangEditor-menu-container clearfix\"></div>');\n\n            self.$menuContainer = $menuContainer;\n\n            // change shadow\n            self.changeShadow();\n        };\n\n        // 编辑区域滚动时，增加shadow\n        MenuContainer.fn.changeShadow = function () {\n            var $menuContainer = this.$menuContainer;\n            var editor = this.editor;\n            var $txt = editor.txt.$txt;\n\n            $txt.on('scroll', function () {\n                if ($txt.scrollTop() > 10) {\n                    $menuContainer.addClass('wangEditor-menu-shadow');\n                } else {\n                    $menuContainer.removeClass('wangEditor-menu-shadow');\n                }\n            });\n        };\n    });\n    // MenuContainer.fn API\n    _e(function (E, $) {\n\n        var MenuContainer = E.MenuContainer;\n\n        MenuContainer.fn.render = function () {\n            var $menuContainer = this.$menuContainer;\n            var $editorContainer = this.editor.$editorContainer;\n\n            $editorContainer.append($menuContainer);\n        };\n\n        // 获取菜单栏的高度\n        MenuContainer.fn.height = function () {\n            var $menuContainer = this.$menuContainer;\n            return $menuContainer.height();\n        };\n\n        // 添加菜单\n        MenuContainer.fn.appendMenu = function (groupIdx, menu) {\n            // 判断是否需要新增一个菜单组\n            this._addGroup(groupIdx);\n            // 增加菜单（返回 $menuItem）\n            return this._addOneMenu(menu);\n        };\n        MenuContainer.fn._addGroup = function (groupIdx) {\n            var $menuContainer = this.$menuContainer;\n            var $menuGroup;\n            if (!this.$currentGroup || this.currentGroupIdx !== groupIdx) {\n                $menuGroup = $('<div class=\"menu-group clearfix\"></div>');\n                $menuContainer.append($menuGroup);\n\n                this.$currentGroup = $menuGroup;\n                this.currentGroupIdx = groupIdx;\n            }\n        };\n        MenuContainer.fn._addOneMenu = function (menu) {\n            var $menuNormal = menu.$domNormal;\n            var $menuSelected = menu.$domSelected;\n\n            var $menuGroup = this.$currentGroup;\n            var $item = $('<div class=\"menu-item clearfix\"></div>');\n            $menuSelected.hide();\n            $item.append($menuNormal).append($menuSelected);\n            $menuGroup.append($item);\n\n            return $item;\n        };\n    });\n    // menu 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var Menu = function Menu(opt) {\n            this.editor = opt.editor;\n            this.id = opt.id;\n            this.title = opt.title;\n            this.$domNormal = opt.$domNormal;\n            this.$domSelected = opt.$domSelected || opt.$domNormal;\n\n            // document.execCommand 的参数\n            this.commandName = opt.commandName;\n            this.commandValue = opt.commandValue;\n            this.commandNameSelected = opt.commandNameSelected || opt.commandName;\n            this.commandValueSelected = opt.commandValueSelected || opt.commandValue;\n        };\n\n        Menu.fn = Menu.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.Menu = Menu;\n    });\n    // Menu.fn 初始化绑定的事件\n    _e(function (E, $) {\n\n        var Menu = E.Menu;\n\n        // 初始化UI\n        Menu.fn.initUI = function () {\n            var editor = this.editor;\n            var uiConfig = editor.UI.menus;\n            var menuId = this.id;\n            var menuUI = uiConfig[menuId];\n\n            if (this.$domNormal && this.$domSelected) {\n                // 自定义的菜单中，已经传入了 $dom 无需从配置文件中查找生成\n                return;\n            }\n\n            if (menuUI == null) {\n                E.warn('editor.UI配置中，没有菜单 \"' + menuId + '\" 的UI配置，只能取默认值');\n\n                // 必须写成 uiConfig['default'];\n                // 写成 uiConfig.default IE8会报错\n                menuUI = uiConfig['default'];\n            }\n\n            // 正常状态\n            this.$domNormal = $(menuUI.normal);\n\n            // 选中状态\n            if (/^\\./.test(menuUI.selected)) {\n                // 增加一个样式\n                this.$domSelected = this.$domNormal.clone().addClass(menuUI.selected.slice(1));\n            } else {\n                // 一个新的dom对象\n                this.$domSelected = $(menuUI.selected);\n            }\n        };\n    });\n    // Menu.fn API\n    _e(function (E, $) {\n\n        var Menu = E.Menu;\n\n        // 渲染菜单\n        Menu.fn.render = function (groupIdx) {\n            // 渲染UI\n            this.initUI();\n\n            var editor = this.editor;\n            var menuContainer = editor.menuContainer;\n            var $menuItem = menuContainer.appendMenu(groupIdx, this);\n            var onRender = this.onRender;\n\n            // 渲染tip\n            this._renderTip($menuItem);\n\n            // 执行 onRender 函数\n            if (onRender && typeof onRender === 'function') {\n                onRender.call(this);\n            }\n        };\n        Menu.fn._renderTip = function ($menuItem) {\n            var self = this;\n            var editor = self.editor;\n            var title = self.title;\n            var $tip = $('<div class=\"menu-tip\"></div>');\n            // var $triangle = $('<i class=\"tip-triangle\"></i>'); // 小三角\n\n            // 计算 tip 宽度\n            var $tempDiv;\n            if (!self.tipWidth) {\n                // 设置一个纯透明的 p（absolute;top:-10000px;不会显示在内容区域）\n                // 内容赋值为 title ，为了计算tip宽度\n                $tempDiv = $('<p style=\"opacity:0; filter:Alpha(opacity=0); position:absolute;top:-10000px;\">' + title + '</p>');\n                // 先添加到body，计算完再 remove\n                E.$body.append($tempDiv);\n                editor.ready(function () {\n                    var editor = this;\n                    var titleWidth = $tempDiv.outerWidth() + 5; // 多出 5px 的冗余\n                    var currentWidth = $tip.outerWidth();\n                    var currentMarginLeft = parseFloat($tip.css('margin-left'), 10);\n                    // 计算完，拿到数据，则弃用\n                    $tempDiv.remove();\n                    $tempDiv = null;\n\n                    // 重新设置样式\n                    $tip.css({\n                        width: titleWidth,\n                        'margin-left': currentMarginLeft + (currentWidth - titleWidth) / 2\n                    });\n\n                    // 存储\n                    self.tipWidth = titleWidth;\n                });\n            }\n\n            // $tip.append($triangle);\n            $tip.append(title);\n            $menuItem.append($tip);\n\n            function show() {\n                $tip.show();\n            }\n            function hide() {\n                $tip.hide();\n            }\n\n            var timeoutId;\n            $menuItem.find('a').on('mouseenter', function (e) {\n                if (!self.active() && !self.disabled()) {\n                    timeoutId = setTimeout(show, 200);\n                }\n            }).on('mouseleave', function (e) {\n                timeoutId && clearTimeout(timeoutId);\n                hide();\n            }).on('click', hide);\n        };\n\n        // 绑定事件\n        Menu.fn.bindEvent = function () {\n            var self = this;\n\n            var $domNormal = self.$domNormal;\n            var $domSelected = self.$domSelected;\n\n            // 试图获取该菜单定义的事件（未selected），没有则自己定义\n            var clickEvent = self.clickEvent;\n            if (!clickEvent) {\n                clickEvent = function clickEvent(e) {\n                    // -----------dropPanel dropList modal-----------\n                    var dropObj = self.dropPanel || self.dropList || self.modal;\n                    if (dropObj && dropObj.show) {\n                        if (dropObj.isShowing) {\n                            dropObj.hide();\n                        } else {\n                            dropObj.show();\n                        }\n                        return;\n                    }\n\n                    // -----------command-----------\n                    var editor = self.editor;\n                    var commandName;\n                    var commandValue;\n\n                    var selected = self.selected;\n                    if (selected) {\n                        commandName = self.commandNameSelected;\n                        commandValue = self.commandValueSelected;\n                    } else {\n                        commandName = self.commandName;\n                        commandValue = self.commandValue;\n                    }\n\n                    if (commandName) {\n                        // 执行命令\n                        editor.command(e, commandName, commandValue);\n                    } else {\n                        // 提示\n                        E.warn('菜单 \"' + self.id + '\" 未定义click事件');\n                        e.preventDefault();\n                    }\n                };\n            }\n            // 获取菜单定义的selected情况下的点击事件\n            var clickEventSelected = self.clickEventSelected || clickEvent;\n\n            // 将事件绑定到菜单dom上\n            $domNormal.click(function (e) {\n                if (!self.disabled()) {\n                    clickEvent.call(self, e);\n                    self.updateSelected();\n                }\n                e.preventDefault();\n            });\n            $domSelected.click(function (e) {\n                if (!self.disabled()) {\n                    clickEventSelected.call(self, e);\n                    self.updateSelected();\n                }\n                e.preventDefault();\n            });\n        };\n\n        // 更新选中状态\n        Menu.fn.updateSelected = function () {\n            var self = this;\n            var editor = self.editor;\n\n            // 试图获取用户自定义的判断事件\n            var updateSelectedEvent = self.updateSelectedEvent;\n            if (!updateSelectedEvent) {\n                // 用户未自定义，则设置默认值\n                updateSelectedEvent = function updateSelectedEvent() {\n                    var self = this;\n                    var editor = self.editor;\n                    var commandName = self.commandName;\n                    var commandValue = self.commandValue;\n\n                    if (commandValue) {\n                        if (editor.queryCommandValue(commandName).toLowerCase() === commandValue.toLowerCase()) {\n                            return true;\n                        }\n                    } else if (editor.queryCommandState(commandName)) {\n                        return true;\n                    }\n\n                    return false;\n                };\n            }\n\n            // 获取结果\n            var result = updateSelectedEvent.call(self);\n            result = !!result;\n\n            // 存储结果、显示效果\n            self.changeSelectedState(result);\n        };\n\n        // 切换选中状态、显示效果\n        Menu.fn.changeSelectedState = function (state) {\n            var self = this;\n            var selected = self.selected;\n\n            if (state != null && typeof state === 'boolean') {\n                if (selected === state) {\n                    // 计算结果和当前的状态一样\n                    return;\n                }\n                // 存储结果\n                self.selected = state;\n\n                // 切换菜单的显示\n                if (state) {\n                    // 选中\n                    self.$domNormal.hide();\n                    self.$domSelected.show();\n                } else {\n                    // 未选中\n                    self.$domNormal.show();\n                    self.$domSelected.hide();\n                }\n            } // if\n        };\n\n        // 点击菜单，显示了 dropPanel modal 时，菜单的状态 \n        Menu.fn.active = function (active) {\n            if (active == null) {\n                return this._activeState;\n            }\n            this._activeState = active;\n        };\n        Menu.fn.activeStyle = function (active) {\n            var selected = this.selected;\n            var $dom = this.$domNormal;\n            var $domSelected = this.$domSelected;\n\n            if (active) {\n                $dom.addClass('active');\n                $domSelected.addClass('active');\n            } else {\n                $dom.removeClass('active');\n                $domSelected.removeClass('active');\n            }\n\n            // 记录状态 （ menu hover 时会取状态用 ）\n            this.active(active);\n        };\n\n        // 菜单的启用和禁用\n        Menu.fn.disabled = function (opt) {\n            // 参数为空，取值\n            if (opt == null) {\n                return !!this._disabled;\n            }\n\n            if (this._disabled === opt) {\n                // 要设置的参数值和当前参数只一样，无需再次设置\n                return;\n            }\n\n            var $dom = this.$domNormal;\n            var $domSelected = this.$domSelected;\n\n            // 设置样式\n            if (opt) {\n                $dom.addClass('disable');\n                $domSelected.addClass('disable');\n            } else {\n                $dom.removeClass('disable');\n                $domSelected.removeClass('disable');\n            }\n\n            // 存储\n            this._disabled = opt;\n        };\n    });\n    // dropList 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var DropList = function DropList(editor, menu, opt) {\n            this.editor = editor;\n            this.menu = menu;\n\n            // list 的数据源，格式 {'commandValue': 'title', ...}\n            this.data = opt.data;\n            // 要为每个item自定义的模板\n            this.tpl = opt.tpl;\n            // 为了执行 editor.commandForElem 而传入的elem查询方式\n            this.selectorForELemCommand = opt.selectorForELemCommand;\n\n            // 执行事件前后的钩子\n            this.beforeEvent = opt.beforeEvent;\n            this.afterEvent = opt.afterEvent;\n\n            // 初始化\n            this.init();\n        };\n\n        DropList.fn = DropList.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.DropList = DropList;\n    });\n    // dropList fn bind\n    _e(function (E, $) {\n\n        var DropList = E.DropList;\n\n        // init\n        DropList.fn.init = function () {\n            var self = this;\n\n            // 生成dom对象\n            self.initDOM();\n\n            // 绑定command事件\n            self.bindEvent();\n\n            // 声明隐藏的事件\n            self.initHideEvent();\n        };\n\n        // 初始化dom结构\n        DropList.fn.initDOM = function () {\n            var self = this;\n            var data = self.data;\n            var tpl = self.tpl || '<span>{#title}</span>';\n            var $list = $('<div class=\"wangEditor-drop-list clearfix\"></div>');\n\n            var itemContent;\n            var $item;\n            $.each(data, function (commandValue, title) {\n                itemContent = tpl.replace(/{#commandValue}/ig, commandValue).replace(/{#title}/ig, title);\n                $item = $('<a href=\"#\" commandValue=\"' + commandValue + '\"></a>');\n                $item.append(itemContent);\n                $list.append($item);\n            });\n\n            self.$list = $list;\n        };\n\n        // 绑定事件\n        DropList.fn.bindEvent = function () {\n            var self = this;\n            var editor = self.editor;\n            var menu = self.menu;\n            var commandName = menu.commandName;\n            var selectorForELemCommand = self.selectorForELemCommand;\n            var $list = self.$list;\n\n            // 执行事件前后的钩子函数\n            var beforeEvent = self.beforeEvent;\n            var afterEvent = self.afterEvent;\n\n            $list.on('click', 'a[commandValue]', function (e) {\n                // 正式命令执行之前\n                if (beforeEvent && typeof beforeEvent === 'function') {\n                    beforeEvent.call(e);\n                }\n\n                // 执行命令\n                var commandValue = $(e.currentTarget).attr('commandValue');\n                if (menu.selected && editor.isRangeEmpty() && selectorForELemCommand) {\n                    // 当前处于选中状态，并且选中内容为空\n                    editor.commandForElem(selectorForELemCommand, e, commandName, commandValue);\n                } else {\n                    // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                    editor.command(e, commandName, commandValue);\n                }\n\n                // 正式命令之后的钩子\n                if (afterEvent && typeof afterEvent === 'function') {\n                    afterEvent.call(e);\n                }\n            });\n        };\n\n        // 点击其他地方，立即隐藏 droplist\n        DropList.fn.initHideEvent = function () {\n            var self = this;\n\n            // 获取 list elem\n            var thisList = self.$list.get(0);\n\n            E.$body.on('click', function (e) {\n                if (!self.isShowing) {\n                    return;\n                }\n                var trigger = e.target;\n\n                // 获取菜单elem\n                var menu = self.menu;\n                var menuDom;\n                if (menu.selected) {\n                    menuDom = menu.$domSelected.get(0);\n                } else {\n                    menuDom = menu.$domNormal.get(0);\n                }\n\n                if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                    // 说明由本菜单点击触发的\n                    return;\n                }\n\n                if (thisList === trigger || $.contains(thisList, trigger)) {\n                    // 说明由本list点击触发的\n                    return;\n                }\n\n                // 其他情况，隐藏 list\n                self.hide();\n            });\n\n            E.$window.scroll(function () {\n                self.hide();\n            });\n\n            E.$window.on('resize', function () {\n                self.hide();\n            });\n        };\n    });\n    // dropListfn api\n    _e(function (E, $) {\n\n        var DropList = E.DropList;\n\n        // 渲染\n        DropList.fn._render = function () {\n            var self = this;\n            var editor = self.editor;\n            var $list = self.$list;\n\n            // 渲染到页面\n            editor.$editorContainer.append($list);\n\n            // 记录状态\n            self.rendered = true;\n        };\n\n        // 定位\n        DropList.fn._position = function () {\n            var self = this;\n            var $list = self.$list;\n            var editor = self.editor;\n            var menu = self.menu;\n            var $menuContainer = editor.menuContainer.$menuContainer;\n            var $menuDom = menu.selected ? menu.$domSelected : menu.$domNormal;\n            // 注意这里的 offsetParent() 要返回 .menu-item 的 position\n            // 因为 .menu-item 是 position:relative\n            var menuPosition = $menuDom.offsetParent().position();\n\n            // 取得 menu 的位置、尺寸属性\n            var menuTop = menuPosition.top;\n            var menuLeft = menuPosition.left;\n            var menuHeight = $menuDom.offsetParent().height();\n            var menuWidth = $menuDom.offsetParent().width();\n\n            // 取得 list 的尺寸属性\n            var listWidth = $list.outerWidth();\n            // var listHeight = $list.outerHeight();\n\n            // 取得 $txt 的尺寸\n            var txtWidth = editor.txt.$txt.outerWidth();\n\n            // ------------开始计算-------------\n\n            // 初步计算 list 位置属性\n            var top = menuTop + menuHeight;\n            var left = menuLeft + menuWidth / 2;\n            var marginLeft = 0 - menuWidth / 2;\n\n            // 如果超出了有边界，则要左移（且和右侧有间隙）\n            var valWithTxt = left + listWidth - txtWidth;\n            if (valWithTxt > -10) {\n                marginLeft = marginLeft - valWithTxt - 10;\n            }\n            // 设置样式\n            $list.css({\n                top: top,\n                left: left,\n                'margin-left': marginLeft\n            });\n\n            // 如果因为向下滚动而导致菜单fixed，则再加一步处理\n            if (editor._isMenufixed) {\n                top = top + ($menuContainer.offset().top + $menuContainer.outerHeight() - $list.offset().top);\n\n                // 重新设置top\n                $list.css({\n                    top: top\n                });\n            }\n        };\n\n        // 显示\n        DropList.fn.show = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.rendered) {\n                // 第一次show之前，先渲染\n                self._render();\n            }\n\n            if (self.isShowing) {\n                return;\n            }\n\n            var $list = self.$list;\n            $list.show();\n\n            // 定位\n            self._position();\n\n            // 记录状态\n            self.isShowing = true;\n\n            // 菜单状态\n            menu.activeStyle(true);\n        };\n\n        // 隐藏\n        DropList.fn.hide = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.isShowing) {\n                return;\n            }\n\n            var $list = self.$list;\n            $list.hide();\n\n            // 记录状态\n            self.isShowing = false;\n\n            // 菜单状态\n            menu.activeStyle(false);\n        };\n    });\n    // dropPanel 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var DropPanel = function DropPanel(editor, menu, opt) {\n            this.editor = editor;\n            this.menu = menu;\n            this.$content = opt.$content;\n            this.width = opt.width || 200;\n            this.height = opt.height;\n            this.onRender = opt.onRender;\n\n            // init\n            this.init();\n        };\n\n        DropPanel.fn = DropPanel.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.DropPanel = DropPanel;\n    });\n    // dropPanel fn bind\n    _e(function (E, $) {\n\n        var DropPanel = E.DropPanel;\n\n        // init\n        DropPanel.fn.init = function () {\n            var self = this;\n\n            // 生成dom对象\n            self.initDOM();\n\n            // 声明隐藏的事件\n            self.initHideEvent();\n        };\n\n        // init DOM\n        DropPanel.fn.initDOM = function () {\n            var self = this;\n            var $content = self.$content;\n            var width = self.width;\n            var height = self.height;\n            var $panel = $('<div class=\"wangEditor-drop-panel clearfix\"></div>');\n            var $triangle = $('<div class=\"tip-triangle\"></div>');\n\n            $panel.css({\n                width: width,\n                height: height ? height : 'auto'\n            });\n            $panel.append($triangle);\n            $panel.append($content);\n\n            // 添加对象数据\n            self.$panel = $panel;\n            self.$triangle = $triangle;\n        };\n\n        // 点击其他地方，立即隐藏 dropPanel\n        DropPanel.fn.initHideEvent = function () {\n            var self = this;\n\n            // 获取 panel elem\n            var thisPanle = self.$panel.get(0);\n\n            E.$body.on('click', function (e) {\n                if (!self.isShowing) {\n                    return;\n                }\n                var trigger = e.target;\n\n                // 获取菜单elem\n                var menu = self.menu;\n                var menuDom;\n                if (menu.selected) {\n                    menuDom = menu.$domSelected.get(0);\n                } else {\n                    menuDom = menu.$domNormal.get(0);\n                }\n\n                if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                    // 说明由本菜单点击触发的\n                    return;\n                }\n\n                if (thisPanle === trigger || $.contains(thisPanle, trigger)) {\n                    // 说明由本panel点击触发的\n                    return;\n                }\n\n                // 其他情况，隐藏 panel\n                self.hide();\n            });\n\n            E.$window.scroll(function (e) {\n                self.hide();\n            });\n\n            E.$window.on('resize', function () {\n                self.hide();\n            });\n        };\n    });\n    // dropPanel fn api\n    _e(function (E, $) {\n\n        var DropPanel = E.DropPanel;\n\n        // 渲染\n        DropPanel.fn._render = function () {\n            var self = this;\n            var onRender = self.onRender;\n            var editor = self.editor;\n            var $panel = self.$panel;\n\n            // 渲染到页面\n            editor.$editorContainer.append($panel);\n\n            // 渲染后的回调事件\n            onRender && onRender.call(self);\n\n            // 记录状态\n            self.rendered = true;\n        };\n\n        // 定位\n        DropPanel.fn._position = function () {\n            var self = this;\n            var $panel = self.$panel;\n            var $triangle = self.$triangle;\n            var editor = self.editor;\n            var $menuContainer = editor.menuContainer.$menuContainer;\n            var menu = self.menu;\n            var $menuDom = menu.selected ? menu.$domSelected : menu.$domNormal;\n            // 注意这里的 offsetParent() 要返回 .menu-item 的 position\n            // 因为 .menu-item 是 position:relative\n            var menuPosition = $menuDom.offsetParent().position();\n\n            // 取得 menu 的位置、尺寸属性\n            var menuTop = menuPosition.top;\n            var menuLeft = menuPosition.left;\n            var menuHeight = $menuDom.offsetParent().height();\n            var menuWidth = $menuDom.offsetParent().width();\n\n            // 取得 panel 的尺寸属性\n            var panelWidth = $panel.outerWidth();\n            // var panelHeight = $panel.outerHeight();\n\n            // 取得 $txt 的尺寸\n            var txtWidth = editor.txt.$txt.outerWidth();\n\n            // ------------开始计算-------------\n\n            // 初步计算 panel 位置属性\n            var top = menuTop + menuHeight;\n            var left = menuLeft + menuWidth / 2;\n            var marginLeft = 0 - panelWidth / 2;\n            var marginLeft2 = marginLeft; // 下文用于和 marginLeft 比较，来设置三角形tip的位置\n\n            // 如果超出了左边界，则移动回来（要和左侧有10px间隙）\n            if (0 - marginLeft > left - 10) {\n                marginLeft = 0 - (left - 10);\n            }\n\n            // 如果超出了有边界，则要左移（且和右侧有10px间隙）\n            var valWithTxt = left + panelWidth + marginLeft - txtWidth;\n            if (valWithTxt > -10) {\n                marginLeft = marginLeft - valWithTxt - 10;\n            }\n\n            // 设置样式\n            $panel.css({\n                top: top,\n                left: left,\n                'margin-left': marginLeft\n            });\n\n            // 如果因为向下滚动而导致菜单fixed，则再加一步处理\n            if (editor._isMenufixed) {\n                top = top + ($menuContainer.offset().top + $menuContainer.outerHeight() - $panel.offset().top);\n\n                // 重新设置top\n                $panel.css({\n                    top: top\n                });\n            }\n\n            // 设置三角形 tip 的位置\n            $triangle.css({\n                'margin-left': marginLeft2 - marginLeft - 5\n            });\n        };\n\n        // focus 第一个 input\n        DropPanel.fn.focusFirstInput = function () {\n            var self = this;\n            var $panel = self.$panel;\n            $panel.find('input[type=text],textarea').each(function () {\n                var $input = $(this);\n                if ($input.attr('disabled') == null) {\n                    $input.focus();\n                    return false;\n                }\n            });\n        };\n\n        // 显示\n        DropPanel.fn.show = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.rendered) {\n                // 第一次show之前，先渲染\n                self._render();\n            }\n\n            if (self.isShowing) {\n                return;\n            }\n\n            var $panel = self.$panel;\n            $panel.show();\n\n            // 定位\n            self._position();\n\n            // 记录状态\n            self.isShowing = true;\n\n            // 菜单状态\n            menu.activeStyle(true);\n\n            if (E.w3cRange) {\n                // 高级浏览器\n                self.focusFirstInput();\n            } else {\n                // 兼容 IE8 input placeholder\n                E.placeholderForIE8($panel);\n            }\n        };\n\n        // 隐藏\n        DropPanel.fn.hide = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.isShowing) {\n                return;\n            }\n\n            var $panel = self.$panel;\n            $panel.hide();\n\n            // 记录状态\n            self.isShowing = false;\n\n            // 菜单状态\n            menu.activeStyle(false);\n        };\n    });\n    // modal 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var Modal = function Modal(editor, menu, opt) {\n            this.editor = editor;\n            this.menu = menu;\n            this.$content = opt.$content;\n\n            this.init();\n        };\n\n        Modal.fn = Modal.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.Modal = Modal;\n    });\n    // modal fn bind\n    _e(function (E, $) {\n\n        var Modal = E.Modal;\n\n        Modal.fn.init = function () {\n            var self = this;\n\n            // 初始化dom\n            self.initDom();\n\n            // 初始化隐藏事件\n            self.initHideEvent();\n        };\n\n        // 初始化dom\n        Modal.fn.initDom = function () {\n            var self = this;\n            var $content = self.$content;\n            var $modal = $('<div class=\"wangEditor-modal\"></div>');\n            var $close = $('<div class=\"wangEditor-modal-close\"><i class=\"wangeditor-menu-img-cancel-circle\"></i></div>');\n\n            $modal.append($close);\n            $modal.append($content);\n\n            // 记录数据\n            self.$modal = $modal;\n            self.$close = $close;\n        };\n\n        // 初始化隐藏事件\n        Modal.fn.initHideEvent = function () {\n            var self = this;\n            var $close = self.$close;\n            var modal = self.$modal.get(0);\n\n            // 点击 $close 按钮，隐藏\n            $close.click(function () {\n                self.hide();\n            });\n\n            // 点击其他部分，隐藏\n            E.$body.on('click', function (e) {\n                if (!self.isShowing) {\n                    return;\n                }\n                var trigger = e.target;\n\n                // 获取菜单elem\n                var menu = self.menu;\n                var menuDom;\n                if (menu) {\n                    if (menu.selected) {\n                        menuDom = menu.$domSelected.get(0);\n                    } else {\n                        menuDom = menu.$domNormal.get(0);\n                    }\n\n                    if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                        // 说明由本菜单点击触发的\n                        return;\n                    }\n                }\n\n                if (modal === trigger || $.contains(modal, trigger)) {\n                    // 说明由本panel点击触发的\n                    return;\n                }\n\n                // 其他情况，隐藏 panel\n                self.hide();\n            });\n        };\n    });\n    // modal fn api\n    _e(function (E, $) {\n\n        var Modal = E.Modal;\n\n        // 渲染\n        Modal.fn._render = function () {\n            var self = this;\n            var editor = self.editor;\n            var $modal = self.$modal;\n\n            // $modal的z-index，在配置的z-index基础上再 +10\n            $modal.css('z-index', editor.config.zindex + 10 + '');\n\n            // 渲染到body最后面\n            E.$body.append($modal);\n\n            // 记录状态\n            self.rendered = true;\n        };\n\n        // 定位\n        Modal.fn._position = function () {\n            var self = this;\n            var $modal = self.$modal;\n            var top = $modal.offset().top;\n            var width = $modal.outerWidth();\n            var height = $modal.outerHeight();\n            var marginLeft = 0 - width / 2;\n            var marginTop = 0 - height / 2;\n            var sTop = E.$window.scrollTop();\n\n            // 保证modal最顶部，不超过浏览器上边框\n            if (height / 2 > top) {\n                marginTop = 0 - top;\n            }\n\n            $modal.css({\n                'margin-left': marginLeft + 'px',\n                'margin-top': marginTop + sTop + 'px'\n            });\n        };\n\n        // 显示\n        Modal.fn.show = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.rendered) {\n                // 第一次show之前，先渲染\n                self._render();\n            }\n\n            if (self.isShowing) {\n                return;\n            }\n            // 记录状态\n            self.isShowing = true;\n\n            var $modal = self.$modal;\n            $modal.show();\n\n            // 定位\n            self._position();\n\n            // 激活菜单状态\n            menu && menu.activeStyle(true);\n        };\n\n        // 隐藏\n        Modal.fn.hide = function () {\n            var self = this;\n            var menu = self.menu;\n            if (!self.isShowing) {\n                return;\n            }\n            // 记录状态\n            self.isShowing = false;\n\n            // 隐藏\n            var $modal = self.$modal;\n            $modal.hide();\n\n            // 菜单状态\n            menu && menu.activeStyle(false);\n        };\n    });\n    // txt 构造函数\n    _e(function (E, $) {\n\n        // 定义构造函数\n        var Txt = function Txt(editor) {\n            this.editor = editor;\n\n            // 初始化\n            this.init();\n        };\n\n        Txt.fn = Txt.prototype;\n\n        // 暴露给 E 即 window.wangEditor\n        E.Txt = Txt;\n    });\n    // Txt.fn bind fn\n    _e(function (E, $) {\n\n        var Txt = E.Txt;\n\n        // 初始化\n        Txt.fn.init = function () {\n            var self = this;\n            var editor = self.editor;\n            var $valueContainer = editor.$valueContainer;\n            var currentValue = editor.getInitValue();\n            var $txt;\n\n            if ($valueContainer.get(0).nodeName === 'DIV') {\n                // 如果传入生成编辑器的元素就是div，则直接使用\n                $txt = $valueContainer;\n                $txt.addClass(\"wangEditor-txt\");\n                $txt.attr('contentEditable', 'true');\n            } else {\n                // 如果不是div（是textarea），则创建一个div\n                $txt = $('<div class=\"wangEditor-txt\" contentEditable=\"true\">' + currentValue + '</div>');\n            }\n\n            // 试图最后插入一个空行，ready之后才行\n            editor.ready(function () {\n                self.insertEmptyP();\n            });\n\n            self.$txt = $txt;\n\n            // 删除时，如果没有内容了，就添加一个 <p><br></p>\n            self.contentEmptyHandle();\n\n            // enter时，不能使用 div 换行\n            self.bindEnterForDiv();\n\n            // enter时，用 p 包裹 text\n            self.bindEnterForText();\n\n            // tab 插入4个空格\n            self.bindTabEvent();\n\n            // 处理粘贴内容\n            self.bindPasteFilter();\n\n            // $txt.formatText() 方法\n            self.bindFormatText();\n\n            // 定义 $txt.html() 方法\n            self.bindHtml();\n        };\n\n        // 删除时，如果没有内容了，就添加一个 <p><br></p>\n        Txt.fn.contentEmptyHandle = function () {\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n            var $p;\n\n            $txt.on('keydown', function (e) {\n                if (e.keyCode !== 8) {\n                    return;\n                }\n                var txtHtml = $.trim($txt.html().toLowerCase());\n                if (txtHtml === '<p><br></p>') {\n                    // 如果最后还剩余一个空行，就不再继续删除了\n                    e.preventDefault();\n                    return;\n                }\n            });\n\n            $txt.on('keyup', function (e) {\n                if (e.keyCode !== 8) {\n                    return;\n                }\n                var txtHtml = $.trim($txt.html().toLowerCase());\n                // ff时用 txtHtml === '<br>' 判断，其他用 !txtHtml 判断\n                if (!txtHtml || txtHtml === '<br>') {\n                    // 内容空了\n                    $p = $('<p><br/></p>');\n                    $txt.html(''); // 一定要先清空，否则在 ff 下有问题\n                    $txt.append($p);\n                    editor.restoreSelectionByElem($p.get(0));\n                }\n            });\n        };\n\n        // enter时，不能使用 div 换行\n        Txt.fn.bindEnterForDiv = function () {\n            var tags = E.config.legalTags; // 配置中编辑器要求的合法标签，如 p head table blockquote ul ol 等\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n\n            var $keydownDivElem;\n            function divHandler() {\n                if (!$keydownDivElem) {\n                    return;\n                }\n\n                var $pElem = $('<p>' + $keydownDivElem.html() + '</p>');\n                $keydownDivElem.after($pElem);\n                $keydownDivElem.remove();\n            }\n\n            $txt.on('keydown keyup', function (e) {\n                if (e.keyCode !== 13) {\n                    return;\n                }\n                // 查找合法标签\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getLegalTags(rangeElem);\n                var $targetElem;\n                var $pElem;\n\n                if (!targetElem) {\n                    // 没找到合法标签，就去查找 div\n                    targetElem = editor.getSelfOrParentByName(rangeElem, 'div');\n                    if (!targetElem) {\n                        return;\n                    }\n                    $targetElem = $(targetElem);\n\n                    if (e.type === 'keydown') {\n                        // 异步执行（同步执行会出现问题）\n                        $keydownDivElem = $targetElem;\n                        setTimeout(divHandler, 0);\n                    }\n\n                    if (e.type === 'keyup') {\n                        // 将 div 的内容移动到 p 里面，并移除 div\n                        $pElem = $('<p>' + $targetElem.html() + '</p>');\n                        $targetElem.after($pElem);\n                        $targetElem.remove();\n\n                        // 如果是回车结束，将选区定位到行首\n                        editor.restoreSelectionByElem($pElem.get(0), 'start');\n                    }\n                }\n            });\n        };\n\n        // enter时，用 p 包裹 text\n        Txt.fn.bindEnterForText = function () {\n            var self = this;\n            var $txt = self.$txt;\n            var handle;\n            $txt.on('keyup', function (e) {\n                if (e.keyCode !== 13) {\n                    return;\n                }\n                if (!handle) {\n                    handle = function handle() {\n                        self.wrapImgAndText();\n                    };\n                }\n                setTimeout(handle);\n            });\n        };\n\n        // tab 时，插入4个空格\n        Txt.fn.bindTabEvent = function () {\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n\n            $txt.on('keydown', function (e) {\n                if (e.keyCode !== 9) {\n                    // 只监听 tab 按钮\n                    return;\n                }\n                // 如果浏览器支持 insertHtml 则插入4个空格。如果不支持，就不管了\n                if (editor.queryCommandSupported('insertHtml')) {\n                    editor.command(e, 'insertHtml', '&nbsp;&nbsp;&nbsp;&nbsp;');\n                }\n            });\n        };\n\n        // 处理粘贴内容\n        Txt.fn.bindPasteFilter = function () {\n            var self = this;\n            var editor = self.editor;\n            var resultHtml = ''; //存储最终的结果\n            var $txt = self.$txt;\n            var legalTags = editor.config.legalTags;\n            var legalTagArr = legalTags.split(',');\n\n            $txt.on('paste', function (e) {\n                if (!editor.config.pasteFilter) {\n                    // 配置中取消了粘贴过滤\n                    return;\n                }\n\n                var currentNodeName = editor.getRangeElem().nodeName;\n                if (currentNodeName === 'TD' || currentNodeName === 'TH') {\n                    // 在表格的单元格中粘贴，忽略所有内容。否则会出现异常情况\n                    return;\n                }\n\n                resultHtml = ''; // 先清空 resultHtml\n\n                var pasteHtml, $paste, docSplitHtml;\n                var data = e.clipboardData || e.originalEvent.clipboardData;\n                var ieData = window.clipboardData;\n\n                if (editor.config.pasteText) {\n                    // 只粘贴纯文本\n\n                    if (data && data.getData) {\n                        // w3c\n                        pasteHtml = data.getData('text/plain');\n                    } else if (ieData && ieData.getData) {\n                        // IE\n                        pasteHtml = ieData.getData('text');\n                    } else {\n                        // 其他情况\n                        return;\n                    }\n\n                    // 拼接为 <p> 标签\n                    if (pasteHtml) {\n                        resultHtml = '<p>' + pasteHtml + '</p>';\n                    }\n                } else {\n                    // 粘贴过滤了样式的、只有标签的 html\n\n                    if (data && data.getData) {\n                        // w3c\n\n                        // 获取粘贴过来的html\n                        pasteHtml = data.getData('text/html');\n\n                        // 过滤从 word excel 粘贴过来的乱码\n                        docSplitHtml = pasteHtml.split('</html>');\n                        if (docSplitHtml.length === 2) {\n                            pasteHtml = docSplitHtml[0];\n                        }\n\n                        if (pasteHtml) {\n                            // 创建dom\n                            $paste = $('<div>' + pasteHtml + '</div>');\n                            // 处理，并将结果存储到 resultHtml 『全局』变量\n                            handle($paste.get(0));\n                        } else {\n                            // 得不到html，试图获取text\n                            pasteHtml = data.getData('text/plain');\n                            if (pasteHtml) {\n                                // 替换特殊字符\n                                pasteHtml = pasteHtml.replace(/[ ]/g, '&nbsp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\\n/g, '</p><p>');\n                                // 拼接\n                                resultHtml = '<p>' + pasteHtml + '</p>';\n\n                                // 查询链接\n                                resultHtml = resultHtml.replace(/<p>(https?:\\/\\/.*?)<\\/p>/ig, function (match, link) {\n                                    return '<p><a href=\"' + link + '\" target=\"_blank\">' + link + '</p>';\n                                });\n                            }\n                        }\n                    } else if (ieData && ieData.getData) {\n                        // IE 直接从剪切板中取出纯文本格式\n                        resultHtml = ieData.getData('text');\n                        if (!resultHtml) {\n                            return;\n                        }\n                        // 拼接为 <p> 标签\n                        resultHtml = '<p>' + resultHtml + '</p>';\n                        resultHtml = resultHtml.replace(new RegExp('\\n', 'g'), '</p><p>');\n                    } else {\n                        // 其他情况\n                        return;\n                    }\n                }\n\n                // 执行命令\n                if (resultHtml) {\n                    editor.command(e, 'insertHtml', resultHtml);\n\n                    // 删除内容为空的 p 和嵌套的 p\n                    self.clearEmptyOrNestP();\n                }\n            });\n\n            // 处理粘贴的内容\n            function handle(elem) {\n                if (!elem || !elem.nodeType || !elem.nodeName) {\n                    return;\n                }\n                var $elem;\n                var nodeName = elem.nodeName.toLowerCase();\n                var nodeType = elem.nodeType;\n                var childNodesClone;\n\n                // 只处理文本和普通node标签\n                if (nodeType !== 3 && nodeType !== 1) {\n                    return;\n                }\n\n                $elem = $(elem);\n\n                // 如果是容器，则继续深度遍历\n                if (nodeName === 'div') {\n                    childNodesClone = [];\n                    $.each(elem.childNodes, function (index, item) {\n                        // elem.childNodes 可获取TEXT节点，而 $elem.children() 就获取不到\n                        // 先将 elem.childNodes 拷贝一份，一面在循环递归过程中 elem 发生变化\n                        childNodesClone.push(item);\n                    });\n                    // 遍历子元素，执行操作\n                    $.each(childNodesClone, function () {\n                        handle(this);\n                    });\n                    return;\n                }\n\n                if (legalTagArr.indexOf(nodeName) >= 0) {\n                    // 如果是合法标签之内的，则根据元素类型，获取值\n                    resultHtml += getResult(elem);\n                } else if (nodeType === 3) {\n                    // 如果是文本，则直接插入 p 标签\n                    resultHtml += '<p>' + elem.textContent + '</p>';\n                } else if (nodeName === 'br') {\n                    // <br>保留\n                    resultHtml += '<br/>';\n                } else {\n                    // 忽略的标签\n                    if (['meta', 'style', 'script', 'object', 'form', 'iframe', 'hr'].indexOf(nodeName) >= 0) {\n                        return;\n                    }\n                    // 其他标签，移除属性，插入 p 标签\n                    $elem = $(removeAttrs(elem));\n                    // 注意，这里的 clone() 是必须的，否则会出错\n                    resultHtml += $('<div>').append($elem.clone()).html();\n                }\n            }\n\n            // 获取元素的结果\n            function getResult(elem) {\n                var nodeName = elem.nodeName.toLowerCase();\n                var $elem;\n                var htmlForP = '';\n                var htmlForLi = '';\n\n                if (['blockquote'].indexOf(nodeName) >= 0) {\n\n                    // 直接取出元素text即可\n                    $elem = $(elem);\n                    return '<' + nodeName + '>' + $elem.text() + '</' + nodeName + '>';\n                } else if (['p', 'h1', 'h2', 'h3', 'h4', 'h5'].indexOf(nodeName) >= 0) {\n\n                    //p head 取出 text 和链接\n                    elem = removeAttrs(elem);\n                    $elem = $(elem);\n                    htmlForP = $elem.html();\n\n                    // 剔除 a img 之外的元素\n                    htmlForP = htmlForP.replace(/<.*?>/ig, function (tag) {\n                        if (tag === '</a>' || tag.indexOf('<a ') === 0 || tag.indexOf('<img ') === 0) {\n                            return tag;\n                        } else {\n                            return '';\n                        }\n                    });\n\n                    return '<' + nodeName + '>' + htmlForP + '</' + nodeName + '>';\n                } else if (['ul', 'ol'].indexOf(nodeName) >= 0) {\n\n                    // ul ol元素，获取子元素（li元素）的text link img，再拼接\n                    $elem = $(elem);\n                    $elem.children().each(function () {\n                        var $li = $(removeAttrs(this));\n                        var html = $li.html();\n\n                        html = html.replace(/<.*?>/ig, function (tag) {\n                            if (tag === '</a>' || tag.indexOf('<a ') === 0 || tag.indexOf('<img ') === 0) {\n                                return tag;\n                            } else {\n                                return '';\n                            }\n                        });\n\n                        htmlForLi += '<li>' + html + '</li>';\n                    });\n                    return '<' + nodeName + '>' + htmlForLi + '</' + nodeName + '>';\n                } else {\n\n                    // 其他元素，移除元素属性\n                    $elem = $(removeAttrs(elem));\n                    return $('<div>').append($elem).html();\n                }\n            }\n\n            // 移除一个元素（子元素）的attr\n            function removeAttrs(elem) {\n                var attrs = elem.attributes || [];\n                var attrNames = [];\n                var exception = ['href', 'target', 'src', 'alt', 'rowspan', 'colspan']; //例外情况\n\n                // 先存储下elem中所有 attr 的名称\n                $.each(attrs, function (key, attr) {\n                    if (attr && attr.nodeType === 2) {\n                        attrNames.push(attr.nodeName);\n                    }\n                });\n                // 再根据名称删除所有attr\n                $.each(attrNames, function (key, attr) {\n                    if (exception.indexOf(attr) < 0) {\n                        // 除了 exception 规定的例外情况，删除其他属性\n                        elem.removeAttribute(attr);\n                    }\n                });\n\n                // 递归子节点\n                var children = elem.childNodes;\n                if (children.length) {\n                    $.each(children, function (key, value) {\n                        removeAttrs(value);\n                    });\n                }\n\n                return elem;\n            }\n        };\n\n        // 绑定 $txt.formatText() 方法\n        Txt.fn.bindFormatText = function () {\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n            var legalTags = E.config.legalTags;\n            var legalTagArr = legalTags.split(',');\n            var length = legalTagArr.length;\n            var regArr = [];\n\n            // 将 E.config.legalTags 配置的有效字符，生成正则表达式\n            $.each(legalTagArr, function (k, tag) {\n                var reg = '\\>\\\\s*\\<(' + tag + ')\\>';\n                regArr.push(new RegExp(reg, 'ig'));\n            });\n\n            // 增加 li \n            regArr.push(new RegExp('\\>\\\\s*\\<(li)\\>', 'ig'));\n\n            // 增加 tr\n            regArr.push(new RegExp('\\>\\\\s*\\<(tr)\\>', 'ig'));\n\n            // 增加 code\n            regArr.push(new RegExp('\\>\\\\s*\\<(code)\\>', 'ig'));\n\n            // 生成 formatText 方法\n            $txt.formatText = function () {\n                var $temp = $('<div>');\n                var html = $txt.html();\n\n                // 去除空格\n                html = html.replace(/\\s*</ig, '<');\n\n                // 段落、表格之间换行\n                $.each(regArr, function (k, reg) {\n                    if (!reg.test(html)) {\n                        return;\n                    }\n                    html = html.replace(reg, function (matchStr, tag) {\n                        return '>\\n<' + tag + '>';\n                    });\n                });\n\n                $temp.html(html);\n                return $temp.text();\n            };\n        };\n\n        // 定制 $txt.html 方法\n        Txt.fn.bindHtml = function () {\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n            var $valueContainer = editor.$valueContainer;\n            var valueNodeName = editor.valueNodeName;\n\n            $txt.html = function (html) {\n                var result;\n\n                if (valueNodeName === 'div') {\n                    // div 生成的编辑器，取值、赋值，都直接触发jquery的html方法\n                    result = $.fn.html.call($txt, html);\n                }\n\n                // textarea 生成的编辑器，则需要考虑赋值时，也给textarea赋值\n\n                if (html === undefined) {\n                    // 取值，直接触发jquery原生html方法\n                    result = $.fn.html.call($txt);\n\n                    // 替换 html 中，src和href属性中的 & 字符。\n                    // 因为 .html() 或者 .innerHTML 会把所有的 & 字符都改成 &amp; 但是 src 和 href 中的要保持 &\n                    result = result.replace(/(href|src)\\=\\\"(.*)\\\"/igm, function (a, b, c) {\n                        return b + '=\"' + c.replace('&amp;', '&') + '\"';\n                    });\n                } else {\n                    // 赋值，需要同时给 textarea 赋值\n                    result = $.fn.html.call($txt, html);\n                    $valueContainer.val(html);\n                }\n\n                if (html === undefined) {\n                    return result;\n                } else {\n                    // 手动触发 change 事件，因为 $txt 监控了 change 事件来判断是否需要执行 editor.onchange \n                    $txt.change();\n                }\n            };\n        };\n    });\n    // Txt.fn api\n    _e(function (E, $) {\n\n        var Txt = E.Txt;\n\n        var txtChangeEventNames = 'propertychange change click keyup input paste';\n\n        // 渲染\n        Txt.fn.render = function () {\n            var $txt = this.$txt;\n            var $editorContainer = this.editor.$editorContainer;\n            $editorContainer.append($txt);\n        };\n\n        // 计算高度\n        Txt.fn.initHeight = function () {\n            var editor = this.editor;\n            var $txt = this.$txt;\n            var valueContainerHeight = editor.$valueContainer.height();\n            var menuHeight = editor.menuContainer.height();\n            var txtHeight = valueContainerHeight - menuHeight;\n\n            // 限制最小为 50px\n            txtHeight = txtHeight < 50 ? 50 : txtHeight;\n\n            $txt.height(txtHeight);\n\n            // 记录原始高度\n            editor.valueContainerHeight = valueContainerHeight;\n\n            // 设置 max-height\n            this.initMaxHeight(txtHeight, menuHeight);\n        };\n\n        // 计算最大高度\n        Txt.fn.initMaxHeight = function (txtHeight, menuHeight) {\n            var editor = this.editor;\n            var $menuContainer = editor.menuContainer.$menuContainer;\n            var $txt = this.$txt;\n            var $wrap = $('<div>');\n\n            // 需要浏览器支持 max-height，否则不管\n            if (window.getComputedStyle && 'max-height' in window.getComputedStyle($txt.get(0))) {\n                // 获取 max-height 并判断是否有值\n                var maxHeight = parseInt(editor.$valueContainer.css('max-height'));\n                if (isNaN(maxHeight)) {\n                    return;\n                }\n\n                // max-height 和『全屏』暂时有冲突\n                if (editor.menus.fullscreen) {\n                    E.warn('max-height和『全屏』菜单一起使用时，会有一些问题尚未解决，请暂时不要两个同时使用');\n                    return;\n                }\n\n                // 标记\n                editor.useMaxHeight = true;\n\n                // 设置maxheight\n                $wrap.css({\n                    'max-height': maxHeight - menuHeight + 'px',\n                    'overflow-y': 'auto'\n                });\n                $txt.css({\n                    'height': 'auto',\n                    'overflow-y': 'visible',\n                    'min-height': txtHeight + 'px'\n                });\n\n                // 滚动式，菜单阴影\n                $wrap.on('scroll', function () {\n                    if ($txt.parent().scrollTop() > 10) {\n                        $menuContainer.addClass('wangEditor-menu-shadow');\n                    } else {\n                        $menuContainer.removeClass('wangEditor-menu-shadow');\n                    }\n                });\n\n                // 需在编辑器区域外面再包裹一层\n                $txt.wrap($wrap);\n            }\n        };\n\n        // 保存选区\n        Txt.fn.saveSelectionEvent = function () {\n            var $txt = this.$txt;\n            var editor = this.editor;\n            var timeoutId;\n            var dt = Date.now();\n\n            function save() {\n                editor.saveSelection();\n            }\n\n            // 同步保存选区\n            function saveSync() {\n                // 100ms之内，不重复保存\n                if (Date.now() - dt < 100) {\n                    return;\n                }\n\n                dt = Date.now();\n                save();\n            }\n\n            // 异步保存选区\n            function saveAync() {\n                // 节流，防止高频率重复操作\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n                timeoutId = setTimeout(save, 300);\n            }\n\n            // txt change 、focus、blur 时随时保存选区\n            $txt.on(txtChangeEventNames + ' focus blur', function (e) {\n                // 先同步保存选区，为了让接下来就马上要执行 editor.getRangeElem() 的程序\n                // 能够获取到正确的 rangeElem\n                saveSync();\n\n                // 再异步保存选区，为了确定更加准确的选区，为后续的操作做准备\n                saveAync();\n            });\n\n            // 鼠标拖拽选择时，可能会拖拽到编辑器区域外面再松手，此时 $txt 就监听不到 click事件了\n            $txt.on('mousedown', function () {\n                $txt.on('mouseleave.saveSelection', function (e) {\n                    // 先同步后异步，如上述注释\n                    saveSync();\n                    saveAync();\n\n                    // 顺道吧菜单状态也更新了\n                    editor.updateMenuStyle();\n                });\n            }).on('mouseup', function () {\n                $txt.off('mouseleave.saveSelection');\n            });\n        };\n\n        // 随时更新 value\n        Txt.fn.updateValueEvent = function () {\n            var $txt = this.$txt;\n            var editor = this.editor;\n            var timeoutId, oldValue;\n\n            // 触发 onchange 事件\n            function doOnchange() {\n                var val = $txt.html();\n                if (oldValue === val) {\n                    // 无变化\n                    return;\n                }\n\n                // 触发 onchange 事件\n                if (editor.onchange && typeof editor.onchange === 'function') {\n                    editor.onchange.call(editor);\n                }\n\n                // 更新内容\n                editor.updateValue();\n\n                // 记录最新内容\n                oldValue = val;\n            }\n\n            // txt change 时随时更新内容\n            $txt.on(txtChangeEventNames, function (e) {\n                // 初始化\n                if (oldValue == null) {\n                    oldValue = $txt.html();\n                }\n\n                // 监控内容变化（停止操作 100ms 之后立即执行）\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n                timeoutId = setTimeout(doOnchange, 100);\n            });\n        };\n\n        // 随时更新 menustyle\n        Txt.fn.updateMenuStyleEvent = function () {\n            var $txt = this.$txt;\n            var editor = this.editor;\n\n            // txt change 时随时更新内容\n            $txt.on(txtChangeEventNames, function (e) {\n                editor.updateMenuStyle();\n            });\n        };\n\n        // 最后插入试图插入 <p><br><p>\n        Txt.fn.insertEmptyP = function () {\n            var $txt = this.$txt;\n            var $children = $txt.children();\n\n            if ($children.length === 0) {\n                $txt.append($('<p><br></p>'));\n                return;\n            }\n\n            if ($.trim($children.last().html()).toLowerCase() !== '<br>') {\n                $txt.append($('<p><br></p>'));\n            }\n        };\n\n        // 将编辑器暴露出来的文字和图片，都用 p 来包裹\n        Txt.fn.wrapImgAndText = function () {\n            var $txt = this.$txt;\n            var $imgs = $txt.children('img');\n            var txt = $txt[0];\n            var childNodes = txt.childNodes;\n            var childrenLength = childNodes.length;\n            var i, childNode, p;\n\n            // 处理图片\n            $imgs.length && $imgs.each(function () {\n                $(this).wrap('<p>');\n            });\n\n            // 处理文字\n            for (i = 0; i < childrenLength; i++) {\n                childNode = childNodes[i];\n                if (childNode.nodeType === 3 && childNode.textContent && $.trim(childNode.textContent)) {\n                    $(childNode).wrap('<p>');\n                }\n            }\n        };\n\n        // 清空内容为空的<p>，以及重复包裹的<p>（在windows下的chrome粘贴文字之后，会出现上述情况）\n        Txt.fn.clearEmptyOrNestP = function () {\n            var $txt = this.$txt;\n            var $pList = $txt.find('p');\n\n            $pList.each(function () {\n                var $p = $(this);\n                var $children = $p.children();\n                var childrenLength = $children.length;\n                var $firstChild;\n                var content = $.trim($p.html());\n\n                // 内容为空的p\n                if (!content) {\n                    $p.remove();\n                    return;\n                }\n\n                // 嵌套的p\n                if (childrenLength === 1) {\n                    $firstChild = $children.first();\n                    if ($firstChild.get(0) && $firstChild.get(0).nodeName === 'P') {\n                        $p.html($firstChild.html());\n                    }\n                }\n            });\n        };\n\n        // 获取 scrollTop\n        Txt.fn.scrollTop = function (val) {\n            var self = this;\n            var editor = self.editor;\n            var $txt = self.$txt;\n\n            if (editor.useMaxHeight) {\n                return $txt.parent().scrollTop(val);\n            } else {\n                return $txt.scrollTop(val);\n            }\n        };\n\n        // 鼠标hover时候，显示p、head的高度\n        Txt.fn.showHeightOnHover = function () {\n            var editor = this.editor;\n            var $editorContainer = editor.$editorContainer;\n            var menuContainer = editor.menuContainer;\n            var $txt = this.$txt;\n            var $tip = $('<i class=\"height-tip\"><i>');\n            var isTipInTxt = false;\n\n            function addAndShowTip($target) {\n                if (!isTipInTxt) {\n                    $editorContainer.append($tip);\n                    isTipInTxt = true;\n                }\n\n                var txtTop = $txt.position().top;\n                var txtHeight = $txt.outerHeight();\n\n                var height = $target.height();\n                var top = $target.position().top;\n                var marginTop = parseInt($target.css('margin-top'), 10);\n                var paddingTop = parseInt($target.css('padding-top'), 10);\n                var marginBottom = parseInt($target.css('margin-bottom'), 10);\n                var paddingBottom = parseInt($target.css('padding-bottom'), 10);\n\n                // 计算初步的结果\n                var resultHeight = height + paddingTop + marginTop + paddingBottom + marginBottom;\n                var resultTop = top + menuContainer.height();\n\n                // var spaceValue;\n\n                // // 判断是否超出下边界\n                // spaceValue = (resultTop + resultHeight) - (txtTop + txtHeight);\n                // if (spaceValue > 0) {\n                //     resultHeight = resultHeight - spaceValue;\n                // }\n\n                // // 判断是否超出了下边界\n                // spaceValue = txtTop > resultTop;\n                // if (spaceValue) {\n                //     resultHeight = resultHeight - spaceValue;\n                //     top = top + spaceValue;\n                // }\n\n                // 按照最终结果渲染\n                $tip.css({\n                    height: height + paddingTop + marginTop + paddingBottom + marginBottom,\n                    top: top + menuContainer.height()\n                });\n            }\n            function removeTip() {\n                if (!isTipInTxt) {\n                    return;\n                }\n                $tip.remove();\n                isTipInTxt = false;\n            }\n\n            $txt.on('mouseenter', 'ul,ol,blockquote,p,h1,h2,h3,h4,h5,table,pre', function (e) {\n                addAndShowTip($(e.currentTarget));\n            }).on('mouseleave', function () {\n                removeTip();\n            });\n        };\n    });\n    // 工具函数\n    _e(function (E, $) {\n\n        // IE8 [].indexOf()\n        if (!Array.prototype.indexOf) {\n            //IE低版本不支持 arr.indexOf \n            Array.prototype.indexOf = function (elem) {\n                var i = 0,\n                    length = this.length;\n                for (; i < length; i++) {\n                    if (this[i] === elem) {\n                        return i;\n                    }\n                }\n                return -1;\n            };\n            //IE低版本不支持 arr.lastIndexOf\n            Array.prototype.lastIndexOf = function (elem) {\n                var length = this.length;\n                for (length = length - 1; length >= 0; length--) {\n                    if (this[length] === elem) {\n                        return length;\n                    }\n                }\n                return -1;\n            };\n        }\n\n        // IE8 Date.now()\n        if (!Date.now) {\n            Date.now = function () {\n                return new Date().valueOf();\n            };\n        }\n\n        // console.log && console.warn && console.error\n        var console = window.console;\n        var emptyFn = function emptyFn() {};\n        $.each(['info', 'log', 'warn', 'error'], function (key, value) {\n            if (console == null) {\n                E[value] = emptyFn;\n            } else {\n                E[value] = function (info) {\n                    // 通过配置来控制打印输出\n                    if (E.config && E.config.printLog) {\n                        console[value]('wangEditor提示: ' + info);\n                    }\n                };\n            }\n        });\n\n        // 获取随机数\n        E.random = function () {\n            return Math.random().toString().slice(2);\n        };\n\n        // 浏览器是否支持 placeholder\n        E.placeholder = 'placeholder' in document.createElement('input');\n\n        // 兼容IE8的 input placeholder\n        E.placeholderForIE8 = function ($container) {\n            if (E.placeholder) {\n                return;\n            }\n            $container.find('input[placeholder]').each(function () {\n                var $input = $(this);\n                var placeholder = $input.attr('placeholder');\n\n                if ($input.val() === '') {\n                    $input.css('color', '#666');\n                    $input.val(placeholder);\n\n                    $input.on('focus.placeholder click.placeholder', function () {\n                        $input.val('');\n                        $input.css('color', '#333');\n                        $input.off('focus.placeholder click.placeholder');\n                    });\n                }\n            });\n        };\n    });\n    // 语言包\n    _e(function (E, $) {\n        E.langs = {};\n\n        // 中文\n        E.langs['zh-cn'] = {\n            bold: '粗体',\n            underline: '下划线',\n            italic: '斜体',\n            forecolor: '文字颜色',\n            bgcolor: '背景色',\n            strikethrough: '删除线',\n            eraser: '清空格式',\n            source: '源码',\n            quote: '引用',\n            fontfamily: '字体',\n            fontsize: '字号',\n            head: '标题',\n            orderlist: '有序列表',\n            unorderlist: '无序列表',\n            alignleft: '左对齐',\n            aligncenter: '居中',\n            alignright: '右对齐',\n            link: '链接',\n            text: '文本',\n            submit: '提交',\n            cancel: '取消',\n            unlink: '取消链接',\n            table: '表格',\n            emotion: '表情',\n            img: '图片',\n            uploadImg: '上传图片',\n            linkImg: '网络图片',\n            video: '视频',\n            'width': '宽',\n            'height': '高',\n            location: '位置',\n            loading: '加载中',\n            searchlocation: '搜索位置',\n            dynamicMap: '动态地图',\n            clearLocation: '清除位置',\n            langDynamicOneLocation: '动态地图只能显示一个位置',\n            insertcode: '插入代码',\n            undo: '撤销',\n            redo: '重复',\n            fullscreen: '全屏',\n            openLink: '打开链接'\n        };\n\n        // 英文\n        E.langs.en = {\n            bold: 'Bold',\n            underline: 'Underline',\n            italic: 'Italic',\n            forecolor: 'Color',\n            bgcolor: 'Backcolor',\n            strikethrough: 'Strikethrough',\n            eraser: 'Eraser',\n            source: 'Codeview',\n            quote: 'Quote',\n            fontfamily: 'Font family',\n            fontsize: 'Font size',\n            head: 'Head',\n            orderlist: 'Ordered list',\n            unorderlist: 'Unordered list',\n            alignleft: 'Align left',\n            aligncenter: 'Align center',\n            alignright: 'Align right',\n            link: 'Insert link',\n            text: 'Text',\n            submit: 'Submit',\n            cancel: 'Cancel',\n            unlink: 'Unlink',\n            table: 'Table',\n            emotion: 'Emotions',\n            img: 'Image',\n            uploadImg: 'Upload',\n            linkImg: 'Link',\n            video: 'Video',\n            'width': 'width',\n            'height': 'height',\n            location: 'Location',\n            loading: 'Loading',\n            searchlocation: 'search',\n            dynamicMap: 'Dynamic',\n            clearLocation: 'Clear',\n            langDynamicOneLocation: 'Only one location in dynamic map',\n            insertcode: 'Insert Code',\n            undo: 'Undo',\n            redo: 'Redo',\n            fullscreen: 'Full screnn',\n            openLink: 'open link'\n        };\n    });\n    // 全局配置\n    _e(function (E, $) {\n\n        E.config = {};\n\n        // 全屏时的 z-index\n        E.config.zindex = 10000;\n\n        // 是否打印log\n        E.config.printLog = true;\n\n        // 菜单吸顶：false - 不吸顶；number - 吸顶，值为top值\n        E.config.menuFixed = 0;\n\n        // 编辑源码时，过滤 javascript\n        E.config.jsFilter = true;\n\n        // 编辑器允许的标签\n        E.config.legalTags = 'p,h1,h2,h3,h4,h5,h6,blockquote,table,ul,ol,pre';\n\n        // 语言包\n        E.config.lang = E.langs['zh-cn'];\n\n        // 菜单配置\n        E.config.menus = ['source', '|', 'bold', 'underline', 'italic', 'strikethrough', 'eraser', 'forecolor', 'bgcolor', '|', 'quote', 'fontfamily', 'fontsize', 'head', 'unorderlist', 'orderlist', 'alignleft', 'aligncenter', 'alignright', '|', 'link', 'unlink', 'table', 'emotion', '|', 'img', 'video', 'location', 'insertcode', '|', 'undo', 'redo', 'fullscreen'];\n\n        // 颜色配置\n        E.config.colors = {\n            // 'value': 'title'\n            '#880000': '暗红色',\n            '#800080': '紫色',\n            '#ff0000': '红色',\n            '#ff00ff': '鲜粉色',\n            '#000080': '深蓝色',\n            '#0000ff': '蓝色',\n            '#00ffff': '湖蓝色',\n            '#008080': '蓝绿色',\n            '#008000': '绿色',\n            '#808000': '橄榄色',\n            '#00ff00': '浅绿色',\n            '#ffcc00': '橙黄色',\n            '#808080': '灰色',\n            '#c0c0c0': '银色',\n            '#000000': '黑色',\n            '#ffffff': '白色'\n        };\n\n        // 字体\n        E.config.familys = ['宋体', '黑体', '楷体', '微软雅黑', 'Arial', 'Verdana', 'Georgia', 'Times New Roman', 'Microsoft JhengHei', 'Trebuchet MS', 'Courier New', 'Impact', 'Comic Sans MS', 'Consolas'];\n\n        // 字号\n        E.config.fontsizes = {\n            // 格式：'value': 'title'\n            1: '12px',\n            2: '13px',\n            3: '16px',\n            4: '18px',\n            5: '24px',\n            6: '32px',\n            7: '48px'\n        };\n\n        // 表情包\n        E.config.emotionsShow = 'icon'; // 显示项，默认为'icon'，也可以配置成'value'\n        E.config.emotions = {\n            // 'default': {\n            //     title: '默认',\n            //     data: './emotions.data'\n            // },\n            'weibo': {\n                title: '微博表情',\n                data: [{\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif',\n                    value: '[草泥马]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif',\n                    value: '[神马]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/fuyun_thumb.gif',\n                    value: '[浮云]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c9/geili_thumb.gif',\n                    value: '[给力]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/f2/wg_thumb.gif',\n                    value: '[围观]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/70/vw_thumb.gif',\n                    value: '[威武]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6e/panda_thumb.gif',\n                    value: '[熊猫]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/81/rabbit_thumb.gif',\n                    value: '[兔子]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/otm_thumb.gif',\n                    value: '[奥特曼]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/15/j_thumb.gif',\n                    value: '[囧]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/89/hufen_thumb.gif',\n                    value: '[互粉]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c4/liwu_thumb.gif',\n                    value: '[礼物]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/ac/smilea_thumb.gif',\n                    value: '[呵呵]'\n                }, {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/0b/tootha_thumb.gif',\n                    value: '[哈哈]'\n                }]\n            }\n        };\n\n        // 百度地图的key\n        E.config.mapAk = 'TVhjYjq1ICT2qqL5LdS8mwas';\n\n        // 上传图片的配置\n        // server地址\n        E.config.uploadImgUrl = '';\n        // 超时时间\n        E.config.uploadTimeout = 20 * 1000;\n        // 用于存储上传回调事件\n        E.config.uploadImgFns = {};\n        // 自定义上传图片的filename\n        // E.config.uploadImgFileName = 'customFileName';\n\n        // 自定义上传，设置为 true 之后，显示上传图标\n        E.config.customUpload = false;\n        // 自定义上传的init事件\n        // E.config.customUploadInit = function () {....};\n\n        // 自定义上传时传递的参数（如 token）\n        E.config.uploadParams = {\n            /* token: 'abcdef12345' */\n        };\n\n        // 自定义上传是的header参数\n        E.config.uploadHeaders = {\n            /* 'Accept' : 'text/x-json' */\n        };\n\n        // 跨域上传时传递 cookie，默认为 true\n        E.config.withCredentials = true;\n\n        // 隐藏网络图片，默认为 false\n        E.config.hideLinkImg = false;\n\n        // 是否过滤粘贴内容\n        E.config.pasteFilter = true;\n\n        // 是否粘贴纯文本，当 editor.config.pasteFilter === false 时候，此配置将失效\n        E.config.pasteText = false;\n\n        // 插入代码时，默认的语言\n        E.config.codeDefaultLang = 'javascript';\n    });\n    // 全局UI\n    _e(function (E, $) {\n\n        E.UI = {};\n\n        // 为菜单自定义配置的UI\n        E.UI.menus = {\n            // 这个 default 不加引号，在 IE8 会报错\n            'default': {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-command\"></i></a>',\n                selected: '.selected'\n            },\n            bold: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-bold\"></i></a>',\n                selected: '.selected'\n            },\n            underline: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-underline\"></i></a>',\n                selected: '.selected'\n            },\n            italic: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-italic\"></i></a>',\n                selected: '.selected'\n            },\n            forecolor: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-pencil\"></i></a>',\n                selected: '.selected'\n            },\n            bgcolor: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-brush\"></i></a>',\n                selected: '.selected'\n            },\n            strikethrough: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-strikethrough\"></i></a>',\n                selected: '.selected'\n            },\n            eraser: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-eraser\"></i></a>',\n                selected: '.selected'\n            },\n            quote: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-quotes-left\"></i></a>',\n                selected: '.selected'\n            },\n            source: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-code\"></i></a>',\n                selected: '.selected'\n            },\n            fontfamily: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-font2\"></i></a>',\n                selected: '.selected'\n            },\n            fontsize: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-text-height\"></i></a>',\n                selected: '.selected'\n            },\n            head: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-header\"></i></a>',\n                selected: '.selected'\n            },\n            orderlist: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-list-numbered\"></i></a>',\n                selected: '.selected'\n            },\n            unorderlist: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-list-bullet\"></i></a>',\n                selected: '.selected'\n            },\n            alignleft: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-left\"></i></a>',\n                selected: '.selected'\n            },\n            aligncenter: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-center\"></i></a>',\n                selected: '.selected'\n            },\n            alignright: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-right\"></i></a>',\n                selected: '.selected'\n            },\n            link: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-link\"></i></a>',\n                selected: '.selected'\n            },\n            unlink: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-unlink\"></i></a>',\n                selected: '.selected'\n            },\n            table: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-table\"></i></a>',\n                selected: '.selected'\n            },\n            emotion: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-happy\"></i></a>',\n                selected: '.selected'\n            },\n            img: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-picture\"></i></a>',\n                selected: '.selected'\n            },\n            video: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-play\"></i></a>',\n                selected: '.selected'\n            },\n            location: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-location\"></i></a>',\n                selected: '.selected'\n            },\n            insertcode: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-terminal\"></i></a>',\n                selected: '.selected'\n            },\n            undo: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-ccw\"></i></a>',\n                selected: '.selected'\n            },\n            redo: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-cw\"></i></a>',\n                selected: '.selected'\n            },\n            fullscreen: {\n                normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-enlarge2\"></i></a>',\n                selected: '<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-shrink2\"></i></a>'\n            }\n        };\n    });\n    // 对象配置\n    _e(function (E, $) {\n\n        E.fn.initDefaultConfig = function () {\n            var editor = this;\n            editor.config = $.extend({}, E.config);\n            editor.UI = $.extend({}, E.UI);\n        };\n    });\n    // 增加 container\n    _e(function (E, $) {\n\n        E.fn.addEditorContainer = function () {\n            this.$editorContainer = $('<div class=\"wangEditor-container\"></div>');\n        };\n    });\n    // 增加编辑区域对象\n    _e(function (E, $) {\n\n        E.fn.addTxt = function () {\n            var editor = this;\n            var txt = new E.Txt(editor);\n\n            editor.txt = txt;\n        };\n    });\n    // 增加menuContainer对象\n    _e(function (E, $) {\n\n        E.fn.addMenuContainer = function () {\n            var editor = this;\n            editor.menuContainer = new E.MenuContainer(editor);\n        };\n    });\n    // 增加menus\n    _e(function (E, $) {\n\n        // 存储创建菜单的函数\n        E.createMenuFns = [];\n        E.createMenu = function (fn) {\n            E.createMenuFns.push(fn);\n        };\n\n        // 创建所有菜单\n        E.fn.addMenus = function () {\n            var editor = this;\n            var menuIds = editor.config.menus;\n\n            // 检验 menuId 是否在配置中存在\n            function check(menuId) {\n                if (menuIds.indexOf(menuId) >= 0) {\n                    return true;\n                }\n                return false;\n            }\n\n            // 遍历所有的菜单创建函数，并执行\n            $.each(E.createMenuFns, function (k, createMenuFn) {\n                createMenuFn.call(editor, check);\n            });\n        };\n    });\n    // bold菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'bold';\n            if (!check(menuId)) {\n                return;\n            }\n\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.bold,\n                commandName: 'Bold'\n            });\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 如果选区有内容，则执行基础命令\n                    editor.command(e, 'Bold');\n                } else {\n                    // 如果选区没有内容\n                    editor.commandForElem('b,strong,h1,h2,h3,h4,h5', e, 'Bold');\n                }\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // underline菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'underline';\n            if (!check(menuId)) {\n                return;\n            }\n\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.underline,\n                commandName: 'Underline'\n            });\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 如果选区有内容，则执行基础命令\n                    editor.command(e, 'Underline');\n                } else {\n                    // 如果选区没有内容\n                    editor.commandForElem('u,a', e, 'Underline');\n                }\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // italic 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'italic';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.italic,\n                commandName: 'Italic'\n            });\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 如果选区有内容，则执行基础命令\n                    editor.command(e, 'Italic');\n                } else {\n                    // 如果选区没有内容\n                    editor.commandForElem('i', e, 'Italic');\n                }\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // forecolor 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'forecolor';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var configColors = editor.config.colors;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.forecolor\n            });\n\n            // 创建 dropPanel\n            var $content = $('<div></div>');\n            $.each(configColors, function (k, v) {\n                $content.append(['<a href=\"#\" class=\"color-item\"', '    title=\"' + v + '\" commandValue=\"' + k + '\" ', '    style=\"color: ' + k + '\" ', '><i class=\"wangeditor-menu-img-pencil\"></i></a>'].join(''));\n            });\n            $content.on('click', 'a[commandValue]', function (e) {\n                // 执行命令\n                var $elem = $(this);\n                var commandValue = $elem.attr('commandValue');\n\n                if (menu.selected && editor.isRangeEmpty()) {\n                    // 当前处于选中状态，并且选中内容为空\n                    editor.commandForElem('font[color]', e, 'forecolor', commandValue);\n                } else {\n                    // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                    editor.command(e, 'forecolor', commandValue);\n                }\n            });\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 125\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[color]');\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // bgcolor 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'bgcolor';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var configColors = editor.config.colors;\n\n            // 检查元素是否有 background-color: 内联样式\n            function checkElemFn(elem) {\n                var cssText;\n                if (elem && elem.style && elem.style.cssText != null) {\n                    cssText = elem.style.cssText;\n                    if (cssText && cssText.indexOf('background-color:') >= 0) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.bgcolor\n            });\n\n            // 创建 dropPanel\n            var $content = $('<div></div>');\n            $.each(configColors, function (k, v) {\n                $content.append(['<a href=\"#\" class=\"color-item\"', '    title=\"' + v + '\" commandValue=\"' + k + '\" ', '    style=\"color: ' + k + '\" ', '><i class=\"wangeditor-menu-img-brush\"></i></a>'].join(''));\n            });\n            $content.on('click', 'a[commandValue]', function (e) {\n                // 执行命令\n\n                var $elem = $(this);\n                var commandValue = $elem.attr('commandValue');\n\n                if (menu.selected && editor.isRangeEmpty()) {\n                    // 当前处于选中状态，并且选中内容为空。使用 commandForElem 执行命令\n                    editor.commandForElem({\n                        selector: 'span,font',\n                        check: checkElemFn\n                    }, e, 'BackColor', commandValue);\n                } else {\n                    // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                    editor.command(e, 'BackColor', commandValue);\n                }\n            });\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 125\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'span,font', checkElemFn);\n\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // strikethrough 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'strikethrough';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.strikethrough,\n                commandName: 'StrikeThrough'\n            });\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 如果选区有内容，则执行基础命令\n                    editor.command(e, 'StrikeThrough');\n                } else {\n                    // 如果选区没有内容\n                    editor.commandForElem('strike', e, 'StrikeThrough');\n                }\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // eraser 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'eraser';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.eraser,\n                commandName: 'RemoveFormat'\n            });\n\n            // 定义点击事件\n            menu.clickEvent = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n\n                if (!isRangeEmpty) {\n                    // 选区不是空的，则执行默认命令\n                    editor.command(e, 'RemoveFormat');\n                    return;\n                }\n\n                var $clearElem;\n\n                // 自定义的命令函数\n                function commandFn() {\n                    var editor = this;\n                    var rangeElem;\n                    var pElem, $pElem;\n                    var quoteElem, $quoteElem;\n                    var listElem, $listElem;\n\n                    // 获取选区 elem\n                    rangeElem = editor.getRangeElem();\n                    // 第一步，获取 quote 父元素\n                    quoteElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                    if (quoteElem) {\n                        $quoteElem = $(quoteElem);\n                        $clearElem = $('<p>' + $quoteElem.text() + '</p>');\n                        $quoteElem.after($clearElem).remove();\n                    }\n                    // 第二步，获取 p h 父元素\n                    pElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5');\n                    if (pElem) {\n                        $pElem = $(pElem);\n                        $clearElem = $('<p>' + $pElem.text() + '</p>');\n                        $pElem.after($clearElem).remove();\n                    }\n                    // 第三步，获取list\n                    listElem = editor.getSelfOrParentByName(rangeElem, 'ul,ol');\n                    if (listElem) {\n                        $listElem = $(listElem);\n                        $clearElem = $('<p>' + $listElem.text() + '</p>');\n                        $listElem.after($clearElem).remove();\n                    }\n                }\n\n                // 自定义 callback 事件\n                function callback() {\n                    // callback中，设置range为clearElem\n                    var editor = this;\n                    if ($clearElem) {\n                        editor.restoreSelectionByElem($clearElem.get(0));\n                    }\n                }\n\n                // 执行自定义命令\n                editor.customCommand(e, commandFn, callback);\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // source 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'source';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var txtHtml;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.source\n            });\n\n            menu.isShowCode = false;\n\n            // 更新内容\n            function updateValue() {\n                var $code = menu.$codeTextarea;\n                var $txt = editor.txt.$txt;\n                var value = $.trim($code.val()); // 取值\n\n                if (!value) {\n                    value = '<p><br></p>';\n                }\n\n                // 过滤js代码\n                if (editor.config.jsFilter) {\n\n                    value = value.replace(/<script[\\s\\S]*?<\\/script>/ig, '');\n                }\n                // 赋值\n                try {\n                    $txt.html(value);\n                } catch (ex) {\n                    // 更新 html 源码出错，一般都是取消了 js 过滤之后，js报错导致的\n                }\n            }\n\n            // 定义click事件\n            menu.clickEvent = function (e) {\n                var self = this;\n                var editor = self.editor;\n                var $txt = editor.txt.$txt;\n                var txtOuterHeight = $txt.outerHeight();\n                var txtHeight = $txt.height();\n\n                if (!self.$codeTextarea) {\n                    self.$codeTextarea = $('<textarea class=\"code-textarea\"></textarea>');\n                }\n                var $code = self.$codeTextarea;\n                $code.css({\n                    height: txtHeight,\n                    'margin-top': txtOuterHeight - txtHeight\n                });\n\n                // 赋值\n                $code.val($txt.html());\n\n                // 监控变化\n                $code.on('change', function (e) {\n                    updateValue();\n                });\n\n                // 渲染\n                $txt.after($code).hide();\n                $code.show();\n\n                // 更新状态\n                menu.isShowCode = true;\n\n                // 执行 updateSelected 事件\n                this.updateSelected();\n\n                // 禁用其他菜单\n                editor.disableMenusExcept('source');\n\n                // 记录当前html值\n                txtHtml = $txt.html();\n            };\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var self = this;\n                var editor = self.editor;\n                var $txt = editor.txt.$txt;\n                var $code = self.$codeTextarea;\n                var value;\n\n                if (!$code) {\n                    return;\n                }\n\n                // 更新内容\n                updateValue();\n\n                // 渲染\n                $code.after($txt).hide();\n                $txt.show();\n\n                // 更新状态\n                menu.isShowCode = false;\n\n                // 执行 updateSelected 事件\n                this.updateSelected();\n\n                // 启用其他菜单\n                editor.enableMenusExcept('source');\n\n                // 判断是否执行 onchange 事件\n                if ($txt.html() !== txtHtml) {\n                    if (editor.onchange && typeof editor.onchange === 'function') {\n                        editor.onchange.call(editor);\n                    }\n                }\n            };\n\n            // 定义切换选中状态事件\n            menu.updateSelectedEvent = function () {\n                return this.isShowCode;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // quote 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'quote';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.quote,\n                commandName: 'formatBlock',\n                commandValue: 'blockquote'\n            });\n\n            // 定义click事件\n            menu.clickEvent = function (e) {\n                var rangeElem = editor.getRangeElem();\n                var $rangeElem;\n                if (!rangeElem) {\n                    e.preventDefault();\n                    return;\n                }\n                var currentQuote = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                var $quote;\n\n                if (currentQuote) {\n                    // 说明当前在quote之内，不做任何处理\n                    e.preventDefault();\n                    return;\n                }\n\n                rangeElem = editor.getLegalTags(rangeElem);\n                $rangeElem = $(rangeElem);\n\n                // 无文字，则不允许执行引用\n                if (!$rangeElem.text()) {\n                    return;\n                }\n\n                if (!rangeElem) {\n                    // 执行默认命令\n                    // IE8 下执行此处（不过，经测试代码无效，也不报错）\n                    editor.command(e, 'formatBlock', 'blockquote');\n                    return;\n                }\n\n                // 自定义command事件\n                function commandFn() {\n                    $quote = $('<p>' + $rangeElem.text() + '</p>');\n                    $rangeElem.after($quote).remove();\n                    $quote.wrap('<blockquote>');\n                }\n\n                // 自定义 callback 事件\n                function callback() {\n                    // callback中，设置range为quote\n                    var editor = this;\n                    if ($quote) {\n                        editor.restoreSelectionByElem($quote.get(0));\n                    }\n                }\n\n                // 执行自定义命令\n                editor.customCommand(e, commandFn, callback);\n            };\n\n            // 定义选中状态下的click事件\n            menu.clickEventSelected = function (e) {\n                var rangeElem;\n                var quoteElem;\n                var $lastChild;\n\n                // 获取当前选区的elem，并试图往上找 quote 元素\n                rangeElem = editor.getRangeElem();\n                quoteElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                if (!quoteElem) {\n                    // 没找到，则返回\n                    e.preventDefault();\n                    return;\n                }\n\n                // 自定义的command事件\n                function commandFn() {\n                    var $quoteElem;\n                    var $children;\n\n                    $quoteElem = $(quoteElem);\n                    $children = $quoteElem.children();\n                    if ($children.length) {\n                        $children.each(function (k) {\n                            var $item = $(this);\n                            if ($item.get(0).nodeName === 'P') {\n                                $quoteElem.after($item);\n                            } else {\n                                $quoteElem.after('<p>' + $item.text() + '</p>');\n                            }\n                            $lastChild = $item; // 记录最后一个子元素，用于callback中的range定位\n                        });\n                        $quoteElem.remove();\n                        return;\n                    }\n                }\n\n                // 自定义的callback函数\n                function callback() {\n                    // callback中，设置range为lastChild\n                    var editor = this;\n                    if ($lastChild) {\n                        editor.restoreSelectionByElem($lastChild.get(0));\n                    }\n                }\n\n                // 执行自定义命令\n                editor.customCommand(e, commandFn, callback);\n            };\n\n            // 定义更新选中状态的事件\n            menu.updateSelectedEvent = function () {\n                var self = this; //菜单对象\n                var editor = self.editor;\n                var rangeElem;\n\n                rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n\n                if (rangeElem) {\n                    return true;\n                }\n\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n\n            // --------------- 两次点击 enter 跳出引用 ---------------\n            editor.ready(function () {\n                var editor = this;\n                var $txt = editor.txt.$txt;\n                var isPrevEnter = false; // 是不是刚刚在quote中按了 enter 键\n                $txt.on('keydown', function (e) {\n                    if (e.keyCode !== 13) {\n                        // 不是 enter 键\n                        isPrevEnter = false;\n                        return;\n                    }\n\n                    var rangeElem = editor.getRangeElem();\n                    rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                    if (!rangeElem) {\n                        // 选区不是 quote\n                        isPrevEnter = false;\n                        return;\n                    }\n\n                    if (!isPrevEnter) {\n                        // 最近没有在qote中按enter键\n                        isPrevEnter = true;\n                        return;\n                    }\n\n                    var currentRangeElem = editor.getRangeElem();\n                    var $currentRangeElem = $(currentRangeElem);\n                    if ($currentRangeElem.length) {\n                        $currentRangeElem.parent().after($currentRangeElem);\n                    }\n\n                    // 设置选区\n                    editor.restoreSelectionByElem(currentRangeElem, 'start');\n\n                    isPrevEnter = false;\n                    // 阻止默认行文\n                    e.preventDefault();\n                });\n            }); // editor.ready(\n\n            // --------------- 处理quote中无内容时不能删除的问题 ---------------\n            editor.ready(function () {\n                var editor = this;\n                var $txt = editor.txt.$txt;\n                var $rangeElem;\n\n                function commandFn() {\n                    $rangeElem && $rangeElem.remove();\n                }\n                function callback() {\n                    if (!$rangeElem) {\n                        return;\n                    }\n                    var $prev = $rangeElem.prev();\n                    if ($prev.length) {\n                        // 有 prev 则定位到 prev 最后\n                        editor.restoreSelectionByElem($prev.get(0));\n                    } else {\n                        // 无 prev 则初始化选区\n                        editor.initSelection();\n                    }\n                }\n\n                $txt.on('keydown', function (e) {\n                    if (e.keyCode !== 8) {\n                        // 不是 backspace 键\n                        return;\n                    }\n\n                    var rangeElem = editor.getRangeElem();\n                    rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                    if (!rangeElem) {\n                        // 选区不是 quote\n                        return;\n                    }\n                    $rangeElem = $(rangeElem);\n\n                    var text = $rangeElem.text();\n                    if (text) {\n                        // quote 中还有内容\n                        return;\n                    }\n                    editor.customCommand(e, commandFn, callback);\n                }); // $txt.on\n            }); // editor.ready(\n        });\n    });\n    // 字体 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'fontfamily';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var configFamilys = editor.config.familys;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.fontfamily,\n                commandName: 'fontName'\n            });\n\n            // 初始化数据\n            var data = {};\n            /*\n                data 需要的结构\n                {\n                    'commandValue': 'title'\n                    ...\n                }\n            */\n            $.each(configFamilys, function (k, v) {\n                // configFamilys 是数组，data 是对象\n                data[v] = v;\n            });\n\n            // 创建droplist\n            var tpl = '<span style=\"font-family:{#commandValue};\">{#title}</span>';\n            menu.dropList = new E.DropList(editor, menu, {\n                data: data,\n                tpl: tpl,\n                selectorForELemCommand: 'font[face]' // 为了执行 editor.commandForElem 而传入的elem查询方式\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[face]');\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // 字号 菜单\n    _e(function (E, $) {\n        E.createMenu(function (check) {\n            var menuId = 'fontsize';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var configSize = editor.config.fontsizes;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.fontsize,\n                commandName: 'fontSize'\n            });\n\n            // 初始化数据\n            var data = configSize;\n            /*\n                data 需要的结构\n                {\n                    'commandValue': 'title'\n                    ...\n                }\n            */\n\n            // 创建droplist\n            var tpl = '<span style=\"font-size:{#title};\">{#title}</span>';\n            menu.dropList = new E.DropList(editor, menu, {\n                data: data,\n                tpl: tpl,\n                selectorForELemCommand: 'font[size]' // 为了执行 editor.commandForElem 而传入的elem查询方式\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[size]');\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // head 菜单\n    _e(function (E, $) {\n        E.createMenu(function (check) {\n            var menuId = 'head';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.head,\n                commandName: 'formatBlock'\n            });\n\n            // 初始化数据\n            var data = {\n                '<h1>': '标题1',\n                '<h2>': '标题2',\n                '<h3>': '标题3',\n                '<h4>': '标题4',\n                '<h5>': '标题5'\n            };\n            /*\n                data 需要的结构\n                {\n                    'commandValue': 'title'\n                    ...\n                }\n            */\n\n            var isOrderedList;\n            function beforeEvent(e) {\n                if (editor.queryCommandState('InsertOrderedList')) {\n                    isOrderedList = true;\n\n                    // 先取消有序列表\n                    editor.command(e, 'InsertOrderedList');\n                } else {\n                    isOrderedList = false;\n                }\n            }\n\n            function afterEvent(e) {\n                if (isOrderedList) {\n                    // 再设置有序列表\n                    editor.command(e, 'InsertOrderedList');\n                }\n            }\n\n            // 创建droplist\n            var tpl = '{#commandValue}{#title}';\n            menu.dropList = new E.DropList(editor, menu, {\n                data: data,\n                tpl: tpl,\n                // 对 ol 直接设置 head，会出现每个 li 的 index 都变成 1 的问题，因此要先取消 ol，然后设置 head，最后再增加上 ol\n                beforeEvent: beforeEvent,\n                afterEvent: afterEvent\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'h1,h2,h3,h4,h5');\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // unorderlist 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'unorderlist';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.unorderlist,\n                commandName: 'InsertUnorderedList'\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // orderlist 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'orderlist';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.orderlist,\n                commandName: 'InsertOrderedList'\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // alignleft 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'alignleft';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.alignleft,\n                commandName: 'JustifyLeft'\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                    var cssText;\n                    if (elem && elem.style && elem.style.cssText != null) {\n                        cssText = elem.style.cssText;\n                        if (cssText && /text-align:\\s*left;/.test(cssText)) {\n                            return true;\n                        }\n                    }\n                    if ($(elem).attr('align') === 'left') {\n                        // ff 中，设置align-left之后，会是 <p align=\"left\">xxx</p>\n                        return true;\n                    }\n                    return false;\n                });\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // aligncenter 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'aligncenter';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.aligncenter,\n                commandName: 'JustifyCenter'\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                    var cssText;\n                    if (elem && elem.style && elem.style.cssText != null) {\n                        cssText = elem.style.cssText;\n                        if (cssText && /text-align:\\s*center;/.test(cssText)) {\n                            return true;\n                        }\n                    }\n                    if ($(elem).attr('align') === 'center') {\n                        // ff 中，设置align-center之后，会是 <p align=\"center\">xxx</p>\n                        return true;\n                    }\n                    return false;\n                });\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // alignright 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'alignright';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.alignright,\n                commandName: 'JustifyRight'\n            });\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                    var cssText;\n                    if (elem && elem.style && elem.style.cssText != null) {\n                        cssText = elem.style.cssText;\n                        if (cssText && /text-align:\\s*right;/.test(cssText)) {\n                            return true;\n                        }\n                    }\n                    if ($(elem).attr('align') === 'right') {\n                        // ff 中，设置align-right之后，会是 <p align=\"right\">xxx</p>\n                        return true;\n                    }\n                    return false;\n                });\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // link 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'link';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.link\n            });\n\n            // 创建 dropPanel\n            var $content = $('<div></div>');\n            var $div1 = $('<div style=\"margin:20px 10px;\" class=\"clearfix\"></div>');\n            var $div2 = $div1.clone();\n            var $div3 = $div1.clone().css('margin', '0 10px');\n            var $textInput = $('<input type=\"text\" class=\"block\" placeholder=\"' + lang.text + '\"/>');\n            var $urlInput = $('<input type=\"text\" class=\"block\" placeholder=\"' + lang.link + '\"/>');\n            var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n            $div1.append($textInput);\n            $div2.append($urlInput);\n            $div3.append($btnSubmit).append($btnCancel);\n            $content.append($div1).append($div2).append($div3);\n\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 300\n            });\n\n            // 定义click事件\n            menu.clickEvent = function (e) {\n                var menu = this;\n                var dropPanel = menu.dropPanel;\n\n                // -------------隐藏----------------\n                if (dropPanel.isShowing) {\n                    dropPanel.hide();\n                    return;\n                }\n\n                // -------------显示----------------\n\n                // 重置 input\n                $textInput.val('');\n                $urlInput.val('http://');\n\n                // 获取url\n                var url = '';\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'a');\n                if (rangeElem) {\n                    url = rangeElem.href || '';\n                }\n\n                // 获取 text\n                var text = '';\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 选区不是空\n                    text = editor.getRangeText() || '';\n                } else if (rangeElem) {\n                    // 如果选区空，并且在 a 标签之内\n                    text = rangeElem.textContent || rangeElem.innerHTML;\n                }\n\n                // 设置 url 和 text\n                url && $urlInput.val(url);\n                text && $textInput.val(text);\n\n                // 如果有选区内容，textinput 不能修改\n                if (!isRangeEmpty) {\n                    $textInput.attr('disabled', true);\n                } else {\n                    $textInput.removeAttr('disabled');\n                }\n\n                // 显示（要设置好了所有input的值和属性之后再显示）\n                dropPanel.show();\n            };\n\n            // 定义 update selected 事件\n            menu.updateSelectedEvent = function () {\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'a');\n                if (rangeElem) {\n                    return true;\n                }\n                return false;\n            };\n\n            // 『取消』 按钮\n            $btnCancel.click(function (e) {\n                e.preventDefault();\n                menu.dropPanel.hide();\n            });\n\n            // 『确定』按钮\n            $btnSubmit.click(function (e) {\n                e.preventDefault();\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'a');\n                var isRangeEmpty = editor.isRangeEmpty();\n\n                var $linkElem, linkHtml;\n                var commandFn, callback;\n                var $txt = editor.txt.$txt;\n                var $oldLinks, $newLinks;\n                var uniqId = 'link' + E.random();\n\n                // 获取数据\n                var url = $.trim($urlInput.val());\n                var text = $.trim($textInput.val());\n\n                if (!url) {\n                    menu.dropPanel.focusFirstInput();\n                    return;\n                }\n                if (!text) {\n                    text = url;\n                }\n\n                if (!isRangeEmpty) {\n                    // 选中区域有内容，则执行默认命令\n\n                    // 获取目前 txt 内所有链接，并为当前链接做一个标记\n                    $oldLinks = $txt.find('a');\n                    $oldLinks.attr(uniqId, '1');\n\n                    // 执行命令 \n                    editor.command(e, 'createLink', url);\n\n                    // 去的没有标记的链接，即刚刚插入的链接\n                    $newLinks = $txt.find('a').not('[' + uniqId + ']');\n                    $newLinks.attr('target', '_blank'); // 增加 _blank\n\n                    // 去掉之前做的标记\n                    $oldLinks.removeAttr(uniqId);\n                } else if (targetElem) {\n                    // 无选中区域，在 a 标签之内，修改该 a 标签的内容和链接\n                    $linkElem = $(targetElem);\n                    commandFn = function commandFn() {\n                        $linkElem.attr('href', url);\n                        $linkElem.text(text);\n                    };\n                    callback = function callback() {\n                        var editor = this;\n                        editor.restoreSelectionByElem(targetElem);\n                    };\n                    // 执行命令\n                    editor.customCommand(e, commandFn, callback);\n                } else {\n                    // 无选中区域，不在 a 标签之内，插入新的链接\n\n                    linkHtml = '<a href=\"' + url + '\" target=\"_blank\">' + text + '</a>';\n                    if (E.userAgent.indexOf('Firefox') > 0) {\n                        linkHtml += '<span>&nbsp;</span>';\n                    }\n                    editor.command(e, 'insertHtml', linkHtml);\n                }\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // unlink 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'unlink';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.unlink,\n                commandName: 'unLink'\n            });\n\n            // click 事件\n            menu.clickEvent = function (e) {\n                var isRangeEmpty = editor.isRangeEmpty();\n                if (!isRangeEmpty) {\n                    // 有选中区域，或者IE8，执行默认命令\n                    editor.command(e, 'unLink');\n                    return;\n                }\n\n                // 无选中区域...\n\n                var rangeElem = editor.getRangeElem();\n                var aElem = editor.getSelfOrParentByName(rangeElem, 'a');\n                if (!aElem) {\n                    // 不在 a 之内，返回\n                    e.preventDefault();\n                    return;\n                }\n\n                // 在 a 之内\n                var $a = $(aElem);\n                var $span = $('<span>' + $a.text() + '</span>');\n                function commandFn() {\n                    $a.after($span).remove();\n                }\n                function callback() {\n                    editor.restoreSelectionByElem($span.get(0));\n                }\n                editor.customCommand(e, commandFn, callback);\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // table 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'table';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.table\n            });\n\n            // dropPanel 内容\n            var $content = $('<div style=\"font-size: 14px; color: #666; text-align:right;\"></div>');\n            var $table = $('<table class=\"choose-table\" style=\"margin-bottom:10px;margin-top:5px;\">');\n            var $row = $('<span>0</span>');\n            var $rowspan = $('<span> 行 </span>');\n            var $col = $('<span>0</span>');\n            var $colspan = $('<span> 列</span>');\n            var $tr;\n            var i, j;\n\n            // 创建一个n行n列的表格\n            for (i = 0; i < 15; i++) {\n                $tr = $('<tr index=\"' + (i + 1) + '\">');\n                for (j = 0; j < 20; j++) {\n                    $tr.append($('<td index=\"' + (j + 1) + '\">'));\n                }\n                $table.append($tr);\n            }\n            $content.append($table);\n            $content.append($row).append($rowspan).append($col).append($colspan);\n\n            // 定义table事件\n            $table.on('mouseenter', 'td', function (e) {\n                var $currentTd = $(e.currentTarget);\n                var currentTdIndex = $currentTd.attr('index');\n                var $currentTr = $currentTd.parent();\n                var currentTrIndex = $currentTr.attr('index');\n\n                // 显示\n                $row.text(currentTrIndex);\n                $col.text(currentTdIndex);\n\n                // 遍历设置背景颜色\n                $table.find('tr').each(function () {\n                    var $tr = $(this);\n                    var trIndex = $tr.attr('index');\n                    if (parseInt(trIndex, 10) <= parseInt(currentTrIndex, 10)) {\n                        // 该行需要可能需要设置背景色\n                        $tr.find('td').each(function () {\n                            var $td = $(this);\n                            var tdIndex = $td.attr('index');\n                            if (parseInt(tdIndex, 10) <= parseInt(currentTdIndex, 10)) {\n                                // 需要设置背景色\n                                $td.addClass('active');\n                            } else {\n                                // 需要移除背景色\n                                $td.removeClass('active');\n                            }\n                        });\n                    } else {\n                        // 改行不需要设置背景色\n                        $tr.find('td').removeClass('active');\n                    }\n                });\n            }).on('mouseleave', function (e) {\n                // mouseleave 删除背景色\n                $table.find('td').removeClass('active');\n\n                $row.text(0);\n                $col.text(0);\n            });\n\n            // 插入表格\n            $table.on('click', 'td', function (e) {\n                var $currentTd = $(e.currentTarget);\n                var currentTdIndex = $currentTd.attr('index');\n                var $currentTr = $currentTd.parent();\n                var currentTrIndex = $currentTr.attr('index');\n\n                var rownum = parseInt(currentTrIndex, 10);\n                var colnum = parseInt(currentTdIndex, 10);\n\n                // -------- 拼接tabel html --------\n\n                var i, j;\n                var tableHtml = '<table>';\n                for (i = 0; i < rownum; i++) {\n                    tableHtml += '<tr>';\n\n                    for (j = 0; j < colnum; j++) {\n                        tableHtml += '<td><span>&nbsp;</span></td>';\n                    }\n                    tableHtml += '</tr>';\n                }\n                tableHtml += '</table>';\n\n                // -------- 执行命令 --------\n                editor.command(e, 'insertHtml', tableHtml);\n            });\n\n            // 创建 panel\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 262\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // emotion 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'emotion';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var config = editor.config;\n            var lang = config.lang;\n            var configEmotions = config.emotions;\n            var emotionsShow = config.emotionsShow;\n\n            // 记录每一个表情图片的地址\n            editor.emotionUrls = [];\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.emotion\n            });\n\n            // 添加表情图片的函数\n            function insertEmotionImgs(data, $tabContent) {\n                // 添加表情图片\n                $.each(data, function (k, emotion) {\n                    var src = emotion.icon || emotion.url;\n                    var value = emotion.value || emotion.title;\n                    // 通过配置 editor.config.emotionsShow 的值来修改插入到编辑器的内容（图片/value）\n                    var commandValue = emotionsShow === 'icon' ? src : value;\n                    var $command = $('<a href=\"#\" commandValue=\"' + commandValue + '\"></a>');\n                    var $img = $('<img>');\n                    $img.attr('_src', src); // 先将 src 复制到 '_src' 属性，先不加载\n\n                    $command.append($img);\n                    $tabContent.append($command);\n\n                    // 记录下每一个表情图片的地址\n                    editor.emotionUrls.push(src);\n                });\n            }\n\n            // 拼接 dropPanel 内容\n            var $panelContent = $('<div class=\"panel-tab\"></div>');\n            var $tabContainer = $('<div class=\"tab-container\"></div>');\n            var $contentContainer = $('<div class=\"content-container emotion-content-container\"></div>');\n            $.each(configEmotions, function (k, emotion) {\n                var title = emotion.title;\n                var data = emotion.data;\n\n                E.log('正在处理 ' + title + ' 表情的数据...');\n\n                // 增加该组表情的tab和content\n                var $tab = $('<a href=\"#\">' + title + ' </a>');\n                $tabContainer.append($tab);\n                var $tabContent = $('<div class=\"content\"></div>');\n                $contentContainer.append($tabContent);\n\n                // tab 切换事件\n                $tab.click(function (e) {\n                    $tabContainer.children().removeClass('selected');\n                    $contentContainer.children().removeClass('selected');\n                    $tabContent.addClass('selected');\n                    $tab.addClass('selected');\n                    e.preventDefault();\n                });\n\n                // 处理data\n                if (typeof data === 'string') {\n                    // url 形式，需要通过ajax从该url获取数据\n                    E.log('将通过 ' + data + ' 地址ajax下载表情包');\n                    $.get(data, function (result) {\n                        result = $.parseJSON(result);\n                        E.log('下载完毕，得到 ' + result.length + ' 个表情');\n                        insertEmotionImgs(result, $tabContent);\n                    });\n                } else if (Object.prototype.toString.call(data).toLowerCase().indexOf('array') > 0) {\n                    // 数组，即 data 直接就是表情包数据\n                    insertEmotionImgs(data, $tabContent);\n                } else {\n                    // 其他情况，data格式不对\n                    E.error('data 数据格式错误，请修改为正确格式，参考文档：' + E.docsite);\n                    return;\n                }\n            });\n            $panelContent.append($tabContainer).append($contentContainer);\n\n            // 默认显示第一个tab\n            $tabContainer.children().first().addClass('selected');\n            $contentContainer.children().first().addClass('selected');\n\n            // 插入表情command事件\n            $contentContainer.on('click', 'a[commandValue]', function (e) {\n                var $a = $(e.currentTarget);\n                var commandValue = $a.attr('commandValue');\n                var img;\n\n                // commandValue 有可能是图片url，也有可能是表情的 value，需要区别对待\n\n                if (emotionsShow === 'icon') {\n                    // 插入图片\n                    editor.command(e, 'InsertImage', commandValue);\n                } else {\n                    // 插入value\n                    editor.command(e, 'insertHtml', '<span>' + commandValue + '</span>');\n                }\n\n                e.preventDefault();\n            });\n\n            // 添加panel\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $panelContent,\n                width: 350\n            });\n\n            // 定义click事件（异步加载表情图片）\n            menu.clickEvent = function (e) {\n                var menu = this;\n                var dropPanel = menu.dropPanel;\n\n                // -------------隐藏-------------\n                if (dropPanel.isShowing) {\n                    dropPanel.hide();\n                    return;\n                }\n\n                // -------------显示-------------\n                dropPanel.show();\n\n                // 异步加载图片\n                if (menu.imgLoaded) {\n                    return;\n                }\n                $contentContainer.find('img').each(function () {\n                    var $img = $(this);\n                    var _src = $img.attr('_src');\n                    $img.on('error', function () {\n                        E.error('加载不出表情图片 ' + _src);\n                    });\n                    $img.attr('src', _src);\n                    $img.removeAttr('_src');\n                });\n                menu.imgLoaded = true;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // img 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'img';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.img\n            });\n\n            // 创建 panel content\n            var $panelContent = $('<div class=\"panel-tab\"></div>');\n            var $tabContainer = $('<div class=\"tab-container\"></div>');\n            var $contentContainer = $('<div class=\"content-container\"></div>');\n            $panelContent.append($tabContainer).append($contentContainer);\n\n            // tab\n            var $uploadTab = $('<a href=\"#\">' + lang.uploadImg + '</a>');\n            var $linkTab = $('<a href=\"#\">' + lang.linkImg + '</a>');\n            $tabContainer.append($uploadTab).append($linkTab);\n\n            // 上传图片 content\n            var $uploadContent = $('<div class=\"content\"></div>');\n            $contentContainer.append($uploadContent);\n\n            // 网络图片 content\n            var $linkContent = $('<div class=\"content\"></div>');\n            $contentContainer.append($linkContent);\n            linkContentHandler(editor, menu, $linkContent);\n\n            // 添加panel\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $panelContent,\n                width: 400,\n                onRender: function onRender() {\n                    // 渲染后的回调事件，用于执行自定义上传的init\n                    // 因为渲染之后，上传面板的dom才会被渲染到页面，才能让第三方空间获取到\n                    var init = editor.config.customUploadInit;\n                    init && init.call(editor);\n                }\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n\n            // tab 切换事件\n            function tabToggle() {\n                $uploadTab.click(function (e) {\n                    $tabContainer.children().removeClass('selected');\n                    $contentContainer.children().removeClass('selected');\n                    $uploadContent.addClass('selected');\n                    $uploadTab.addClass('selected');\n                    e.preventDefault();\n                });\n                $linkTab.click(function (e) {\n                    $tabContainer.children().removeClass('selected');\n                    $contentContainer.children().removeClass('selected');\n                    $linkContent.addClass('selected');\n                    $linkTab.addClass('selected');\n                    e.preventDefault();\n\n                    // focus input\n                    if (E.placeholder) {\n                        $linkContent.find('input[type=text]').focus();\n                    }\n                });\n\n                // 默认情况\n                // $uploadTab.addClass('selected');\n                // $uploadContent.addClass('selected');\n                $uploadTab.click();\n            }\n\n            // 隐藏上传图片\n            function hideUploadImg() {\n                $tabContainer.remove();\n                $uploadContent.remove();\n                $linkContent.addClass('selected');\n            }\n\n            // 隐藏网络图片\n            function hideLinkImg() {\n                $tabContainer.remove();\n                $linkContent.remove();\n                $uploadContent.addClass('selected');\n            }\n\n            // 判断用户是否配置了上传图片\n            editor.ready(function () {\n                var editor = this;\n                var config = editor.config;\n                var uploadImgUrl = config.uploadImgUrl;\n                var customUpload = config.customUpload;\n                var linkImg = config.hideLinkImg;\n                var $uploadImgPanel;\n\n                if (uploadImgUrl || customUpload) {\n                    // 第一，暴露出 $uploadContent 以便用户自定义 ！！！重要\n                    editor.$uploadContent = $uploadContent;\n\n                    // 第二，绑定tab切换事件\n                    tabToggle();\n\n                    if (linkImg) {\n                        // 隐藏网络图片\n                        hideLinkImg();\n                    }\n                } else {\n                    // 未配置上传图片功能\n                    hideUploadImg();\n                }\n\n                // 点击 $uploadContent 立即隐藏 dropPanel\n                // 为了兼容IE8、9的上传，因为IE8、9使用 modal 上传\n                // 这里使用异步，为了不妨碍高级浏览器通过点击 $uploadContent 选择文件\n                function hidePanel() {\n                    menu.dropPanel.hide();\n                }\n                $uploadContent.click(function () {\n                    setTimeout(hidePanel);\n                });\n            });\n        });\n\n        // --------------- 处理网络图片content ---------------\n        function linkContentHandler(editor, menu, $linkContent) {\n            var lang = editor.config.lang;\n            var $urlContainer = $('<div style=\"margin:20px 10px 10px 10px;\"></div>');\n            var $urlInput = $('<input type=\"text\" class=\"block\" placeholder=\"http://\"/>');\n            $urlContainer.append($urlInput);\n            var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n            $linkContent.append($urlContainer).append($btnSubmit).append($btnCancel);\n\n            // 取消\n            $btnCancel.click(function (e) {\n                e.preventDefault();\n                menu.dropPanel.hide();\n            });\n\n            // callback \n            function callback() {\n                $urlInput.val('');\n            }\n\n            // 确定\n            $btnSubmit.click(function (e) {\n                e.preventDefault();\n                var url = $.trim($urlInput.val());\n                if (!url) {\n                    // 无内容\n                    $urlInput.focus();\n                    return;\n                }\n\n                var imgHtml = '<img style=\"max-width:100%;\" src=\"' + url + '\"/>';\n                editor.command(e, 'insertHtml', imgHtml, callback);\n            });\n        }\n    });\n    // video 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'video';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n            var reg = /^<(iframe)|(embed)/i; // <iframe... 或者 <embed... 格式\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.video\n            });\n\n            // 创建 panel 内容\n            var $content = $('<div></div>');\n            var $linkInputContainer = $('<div style=\"margin:20px 10px;\"></div>');\n            var $linkInput = $('<input type=\"text\" class=\"block\" placeholder=\\'格式如：<iframe src=\"...\" frameborder=0 allowfullscreen></iframe>\\'/>');\n            $linkInputContainer.append($linkInput);\n            var $sizeContainer = $('<div style=\"margin:20px 10px;\"></div>');\n            var $widthInput = $('<input type=\"text\" value=\"640\" style=\"width:50px;text-align:center;\"/>');\n            var $heightInput = $('<input type=\"text\" value=\"498\" style=\"width:50px;text-align:center;\"/>');\n            $sizeContainer.append('<span> ' + lang.width + ' </span>').append($widthInput).append('<span> px &nbsp;&nbsp;&nbsp;</span>').append('<span> ' + lang.height + ' </span>').append($heightInput).append('<span> px </span>');\n            var $btnContainer = $('<div></div>');\n            var $howToCopy = $('<a href=\"http://www.kancloud.cn/wangfupeng/wangeditor2/134973\" target=\"_blank\" style=\"display:inline-block;margin-top:10px;margin-left:10px;color:#999;\">如何复制视频链接？</a>');\n            var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n            $btnContainer.append($howToCopy).append($btnSubmit).append($btnCancel);\n            $content.append($linkInputContainer).append($sizeContainer).append($btnContainer);\n\n            // 取消按钮\n            $btnCancel.click(function (e) {\n                e.preventDefault();\n                $linkInput.val('');\n                menu.dropPanel.hide();\n            });\n\n            // 确定按钮\n            $btnSubmit.click(function (e) {\n                e.preventDefault();\n                var link = $.trim($linkInput.val());\n                var $link;\n                var width = parseInt($widthInput.val());\n                var height = parseInt($heightInput.val());\n                var $div = $('<div>');\n                var html = '<p>{content}</p>';\n\n                // 验证数据\n                if (!link) {\n                    menu.dropPanel.focusFirstInput();\n                    return;\n                }\n\n                if (!reg.test(link)) {\n                    alert('视频链接格式错误！');\n                    menu.dropPanel.focusFirstInput();\n                    return;\n                }\n\n                if (isNaN(width) || isNaN(height)) {\n                    alert('宽度或高度不是数字！');\n                    return;\n                }\n\n                $link = $(link);\n\n                // 设置高度和宽度\n                $link.attr('width', width).attr('height', height);\n\n                // 拼接字符串\n                html = html.replace('{content}', $div.append($link).html());\n\n                // 执行命令\n                editor.command(e, 'insertHtml', html);\n                $linkInput.val('');\n            });\n\n            // 创建panel\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 400\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // location 菜单\n    _e(function (E, $) {\n\n        // 判断浏览器的 input 是否支持 keyup\n        var inputKeyup = function (input) {\n            return 'onkeyup' in input;\n        }(document.createElement('input'));\n\n        // 百度地图的key\n        E.baiduMapAk = 'TVhjYjq1ICT2qqL5LdS8mwas';\n\n        // 一个页面中，如果有多个编辑器，地图会出现问题。这个参数记录一下，如果超过 1 就提示\n        E.numberOfLocation = 0;\n\n        E.createMenu(function (check) {\n            var menuId = 'location';\n            if (!check(menuId)) {\n                return;\n            }\n\n            if (++E.numberOfLocation > 1) {\n                E.error('目前不支持在一个页面多个编辑器上同时使用地图，可通过自定义菜单配置去掉地图菜单');\n                return;\n            }\n\n            var editor = this;\n            var config = editor.config;\n            var lang = config.lang;\n            var ak = config.mapAk;\n\n            // 地图的变量存储到这个地方\n            editor.mapData = {};\n            var mapData = editor.mapData;\n\n            // ---------- 地图事件 ----------\n            mapData.markers = [];\n            mapData.mapContainerId = 'map' + E.random();\n\n            mapData.clearLocations = function () {\n                var map = mapData.map;\n                if (!map) {\n                    return;\n                }\n                map.clearOverlays();\n\n                //同时，清空marker数组\n                mapData.markers = [];\n            };\n\n            mapData.searchMap = function () {\n                var map = mapData.map;\n                if (!map) {\n                    return;\n                }\n\n                var BMap = window.BMap;\n                var cityName = $cityInput.val();\n                var locationName = $searchInput.val();\n                var myGeo, marker;\n\n                if (cityName !== '') {\n                    if (!locationName || locationName === '') {\n                        map.centerAndZoom(cityName, 11);\n                    }\n\n                    //地址解析\n                    if (locationName && locationName !== '') {\n                        myGeo = new BMap.Geocoder();\n                        // 将地址解析结果显示在地图上,并调整地图视野\n                        myGeo.getPoint(locationName, function (point) {\n                            if (point) {\n                                map.centerAndZoom(point, 13);\n                                marker = new BMap.Marker(point);\n                                map.addOverlay(marker);\n                                marker.enableDragging(); //允许拖拽\n                                mapData.markers.push(marker); //将marker加入到数组中\n                            } else {\n                                // alert('未找到');\n                                map.centerAndZoom(cityName, 11); //找不到则重新定位到城市\n                            }\n                        }, cityName);\n                    }\n                } // if(cityName !== '')\n            };\n\n            // load script 之后的 callback\n            var hasCallback = false;\n            window.baiduMapCallBack = function () {\n                // 避免重复加载\n                if (hasCallback) {\n                    return;\n                } else {\n                    hasCallback = true;\n                }\n\n                var BMap = window.BMap;\n                if (!mapData.map) {\n                    // 创建Map实例\n                    mapData.map = new BMap.Map(mapData.mapContainerId);\n                }\n                var map = mapData.map;\n\n                map.centerAndZoom(new BMap.Point(116.404, 39.915), 11); // 初始化地图,设置中心点坐标和地图级别\n                map.addControl(new BMap.MapTypeControl()); //添加地图类型控件\n                map.setCurrentCity(\"北京\"); // 设置地图显示的城市 此项是必须设置的\n                map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放\n\n                //根据IP定位\n                function locationFun(result) {\n                    var cityName = result.name;\n                    map.setCenter(cityName);\n\n                    // 设置城市名称\n                    $cityInput.val(cityName);\n                    if (E.placeholder) {\n                        $searchInput.focus();\n                    }\n                    var timeoutId, _searchFn;\n                    if (inputKeyup) {\n                        // 并绑定搜索事件 - input 支持 keyup\n                        _searchFn = function searchFn(e) {\n                            if (e.type === 'keyup' && e.keyCode === 13) {\n                                e.preventDefault();\n                            }\n                            if (timeoutId) {\n                                clearTimeout(timeoutId);\n                            }\n                            timeoutId = setTimeout(mapData.searchMap, 500);\n                        };\n                        $cityInput.on('keyup change paste', _searchFn);\n                        $searchInput.on('keyup change paste', _searchFn);\n                    } else {\n                        // 并绑定搜索事件 - input 不支持 keyup\n                        _searchFn = function searchFn() {\n                            if (!$content.is(':visible')) {\n                                // panel 不显示了，就不用再监控了\n                                clearTimeout(timeoutId);\n                                return;\n                            }\n\n                            var currentCity = '';\n                            var currentSearch = '';\n                            var city = $cityInput.val();\n                            var search = $searchInput.val();\n\n                            if (city !== currentCity || search !== currentSearch) {\n                                // 刚获取的数据和之前的数据不一致，执行查询\n                                mapData.searchMap();\n                                // 更新数据\n                                currentCity = city;\n                                currentSearch = search;\n                            }\n\n                            // 继续监控\n                            if (timeoutId) {\n                                clearTimeout(timeoutId);\n                            }\n                            timeoutId = setTimeout(_searchFn, 1000);\n                        };\n                        // 开始监控\n                        timeoutId = setTimeout(_searchFn, 1000);\n                    }\n                }\n                var myCity = new BMap.LocalCity();\n                myCity.get(locationFun);\n\n                //鼠标点击，创建位置\n                map.addEventListener(\"click\", function (e) {\n                    var marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat));\n                    map.addOverlay(marker);\n                    marker.enableDragging();\n                    mapData.markers.push(marker); //加入到数组中\n                }, false);\n            };\n\n            mapData.loadMapScript = function () {\n                var script = document.createElement(\"script\");\n                script.type = \"text/javascript\";\n                script.src = \"https://api.map.baidu.com/api?v=2.0&ak=\" + ak + \"&s=1&callback=baiduMapCallBack\"; // baiduMapCallBack是一个本地函数\n                try {\n                    // IE10- 报错\n                    document.body.appendChild(script);\n                } catch (ex) {\n                    E.error('加载地图过程中发生错误');\n                }\n            };\n\n            // 初始化地图\n            mapData.initMap = function () {\n                if (window.BMap) {\n                    // 不是第一次，直接处理地图即可\n                    window.baiduMapCallBack();\n                } else {\n                    // 第一次，先加载地图 script，再处理地图（script加载完自动执行处理）\n                    mapData.loadMapScript();\n                }\n            };\n\n            // ---------- 创建 menu 对象 ----------\n\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.location\n            });\n\n            editor.menus[menuId] = menu;\n\n            // ---------- 构建UI ----------\n\n            // panel content \n            var $content = $('<div></div>');\n\n            // 搜索框\n            var $inputContainer = $('<div style=\"margin:10px 0;\"></div>');\n            var $cityInput = $('<input type=\"text\"/>');\n            $cityInput.css({\n                width: '80px',\n                'text-align': 'center'\n            });\n            var $searchInput = $('<input type=\"text\"/>');\n            $searchInput.css({\n                width: '300px',\n                'margin-left': '10px'\n            }).attr('placeholder', lang.searchlocation);\n            var $clearBtn = $('<button class=\"right link\">' + lang.clearLocation + '</button>');\n            $inputContainer.append($clearBtn).append($cityInput).append($searchInput);\n            $content.append($inputContainer);\n\n            // 清除位置按钮\n            $clearBtn.click(function (e) {\n                $searchInput.val('');\n                $searchInput.focus();\n                mapData.clearLocations();\n                e.preventDefault();\n            });\n\n            // 地图\n            var $map = $('<div id=\"' + mapData.mapContainerId + '\"></div>');\n            $map.css({\n                height: '260px',\n                width: '100%',\n                position: 'relative',\n                'margin-top': '10px',\n                border: '1px solid #f1f1f1'\n            });\n            var $mapLoading = $('<span>' + lang.loading + '</span>');\n            $mapLoading.css({\n                position: 'absolute',\n                width: '100px',\n                'text-align': 'center',\n                top: '45%',\n                left: '50%',\n                'margin-left': '-50px'\n            });\n            $map.append($mapLoading);\n            $content.append($map);\n\n            // 按钮\n            var $btnContainer = $('<div style=\"margin:10px 0;\"></div>');\n            var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n            var $checkLabel = $('<label style=\"display:inline-block;margin-top:10px;color:#666;\"></label>');\n            var $check = $('<input type=\"checkbox\">');\n            $checkLabel.append($check).append('<span style=\"display:inline-block;margin-left:5px;\">  ' + lang.dynamicMap + '</span>');\n            $btnContainer.append($checkLabel).append($btnSubmit).append($btnCancel);\n            $content.append($btnContainer);\n\n            function callback() {\n                $searchInput.val('');\n            }\n\n            // 『取消』按钮事件\n            $btnCancel.click(function (e) {\n                e.preventDefault();\n                callback();\n                menu.dropPanel.hide();\n            });\n\n            // 『确定』按钮事件\n            $btnSubmit.click(function (e) {\n                e.preventDefault();\n                var map = mapData.map,\n                    isDynamic = $check.is(':checked'),\n                    markers = mapData.markers,\n                    center = map.getCenter(),\n                    centerLng = center.lng,\n                    centerLat = center.lat,\n                    zoom = map.getZoom(),\n                    size = map.getSize(),\n                    sizeWidth = size.width,\n                    sizeHeight = size.height,\n                    position,\n                    src,\n                    iframe;\n\n                if (isDynamic) {\n                    //动态地址\n                    src = 'http://ueditor.baidu.com/ueditor/dialogs/map/show.html#';\n                } else {\n                    //静态地址\n                    src = 'http://api.map.baidu.com/staticimage?';\n                }\n\n                //src参数\n                src = src + 'center=' + centerLng + ',' + centerLat + '&zoom=' + zoom + '&width=' + sizeWidth + '&height=' + sizeHeight;\n                if (markers.length > 0) {\n                    src = src + '&markers=';\n\n                    //添加所有的marker\n                    $.each(markers, function (key, value) {\n                        position = value.getPosition();\n                        if (key > 0) {\n                            src = src + '|';\n                        }\n                        src = src + position.lng + ',' + position.lat;\n                    });\n                }\n\n                if (isDynamic) {\n                    if (markers.length > 1) {\n                        alert(lang.langDynamicOneLocation);\n                        return;\n                    }\n\n                    src += '&markerStyles=l,A';\n\n                    //插入iframe\n                    iframe = '<iframe class=\"ueditor_baidumap\" src=\"{src}\" frameborder=\"0\" width=\"' + sizeWidth + '\" height=\"' + sizeHeight + '\"></iframe>';\n                    iframe = iframe.replace('{src}', src);\n                    editor.command(e, 'insertHtml', iframe, callback);\n                } else {\n                    //插入图片\n                    editor.command(e, 'insertHtml', '<img style=\"max-width:100%;\" src=\"' + src + '\"/>', callback);\n                }\n            });\n\n            // 根据 UI 创建菜单 panel\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 500\n            });\n\n            // ---------- 事件 ----------\n\n            // render 时执行事件\n            menu.onRender = function () {\n                if (ak === E.baiduMapAk) {\n                    E.warn('建议在配置中自定义百度地图的mapAk，否则可能影响地图功能，文档：' + E.docsite);\n                }\n            };\n\n            // click 事件\n            menu.clickEvent = function (e) {\n                var menu = this;\n                var dropPanel = menu.dropPanel;\n                var firstTime = false;\n\n                // -------------隐藏-------------\n                if (dropPanel.isShowing) {\n                    dropPanel.hide();\n                    return;\n                }\n\n                // -------------显示-------------\n                if (!mapData.map) {\n                    // 第一次，先加载地图\n                    firstTime = true;\n                }\n\n                dropPanel.show();\n                mapData.initMap();\n\n                if (!firstTime) {\n                    $searchInput.focus();\n                }\n            };\n        });\n    });\n    // insertcode 菜单\n    _e(function (E, $) {\n\n        // 加载 highlightjs 代码\n        function loadHljs() {\n            if (E.userAgent.indexOf('MSIE 8') > 0) {\n                // 不支持 IE8\n                return;\n            }\n            if (window.hljs) {\n                // 不要重复加载\n                return;\n            }\n            var script = document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.src = \"//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js\";\n            document.body.appendChild(script);\n        }\n\n        E.createMenu(function (check) {\n            var menuId = 'insertcode';\n            if (!check(menuId)) {\n                return;\n            }\n\n            // 加载 highlightjs 代码\n            setTimeout(loadHljs, 0);\n\n            var editor = this;\n            var config = editor.config;\n            var lang = config.lang;\n            var $txt = editor.txt.$txt;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.insertcode\n            });\n\n            // click 事件\n            menu.clickEvent = function (e) {\n                var menu = this;\n                var dropPanel = menu.dropPanel;\n\n                // 隐藏\n                if (dropPanel.isShowing) {\n                    dropPanel.hide();\n                    return;\n                }\n\n                // 显示\n                $textarea.val('');\n                dropPanel.show();\n\n                // highlightjs 语言列表\n                var hljs = window.hljs;\n                if (hljs && hljs.listLanguages) {\n                    if ($langSelect.children().length !== 0) {\n                        return;\n                    }\n                    $langSelect.css({\n                        'margin-top': '9px',\n                        'margin-left': '5px'\n                    });\n                    $.each(hljs.listLanguages(), function (key, lang) {\n                        if (lang === 'xml') {\n                            lang = 'html';\n                        }\n                        if (lang === config.codeDefaultLang) {\n                            $langSelect.append('<option value=\"' + lang + '\" selected=\"selected\">' + lang + '</option>');\n                        } else {\n                            $langSelect.append('<option value=\"' + lang + '\">' + lang + '</option>');\n                        }\n                    });\n                } else {\n                    $langSelect.hide();\n                }\n            };\n\n            // 选中状态下的 click 事件\n            menu.clickEventSelected = function (e) {\n                var menu = this;\n                var dropPanel = menu.dropPanel;\n\n                // 隐藏\n                if (dropPanel.isShowing) {\n                    dropPanel.hide();\n                    return;\n                }\n\n                // 显示\n                dropPanel.show();\n\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n                var $targetElem;\n                var className;\n                if (targetElem) {\n                    // 确定找到 pre 之后，再找 code\n                    targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n                }\n                if (!targetElem) {\n                    return;\n                }\n                $targetElem = $(targetElem);\n\n                // 赋值内容\n                $textarea.val($targetElem.text());\n                if ($langSelect) {\n                    // 赋值语言\n                    className = $targetElem.attr('class');\n                    if (className) {\n                        $langSelect.val(className.split(' ')[0]);\n                    }\n                }\n            };\n\n            // 定义更新选中状态的事件\n            menu.updateSelectedEvent = function () {\n                var self = this; //菜单对象\n                var editor = self.editor;\n                var rangeElem;\n\n                rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n\n                if (rangeElem) {\n                    return true;\n                }\n\n                return false;\n            };\n\n            // 创建 panel\n            var $content = $('<div></div>');\n            var $textarea = $('<textarea></textarea>');\n            var $langSelect = $('<select></select>');\n            contentHandle($content);\n            menu.dropPanel = new E.DropPanel(editor, menu, {\n                $content: $content,\n                width: 500\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n\n            // ------ 增加 content 内容 ------\n            function contentHandle($content) {\n                // textarea 区域\n                var $textareaContainer = $('<div></div>');\n                $textareaContainer.css({\n                    margin: '15px 5px 5px 5px',\n                    height: '160px',\n                    'text-align': 'center'\n                });\n                $textarea.css({\n                    width: '100%',\n                    height: '100%',\n                    padding: '10px'\n                });\n                $textarea.on('keydown', function (e) {\n                    // 取消 tab 键默认行为\n                    if (e.keyCode === 9) {\n                        e.preventDefault();\n                    }\n                });\n                $textareaContainer.append($textarea);\n                $content.append($textareaContainer);\n\n                // 按钮区域\n                var $btnContainer = $('<div></div>');\n                var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n                var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n                $btnContainer.append($btnSubmit).append($btnCancel).append($langSelect);\n                $content.append($btnContainer);\n\n                // 取消按钮\n                $btnCancel.click(function (e) {\n                    e.preventDefault();\n                    menu.dropPanel.hide();\n                });\n\n                // 确定按钮\n                var codeTpl = '<pre style=\"max-width:100%;overflow-x:auto;\"><code{#langClass}>{#content}</code></pre>';\n                $btnSubmit.click(function (e) {\n                    e.preventDefault();\n                    var val = $textarea.val();\n                    if (!val) {\n                        // 无内容\n                        $textarea.focus();\n                        return;\n                    }\n\n                    var rangeElem = editor.getRangeElem();\n                    if ($.trim($(rangeElem).text()) && codeTpl.indexOf('<p><br></p>') !== 0) {\n                        codeTpl = '<p><br></p>' + codeTpl;\n                    }\n\n                    var lang = $langSelect ? $langSelect.val() : ''; // 获取高亮语言\n                    var langClass = '';\n                    var doHightlight = function doHightlight() {\n                        $txt.find('pre code').each(function (i, block) {\n                            var $block = $(block);\n                            if ($block.attr('codemark')) {\n                                // 有 codemark 标记的代码块，就不再重新格式化了\n                                return;\n                            } else if (window.hljs) {\n                                // 新代码块，格式化之后，立即标记 codemark\n                                window.hljs.highlightBlock(block);\n                                $block.attr('codemark', '1');\n                            }\n                        });\n                    };\n\n                    // 语言高亮样式\n                    if (lang) {\n                        langClass = ' class=\"' + lang + ' hljs\"';\n                    }\n\n                    // 替换标签\n                    val = val.replace(/&/gm, '&amp;').replace(/</gm, '&lt;').replace(/>/gm, '&gt;');\n\n                    // ---- menu 未选中状态 ----\n                    if (!menu.selected) {\n                        // 拼接html\n                        var html = codeTpl.replace('{#langClass}', langClass).replace('{#content}', val);\n                        editor.command(e, 'insertHtml', html, doHightlight);\n                        return;\n                    }\n\n                    // ---- menu 选中状态 ----\n                    var targetElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n                    var $targetElem;\n                    if (targetElem) {\n                        // 确定找到 pre 之后，再找 code\n                        targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n                    }\n                    if (!targetElem) {\n                        return;\n                    }\n                    $targetElem = $(targetElem);\n\n                    function commandFn() {\n                        var className;\n                        if (lang) {\n                            className = $targetElem.attr('class');\n                            if (className !== lang + ' hljs') {\n                                $targetElem.attr('class', lang + ' hljs');\n                            }\n                        }\n                        $targetElem.html(val);\n                    }\n                    function callback() {\n                        editor.restoreSelectionByElem(targetElem);\n                        doHightlight();\n                    }\n                    editor.customCommand(e, commandFn, callback);\n                });\n            }\n\n            // ------ enter 时，不另起标签，只换行 ------\n            $txt.on('keydown', function (e) {\n                if (e.keyCode !== 13) {\n                    return;\n                }\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n                if (!targetElem) {\n                    return;\n                }\n\n                editor.command(e, 'insertHtml', '\\n');\n            });\n\n            // ------ 点击时，禁用其他标签 ------\n            function updateMenu() {\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n                if (targetElem) {\n                    // 在 code 之内，禁用其他菜单\n                    editor.disableMenusExcept('insertcode');\n                } else {\n                    // 不是在 code 之内，启用其他菜单\n                    editor.enableMenusExcept('insertcode');\n                }\n            }\n            $txt.on('keydown click', function (e) {\n                // 此处必须使用 setTimeout 异步处理，否则不对\n                setTimeout(updateMenu);\n            });\n        });\n    });\n    // undo 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'undo';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.undo\n            });\n\n            // click 事件\n            menu.clickEvent = function (e) {\n                editor.undo();\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n\n            // ------------ 初始化时、enter 时、打字中断时，做记录 ------------\n            // ------------ ctrl + z 是调用记录撤销，而不是使用浏览器默认的撤销 ------------\n            editor.ready(function () {\n                var editor = this;\n                var $txt = editor.txt.$txt;\n                var timeoutId;\n\n                // 执行undo记录\n                function undo() {\n                    editor.undoRecord();\n                }\n\n                $txt.on('keydown', function (e) {\n                    var keyCode = e.keyCode;\n\n                    // 撤销 ctrl + z\n                    if (e.ctrlKey && keyCode === 90) {\n                        editor.undo();\n                        return;\n                    }\n\n                    if (keyCode === 13) {\n                        // enter 做记录\n                        undo();\n                    } else {\n                        // keyup 之后 1s 之内不操作，则做一次记录\n                        if (timeoutId) {\n                            clearTimeout(timeoutId);\n                        }\n                        timeoutId = setTimeout(undo, 1000);\n                    }\n                });\n\n                // 初始化做记录\n                editor.undoRecord();\n            });\n        });\n    });\n    // redo 菜单\n    _e(function (E, $) {\n\n        E.createMenu(function (check) {\n            var menuId = 'redo';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var lang = editor.config.lang;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.redo\n            });\n\n            // click 事件\n            menu.clickEvent = function (e) {\n                editor.redo();\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // 全屏 菜单\n    _e(function (E, $) {\n\n        // 记录全屏时的scrollTop\n        var scrollTopWhenFullScreen;\n\n        E.createMenu(function (check) {\n            var menuId = 'fullscreen';\n            if (!check(menuId)) {\n                return;\n            }\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            var config = editor.config;\n            var zIndexConfig = config.zindex || 10000;\n            var lang = config.lang;\n\n            var isSelected = false;\n            var zIndex;\n\n            var maxHeight;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor,\n                id: menuId,\n                title: lang.fullscreen\n            });\n\n            // 定义click事件\n            menu.clickEvent = function (e) {\n                // 增加样式\n                var $editorContainer = editor.$editorContainer;\n                $editorContainer.addClass('wangEditor-fullscreen');\n\n                // （先保存当前的）再设置z-index\n                zIndex = $editorContainer.css('z-index');\n                $editorContainer.css('z-index', zIndexConfig);\n\n                var $wrapper;\n                var txtHeight = $txt.height();\n                var txtOuterHeight = $txt.outerHeight();\n\n                if (editor.useMaxHeight) {\n                    // 记录 max-height，并暂时去掉maxheight\n                    maxHeight = $txt.css('max-height');\n                    $txt.css('max-height', 'none');\n\n                    // 如果使用了maxHeight， 将$txt从它的父元素中移出来\n                    $wrapper = $txt.parent();\n                    $wrapper.after($txt);\n                    $wrapper.remove();\n                    $txt.css('overflow-y', 'auto');\n                }\n\n                // 设置高度到全屏\n                var menuContainer = editor.menuContainer;\n                $txt.height(E.$window.height() - menuContainer.height() - (txtOuterHeight - txtHeight) // 去掉内边距和外边距\n                );\n\n                // 取消menuContainer的内联样式（menu吸顶时，会为 menuContainer 设置一些内联样式）\n                editor.menuContainer.$menuContainer.attr('style', '');\n\n                // 保存状态\n                isSelected = true;\n\n                // 记录编辑器是否全屏\n                editor.isFullScreen = true;\n\n                // 记录设置全屏时的高度\n                scrollTopWhenFullScreen = E.$window.scrollTop();\n            };\n\n            // 定义选中状态的 click 事件\n            menu.clickEventSelected = function (e) {\n                // 取消样式\n                var $editorContainer = editor.$editorContainer;\n                $editorContainer.removeClass('wangEditor-fullscreen');\n                $editorContainer.css('z-index', zIndex);\n\n                // 还原height\n                if (editor.useMaxHeight) {\n                    $txt.css('max-height', maxHeight);\n                } else {\n                    // editor.valueContainerHeight 在 editor.txt.initHeight() 中事先保存了\n                    editor.$valueContainer.css('height', editor.valueContainerHeight);\n                }\n\n                // 重新计算高度\n                editor.txt.initHeight();\n\n                // 保存状态\n                isSelected = false;\n\n                // 记录编辑器是否全屏\n                editor.isFullScreen = false;\n\n                // 还原scrollTop\n                if (scrollTopWhenFullScreen != null) {\n                    E.$window.scrollTop(scrollTopWhenFullScreen);\n                }\n            };\n\n            // 定义选中事件\n            menu.updateSelectedEvent = function (e) {\n                return isSelected;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // 渲染menus\n    _e(function (E, $) {\n\n        E.fn.renderMenus = function () {\n\n            var editor = this;\n            var menus = editor.menus;\n            var menuIds = editor.config.menus;\n            var menuContainer = editor.menuContainer;\n\n            var menu;\n            var groupIdx = 0;\n            $.each(menuIds, function (k, v) {\n                if (v === '|') {\n                    groupIdx++;\n                    return;\n                }\n\n                menu = menus[v];\n                if (menu) {\n                    menu.render(groupIdx);\n                }\n            });\n        };\n    });\n    // 渲染menus\n    _e(function (E, $) {\n\n        E.fn.renderMenuContainer = function () {\n\n            var editor = this;\n            var menuContainer = editor.menuContainer;\n            var $editorContainer = editor.$editorContainer;\n\n            menuContainer.render();\n        };\n    });\n    // 渲染 txt\n    _e(function (E, $) {\n\n        E.fn.renderTxt = function () {\n\n            var editor = this;\n            var txt = editor.txt;\n\n            txt.render();\n\n            // ready 时候，计算txt的高度\n            editor.ready(function () {\n                txt.initHeight();\n            });\n        };\n    });\n    // 渲染 container\n    _e(function (E, $) {\n\n        E.fn.renderEditorContainer = function () {\n\n            var editor = this;\n            var $valueContainer = editor.$valueContainer;\n            var $editorContainer = editor.$editorContainer;\n            var $txt = editor.txt.$txt;\n            var $prev, $parent;\n\n            // 将编辑器渲染到页面中\n            if ($valueContainer === $txt) {\n                $prev = editor.$prev;\n                $parent = editor.$parent;\n\n                if ($prev && $prev.length) {\n                    // 有前置节点，就插入到前置节点的后面\n                    $prev.after($editorContainer);\n                } else {\n                    // 没有前置节点，就直接插入到父元素\n                    $parent.prepend($editorContainer);\n                }\n            } else {\n                $valueContainer.after($editorContainer);\n                $valueContainer.hide();\n            }\n\n            // 设置宽度（这样设置宽度有问题）\n            // $editorContainer.css('width', $valueContainer.css('width'));\n        };\n    });\n    // 菜单事件\n    _e(function (E, $) {\n\n        // 绑定每个菜单的click事件\n        E.fn.eventMenus = function () {\n\n            var menus = this.menus;\n\n            // 绑定菜单的点击事件\n            $.each(menus, function (k, v) {\n                v.bindEvent();\n            });\n        };\n    });\n    // 菜单container事件\n    _e(function (E, $) {\n\n        E.fn.eventMenuContainer = function () {};\n    });\n    // 编辑区域事件\n    _e(function (E, $) {\n\n        E.fn.eventTxt = function () {\n\n            var txt = this.txt;\n\n            // txt内容变化时，保存选区\n            txt.saveSelectionEvent();\n\n            // txt内容变化时，随时更新 value\n            txt.updateValueEvent();\n\n            // txt内容变化时，随时更新 menu style\n            txt.updateMenuStyleEvent();\n\n            // // 鼠标hover时，显示 p head 高度（暂时关闭这个功能）\n            // if (!/ie/i.test(E.userAgent)) {\n            //     // 暂时不支持IE\n            //     txt.showHeightOnHover();\n            // }\n        };\n    });\n    // 上传图片事件\n    _e(function (E, $) {\n\n        E.plugin(function () {\n            var editor = this;\n            var fns = editor.config.uploadImgFns; // editor.config.uploadImgFns = {} 在config文件中定义了\n\n            // -------- 定义load函数 --------\n            fns.onload || (fns.onload = function (resultText, xhr) {\n                E.log('上传结束，返回结果为 ' + resultText);\n\n                var editor = this;\n                var originalName = editor.uploadImgOriginalName || ''; // 上传图片时，已经将图片的名字存在 editor.uploadImgOriginalName\n                var img;\n                if (resultText.indexOf('error|') === 0) {\n                    // 提示错误\n                    E.warn('上传失败：' + resultText.split('|')[1]);\n                    alert(resultText.split('|')[1]);\n                } else {\n                    E.log('上传成功，即将插入编辑区域，结果为：' + resultText);\n\n                    // 将结果插入编辑器\n                    img = document.createElement('img');\n                    img.onload = function () {\n                        var html = '<img src=\"' + resultText + '\" alt=\"' + originalName + '\" style=\"max-width:100%;\"/>';\n                        editor.command(null, 'insertHtml', html);\n\n                        E.log('已插入图片，地址 ' + resultText);\n                        img = null;\n                    };\n                    img.onerror = function () {\n                        E.error('使用返回的结果获取图片，发生错误。请确认以下结果是否正确：' + resultText);\n                        img = null;\n                    };\n                    img.src = resultText;\n                }\n            });\n\n            // -------- 定义tiemout函数 --------\n            fns.ontimeout || (fns.ontimeout = function (xhr) {\n                E.error('上传图片超时');\n                alert('上传图片超时');\n            });\n\n            // -------- 定义error函数 --------\n            fns.onerror || (fns.onerror = function (xhr) {\n                E.error('上传上图片发生错误');\n                alert('上传上图片发生错误');\n            });\n        });\n    });\n    // xhr 上传图片\n    _e(function (E, $) {\n\n        if (!window.FileReader || !window.FormData) {\n            // 如果不支持html5的文档操作，直接返回\n            return;\n        }\n\n        E.plugin(function () {\n\n            var editor = this;\n            var config = editor.config;\n            var uploadImgUrl = config.uploadImgUrl;\n            var uploadTimeout = config.uploadTimeout;\n\n            // 获取配置中的上传事件\n            var uploadImgFns = config.uploadImgFns;\n            var onload = uploadImgFns.onload;\n            var ontimeout = uploadImgFns.ontimeout;\n            var onerror = uploadImgFns.onerror;\n\n            if (!uploadImgUrl) {\n                return;\n            }\n\n            // -------- 将以base64的图片url数据转换为Blob --------\n            function convertBase64UrlToBlob(urlData, filetype) {\n                //去掉url的头，并转换为byte\n                var bytes = window.atob(urlData.split(',')[1]);\n\n                //处理异常,将ascii码小于0的转换为大于0\n                var ab = new ArrayBuffer(bytes.length);\n                var ia = new Uint8Array(ab);\n                var i;\n                for (i = 0; i < bytes.length; i++) {\n                    ia[i] = bytes.charCodeAt(i);\n                }\n\n                return new Blob([ab], { type: filetype });\n            }\n\n            // -------- 插入图片的方法 --------\n            function insertImg(src, event) {\n                var img = document.createElement('img');\n                img.onload = function () {\n                    var html = '<img src=\"' + src + '\" style=\"max-width:100%;\"/>';\n                    editor.command(event, 'insertHtml', html);\n\n                    E.log('已插入图片，地址 ' + src);\n                    img = null;\n                };\n                img.onerror = function () {\n                    E.error('使用返回的结果获取图片，发生错误。请确认以下结果是否正确：' + src);\n                    img = null;\n                };\n                img.src = src;\n            }\n\n            // -------- onprogress 事件 --------\n            function updateProgress(e) {\n                if (e.lengthComputable) {\n                    var percentComplete = e.loaded / e.total;\n                    editor.showUploadProgress(percentComplete * 100);\n                }\n            }\n\n            // -------- xhr 上传图片 --------\n            editor.xhrUploadImg = function (opt) {\n                // opt 数据\n                var event = opt.event;\n                var fileName = opt.filename || '';\n                var base64 = opt.base64;\n                var fileType = opt.fileType || 'image/png'; // 无扩展名则默认使用 png\n                var name = opt.name || 'wangEditor_upload_file';\n                var loadfn = opt.loadfn || onload;\n                var errorfn = opt.errorfn || onerror;\n                var timeoutfn = opt.timeoutfn || ontimeout;\n\n                // 上传参数（如 token）\n                var params = editor.config.uploadParams || {};\n\n                // headers\n                var headers = editor.config.uploadHeaders || {};\n\n                // 获取文件扩展名\n                var fileExt = 'png'; // 默认为 png\n                if (fileName.indexOf('.') > 0) {\n                    // 原来的文件名有扩展名\n                    fileExt = fileName.slice(fileName.lastIndexOf('.') - fileName.length + 1);\n                } else if (fileType.indexOf('/') > 0 && fileType.split('/')[1]) {\n                    // 文件名没有扩展名，通过类型获取，如从 'image/png' 取 'png'\n                    fileExt = fileType.split('/')[1];\n                }\n\n                // ------------ begin 预览模拟上传 ------------\n                if (E.isOnWebsite) {\n                    E.log('预览模拟上传');\n                    insertImg(base64, event);\n                    return;\n                }\n                // ------------ end 预览模拟上传 ------------\n\n                // 变量声明\n                var xhr = new XMLHttpRequest();\n                var timeoutId;\n                var src;\n                var formData = new FormData();\n\n                // 超时处理\n                function timeoutCallback() {\n                    if (timeoutId) {\n                        clearTimeout(timeoutId);\n                    }\n                    if (xhr && xhr.abort) {\n                        xhr.abort();\n                    }\n\n                    // 超时了就阻止默认行为\n                    event.preventDefault();\n\n                    // 执行回调函数，提示什么内容，都应该在回调函数中定义\n                    timeoutfn && timeoutfn.call(editor, xhr);\n\n                    // 隐藏进度条\n                    editor.hideUploadProgress();\n                }\n\n                xhr.onload = function () {\n                    if (timeoutId) {\n                        clearTimeout(timeoutId);\n                    }\n\n                    // 记录文件名到 editor.uploadImgOriginalName ，插入图片时，可做 alt 属性用\n                    editor.uploadImgOriginalName = fileName;\n                    if (fileName.indexOf('.') > 0) {\n                        editor.uploadImgOriginalName = fileName.split('.')[0];\n                    }\n\n                    // 执行load函数，任何操作，都应该在load函数中定义\n                    loadfn && loadfn.call(editor, xhr.responseText, xhr);\n\n                    // 隐藏进度条\n                    editor.hideUploadProgress();\n                };\n                xhr.onerror = function () {\n                    if (timeoutId) {\n                        clearTimeout(timeoutId);\n                    }\n\n                    // 超时了就阻止默认行为\n                    event.preventDefault();\n\n                    // 执行error函数，错误提示，应该在error函数中定义\n                    errorfn && errorfn.call(editor, xhr);\n\n                    // 隐藏进度条\n                    editor.hideUploadProgress();\n                };\n                // xhr.onprogress = updateProgress;\n                xhr.upload.onprogress = updateProgress;\n\n                // 填充数据\n                formData.append(name, convertBase64UrlToBlob(base64, fileType), E.random() + '.' + fileExt);\n\n                // 添加参数\n                $.each(params, function (key, value) {\n                    formData.append(key, value);\n                });\n\n                // 开始上传\n                xhr.open('POST', uploadImgUrl, true);\n                // xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");  // 将参数解析成传统form的方式上传\n\n                // 修改自定义配置的headers\n                $.each(headers, function (key, value) {\n                    xhr.setRequestHeader(key, value);\n                });\n\n                // 跨域上传时，传cookie\n                xhr.withCredentials = editor.config.withCredentials || true;\n\n                // 发送数据\n                xhr.send(formData);\n                timeoutId = setTimeout(timeoutCallback, uploadTimeout);\n\n                E.log('开始上传...并开始超时计算');\n            };\n        });\n    });\n    // 进度条\n    _e(function (E, $) {\n\n        E.plugin(function () {\n\n            var editor = this;\n            var menuContainer = editor.menuContainer;\n            var menuHeight = menuContainer.height();\n            var $editorContainer = editor.$editorContainer;\n            var width = $editorContainer.width();\n            var $progress = $('<div class=\"wangEditor-upload-progress\"></div>');\n\n            // 渲染事件\n            var isRender = false;\n            function render() {\n                if (isRender) {\n                    return;\n                }\n                isRender = true;\n\n                $progress.css({\n                    top: menuHeight + 'px'\n                });\n                $editorContainer.append($progress);\n            }\n\n            // ------ 显示进度 ------\n            editor.showUploadProgress = function (progress) {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n\n                // 显示之前，先判断是否渲染\n                render();\n\n                $progress.show();\n                $progress.width(progress * width / 100);\n            };\n\n            // ------ 隐藏进度条 ------\n            var timeoutId;\n            function hideProgress() {\n                $progress.hide();\n                timeoutId = null;\n            }\n            editor.hideUploadProgress = function (time) {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n                time = time || 750;\n                timeoutId = setTimeout(hideProgress, time);\n            };\n        });\n    });\n    // upload img 插件\n    _e(function (E, $) {\n\n        E.plugin(function () {\n            var editor = this;\n            var config = editor.config;\n            var uploadImgUrl = config.uploadImgUrl;\n            var uploadTimeout = config.uploadTimeout;\n            var event;\n\n            if (!uploadImgUrl) {\n                return;\n            }\n\n            // 获取editor的上传dom\n            var $uploadContent = editor.$uploadContent;\n            if (!$uploadContent) {\n                return;\n            }\n\n            // 自定义UI，并添加到上传dom节点上\n            var $uploadIcon = $('<div class=\"upload-icon-container\"><i class=\"wangeditor-menu-img-upload\"></i></div>');\n            $uploadContent.append($uploadIcon);\n\n            // ---------- 构建上传对象 ----------\n            var upfile = new E.UploadFile({\n                editor: editor,\n                uploadUrl: uploadImgUrl,\n                timeout: uploadTimeout,\n                fileAccept: 'image/jpg,image/jpeg,image/png,image/gif,image/bmp' // 只允许选择图片 \n            });\n\n            // 选择本地文件，上传\n            $uploadIcon.click(function (e) {\n                event = e;\n                upfile.selectFiles();\n            });\n        });\n    });\n    // h5 方式上传图片\n    _e(function (E, $) {\n\n        if (!window.FileReader || !window.FormData) {\n            // 如果不支持html5的文档操作，直接返回\n            return;\n        }\n\n        // 构造函数\n        var UploadFile = function UploadFile(opt) {\n            this.editor = opt.editor;\n            this.uploadUrl = opt.uploadUrl;\n            this.timeout = opt.timeout;\n            this.fileAccept = opt.fileAccept;\n            this.multiple = true;\n        };\n\n        UploadFile.fn = UploadFile.prototype;\n\n        // clear\n        UploadFile.fn.clear = function () {\n            this.$input.val('');\n            E.log('input value 已清空');\n        };\n\n        // 渲染\n        UploadFile.fn.render = function () {\n            var self = this;\n            if (self._hasRender) {\n                // 不要重复渲染\n                return;\n            }\n\n            E.log('渲染dom');\n\n            var fileAccept = self.fileAccept;\n            var acceptTpl = fileAccept ? 'accept=\"' + fileAccept + '\"' : '';\n            var multiple = self.multiple;\n            var multipleTpl = multiple ? 'multiple=\"multiple\"' : '';\n            var $input = $('<input type=\"file\" ' + acceptTpl + ' ' + multipleTpl + '/>');\n            var $container = $('<div style=\"display:none;\"></div>');\n\n            $container.append($input);\n            E.$body.append($container);\n\n            // onchange 事件\n            $input.on('change', function (e) {\n                self.selected(e, $input.get(0));\n            });\n\n            // 记录对象数据\n            self.$input = $input;\n\n            // 记录\n            self._hasRender = true;\n        };\n\n        // 选择\n        UploadFile.fn.selectFiles = function () {\n            var self = this;\n\n            E.log('使用 html5 方式上传');\n\n            // 先渲染\n            self.render();\n\n            // 选择\n            E.log('选择文件');\n            self.$input.click();\n        };\n\n        // 选中文件之后\n        UploadFile.fn.selected = function (e, input) {\n            var self = this;\n            var files = input.files || [];\n            if (files.length === 0) {\n                return;\n            }\n\n            E.log('选中 ' + files.length + ' 个文件');\n\n            // 遍历选中的文件，预览、上传\n            $.each(files, function (key, value) {\n                self.upload(value);\n            });\n        };\n\n        // 上传单个文件\n        UploadFile.fn.upload = function (file) {\n            var self = this;\n            var editor = self.editor;\n            var filename = file.name || '';\n            var fileType = file.type || '';\n            var uploadImgFns = editor.config.uploadImgFns;\n            var uploadFileName = editor.config.uploadImgFileName || 'wangEditorH5File';\n            var onload = uploadImgFns.onload;\n            var ontimeout = uploadImgFns.ontimeout;\n            var onerror = uploadImgFns.onerror;\n            var reader = new FileReader();\n\n            if (!onload || !ontimeout || !onerror) {\n                E.error('请为编辑器配置上传图片的 onload ontimeout onerror 回调事件');\n                return;\n            }\n\n            E.log('开始执行 ' + filename + ' 文件的上传');\n\n            // 清空 input 数据\n            function clearInput() {\n                self.clear();\n            }\n\n            // onload事件\n            reader.onload = function (e) {\n                E.log('已读取' + filename + '文件');\n\n                var base64 = e.target.result || this.result;\n                editor.xhrUploadImg({\n                    event: e,\n                    filename: filename,\n                    base64: base64,\n                    fileType: fileType,\n                    name: uploadFileName,\n                    loadfn: function loadfn(resultText, xhr) {\n                        clearInput();\n                        // 执行配置中的方法\n                        var editor = this;\n                        onload.call(editor, resultText, xhr);\n                    },\n                    errorfn: function errorfn(xhr) {\n                        clearInput();\n                        if (E.isOnWebsite) {\n                            alert('wangEditor官网暂时没有服务端，因此报错。实际项目中不会发生');\n                        }\n                        // 执行配置中的方法\n                        var editor = this;\n                        onerror.call(editor, xhr);\n                    },\n                    timeoutfn: function timeoutfn(xhr) {\n                        clearInput();\n                        if (E.isOnWebsite) {\n                            alert('wangEditor官网暂时没有服务端，因此超时。实际项目中不会发生');\n                        }\n                        // 执行配置中的方法\n                        var editor = this;\n                        ontimeout(editor, xhr);\n                    }\n                });\n            };\n\n            // 开始取文件\n            reader.readAsDataURL(file);\n        };\n\n        // 暴露给 E\n        E.UploadFile = UploadFile;\n    });\n    // form方式上传图片\n    _e(function (E, $) {\n\n        if (window.FileReader && window.FormData) {\n            // 如果支持 html5 上传，则返回\n            return;\n        }\n\n        // 构造函数\n        var UploadFile = function UploadFile(opt) {\n            this.editor = opt.editor;\n            this.uploadUrl = opt.uploadUrl;\n            this.timeout = opt.timeout;\n            this.fileAccept = opt.fileAccept;\n            this.multiple = false;\n        };\n\n        UploadFile.fn = UploadFile.prototype;\n\n        // clear\n        UploadFile.fn.clear = function () {\n            this.$input.val('');\n            E.log('input value 已清空');\n        };\n\n        // 隐藏modal\n        UploadFile.fn.hideModal = function () {\n            this.modal.hide();\n        };\n\n        // 渲染\n        UploadFile.fn.render = function () {\n            var self = this;\n            var editor = self.editor;\n            var uploadFileName = editor.config.uploadImgFileName || 'wangEditorFormFile';\n            if (self._hasRender) {\n                // 不要重复渲染\n                return;\n            }\n\n            // 服务器端路径\n            var uploadUrl = self.uploadUrl;\n\n            E.log('渲染dom');\n\n            // 创建 form 和 iframe\n            var iframeId = 'iframe' + E.random();\n            var $iframe = $('<iframe name=\"' + iframeId + '\" id=\"' + iframeId + '\" frameborder=\"0\" width=\"0\" height=\"0\"></iframe>');\n            var multiple = self.multiple;\n            var multipleTpl = multiple ? 'multiple=\"multiple\"' : '';\n            var $p = $('<p>选择图片并上传</p>');\n            var $input = $('<input type=\"file\" ' + multipleTpl + ' name=\"' + uploadFileName + '\"/>');\n            var $btn = $('<input type=\"submit\" value=\"上传\"/>');\n            var $form = $('<form enctype=\"multipart/form-data\" method=\"post\" action=\"' + uploadUrl + '\" target=\"' + iframeId + '\"></form>');\n            var $container = $('<div style=\"margin:10px 20px;\"></div>');\n\n            $form.append($p).append($input).append($btn);\n\n            // 增加用户配置的参数，如 token\n            $.each(editor.config.uploadParams, function (key, value) {\n                $form.append($('<input type=\"hidden\" name=\"' + key + '\" value=\"' + value + '\"/>'));\n            });\n\n            $container.append($form);\n            $container.append($iframe);\n\n            self.$input = $input;\n            self.$iframe = $iframe;\n\n            // 生成 modal\n            var modal = new E.Modal(editor, undefined, {\n                $content: $container\n            });\n            self.modal = modal;\n\n            // 记录\n            self._hasRender = true;\n        };\n\n        // 绑定 iframe load 事件\n        UploadFile.fn.bindLoadEvent = function () {\n            var self = this;\n            if (self._hasBindLoad) {\n                // 不要重复绑定\n                return;\n            }\n\n            var editor = self.editor;\n            var $iframe = self.$iframe;\n            var iframe = $iframe.get(0);\n            var iframeWindow = iframe.contentWindow;\n            var onload = editor.config.uploadImgFns.onload;\n\n            // 定义load事件\n            function onloadFn() {\n                var resultText = $.trim(iframeWindow.document.body.innerHTML);\n                if (!resultText) {\n                    return;\n                }\n\n                // 获取文件名\n                var fileFullName = self.$input.val(); // 结果如 C:\\folder\\abc.png 格式\n                var fileOriginalName = fileFullName;\n                if (fileFullName.lastIndexOf('\\\\') >= 0) {\n                    // 获取 abc.png 格式\n                    fileOriginalName = fileFullName.slice(fileFullName.lastIndexOf('\\\\') + 1);\n                    if (fileOriginalName.indexOf('.') > 0) {\n                        // 获取 abc （即不带扩展名的文件名）\n                        fileOriginalName = fileOriginalName.split('.')[0];\n                    }\n                }\n\n                // 将文件名暂存到 editor.uploadImgOriginalName ，插入图片时，可作为 alt 属性来用\n                editor.uploadImgOriginalName = fileOriginalName;\n\n                // 执行load函数，插入图片的操作，应该在load函数中执行\n                onload.call(editor, resultText);\n\n                // 清空 input 数据\n                self.clear();\n\n                // 隐藏modal\n                self.hideModal();\n            }\n\n            // 绑定 load 事件\n            if (iframe.attachEvent) {\n                iframe.attachEvent('onload', onloadFn);\n            } else {\n                iframe.onload = onloadFn;\n            }\n\n            // 记录\n            self._hasBindLoad = true;\n        };\n\n        UploadFile.fn.show = function () {\n            var self = this;\n            var modal = self.modal;\n\n            function show() {\n                modal.show();\n                self.bindLoadEvent();\n            }\n            setTimeout(show);\n        };\n\n        // 选择\n        UploadFile.fn.selectFiles = function () {\n            var self = this;\n\n            E.log('使用 form 方式上传');\n\n            // 先渲染\n            self.render();\n\n            // 先清空\n            self.clear();\n\n            // 显示\n            self.show();\n        };\n\n        // 暴露给 E\n        E.UploadFile = UploadFile;\n    });\n    // upload img 插件 粘贴图片\n    _e(function (E, $) {\n\n        E.plugin(function () {\n            var editor = this;\n            var txt = editor.txt;\n            var $txt = txt.$txt;\n            var config = editor.config;\n            var uploadImgUrl = config.uploadImgUrl;\n            var uploadFileName = config.uploadImgFileName || 'wangEditorPasteFile';\n            var pasteEvent;\n            var $imgsBeforePaste;\n\n            // 未配置上传图片url，则忽略\n            if (!uploadImgUrl) {\n                return;\n            }\n\n            // -------- 非 chrome 下，通过查找粘贴的图片的方式上传 --------\n            function findPasteImgAndUpload() {\n                var reg = /^data:(image\\/\\w+);base64/;\n                var $imgs = $txt.find('img');\n\n                E.log('粘贴后，检查到编辑器有' + $imgs.length + '个图片。开始遍历图片，试图找到刚刚粘贴过来的图片');\n\n                $.each($imgs, function () {\n                    var img = this;\n                    var $img = $(img);\n                    var flag;\n                    var base64 = $img.attr('src');\n                    var type;\n\n                    // 判断当前图片是否是粘贴之前的\n                    $imgsBeforePaste.each(function () {\n                        if (img === this) {\n                            // 当前图片是粘贴之前的\n                            flag = true;\n                            return false;\n                        }\n                    });\n\n                    // 当前图片是粘贴之前的，则忽略\n                    if (flag) {\n                        return;\n                    }\n\n                    E.log('找到一个粘贴过来的图片');\n\n                    if (reg.test(base64)) {\n                        // 得到的粘贴的图片是 base64 格式，符合要求\n                        E.log('src 是 base64 格式，可以上传');\n                        type = base64.match(reg)[1];\n                        editor.xhrUploadImg({\n                            event: pasteEvent,\n                            base64: base64,\n                            fileType: type,\n                            name: uploadFileName\n                        });\n                    } else {\n                        E.log('src 为 ' + base64 + ' ，不是 base64 格式，暂时不支持上传');\n                    }\n\n                    // 最终移除原图片\n                    $img.remove();\n                });\n\n                E.log('遍历结束');\n            }\n\n            // 开始监控粘贴事件\n            $txt.on('paste', function (e) {\n                pasteEvent = e;\n                var data = pasteEvent.clipboardData || pasteEvent.originalEvent.clipboardData;\n                var text;\n                var items;\n\n                // -------- 试图获取剪切板中的文字，有文字的情况下，就不处理图片粘贴 --------\n                if (data == null) {\n                    text = window.clipboardData && window.clipboardData.getData('text');\n                } else {\n                    text = data.getData('text/plain') || data.getData('text/html');\n                }\n                if (text) {\n                    return;\n                }\n\n                items = data && data.items;\n                if (items) {\n                    // -------- chrome 可以用 data.items 取出图片 -----\n                    E.log('通过 data.items 得到了数据');\n\n                    $.each(items, function (key, value) {\n                        var fileType = value.type || '';\n                        if (fileType.indexOf('image') < 0) {\n                            // 不是图片\n                            return;\n                        }\n\n                        var file = value.getAsFile();\n                        var reader = new FileReader();\n\n                        E.log('得到一个粘贴图片');\n\n                        reader.onload = function (e) {\n                            E.log('读取到粘贴的图片');\n\n                            // 执行上传\n                            var base64 = e.target.result || this.result;\n                            editor.xhrUploadImg({\n                                event: pasteEvent,\n                                base64: base64,\n                                fileType: fileType,\n                                name: uploadFileName\n                            });\n                        };\n\n                        //读取粘贴的文件\n                        reader.readAsDataURL(file);\n                    });\n                } else {\n                    // -------- 非 chrome 不能用 data.items 取图片 -----\n\n                    E.log('未从 data.items 得到数据，使用检测粘贴图片的方式');\n\n                    // 获取\n                    $imgsBeforePaste = $txt.find('img');\n                    E.log('粘贴前，检查到编辑器有' + $imgsBeforePaste.length + '个图片');\n\n                    // 异步上传找到的图片\n                    setTimeout(findPasteImgAndUpload, 0);\n                }\n            });\n        });\n    });\n    // 拖拽上传图片 插件 \n    _e(function (E, $) {\n\n        E.plugin(function () {\n\n            var editor = this;\n            var txt = editor.txt;\n            var $txt = txt.$txt;\n            var config = editor.config;\n            var uploadImgUrl = config.uploadImgUrl;\n            var uploadFileName = config.uploadImgFileName || 'wangEditorDragFile';\n\n            // 未配置上传图片url，则忽略\n            if (!uploadImgUrl) {\n                return;\n            }\n\n            // 阻止浏览器默认行为\n            E.$document.on('dragleave drop dragenter dragover', function (e) {\n                e.preventDefault();\n            });\n\n            // 监控 $txt drop 事件\n            $txt.on('drop', function (dragEvent) {\n                dragEvent.preventDefault();\n\n                var originalEvent = dragEvent.originalEvent;\n                var files = originalEvent.dataTransfer && originalEvent.dataTransfer.files;\n\n                if (!files || !files.length) {\n                    return;\n                }\n\n                $.each(files, function (k, file) {\n                    var type = file.type;\n                    var name = file.name;\n\n                    if (type.indexOf('image/') < 0) {\n                        // 只接收图片\n                        return;\n                    }\n\n                    E.log('得到图片 ' + name);\n\n                    var reader = new FileReader();\n                    reader.onload = function (e) {\n                        E.log('读取到图片 ' + name);\n\n                        // 执行上传\n                        var base64 = e.target.result || this.result;\n                        editor.xhrUploadImg({\n                            event: dragEvent,\n                            base64: base64,\n                            fileType: type,\n                            name: uploadFileName\n                        });\n                    };\n\n                    //读取粘贴的文件\n                    reader.readAsDataURL(file);\n                });\n            });\n        });\n    });\n    // 编辑器区域 table toolbar\n    _e(function (E, $) {\n\n        E.plugin(function () {\n            var editor = this;\n            var txt = editor.txt;\n            var $txt = txt.$txt;\n            var html = '';\n            // 说明：设置了 max-height 之后，$txt.parent() 负责滚动处理\n            var $currentTxt = editor.useMaxHeight ? $txt.parent() : $txt;\n            var $currentTable;\n\n            // 用到的dom节点\n            var isRendered = false;\n            var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n            var $triangle = $('<div class=\"tip-triangle\"></div>');\n            var $delete = $('<a href=\"#\"><i class=\"wangeditor-menu-img-trash-o\"></i></a>');\n            var $zoomSmall = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-minus\"></i></a>');\n            var $zoomBig = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-plus\"></i></a>');\n\n            // 渲染到页面\n            function render() {\n                if (isRendered) {\n                    return;\n                }\n\n                // 绑定事件\n                bindEvent();\n\n                // 拼接 渲染到页面上\n                $toolbar.append($triangle).append($delete).append($zoomSmall).append($zoomBig);\n                editor.$editorContainer.append($toolbar);\n                isRendered = true;\n            }\n\n            // 绑定事件\n            function bindEvent() {\n                // 统一执行命令的方法\n                var commandFn;\n                function command(e, callback) {\n                    // 执行命令之前，先存储html内容\n                    html = $txt.html();\n                    // 监控内容变化\n                    var cb = function cb() {\n                        if (callback) {\n                            callback();\n                        }\n                        if (html !== $txt.html()) {\n                            $txt.change();\n                        }\n                    };\n                    // 执行命令\n                    if (commandFn) {\n                        editor.customCommand(e, commandFn, cb);\n                    }\n                }\n\n                // 删除\n                $delete.click(function (e) {\n                    commandFn = function commandFn() {\n                        $currentTable.remove();\n                    };\n                    command(e, function () {\n                        setTimeout(hide, 100);\n                    });\n                });\n\n                // 放大\n                $zoomBig.click(function (e) {\n                    commandFn = function commandFn() {\n                        $currentTable.css({\n                            width: '100%'\n                        });\n                    };\n                    command(e, function () {\n                        setTimeout(show);\n                    });\n                });\n\n                // 缩小\n                $zoomSmall.click(function (e) {\n                    commandFn = function commandFn() {\n                        $currentTable.css({\n                            width: 'auto'\n                        });\n                    };\n                    command(e, function () {\n                        setTimeout(show);\n                    });\n                });\n            }\n\n            // 显示 toolbar\n            function show() {\n                if (editor._disabled) {\n                    // 编辑器已经被禁用，则不让显示\n                    return;\n                }\n                if ($currentTable == null) {\n                    return;\n                }\n                $currentTable.addClass('clicked');\n                var tablePosition = $currentTable.position();\n                var tableTop = tablePosition.top;\n                var tableLeft = tablePosition.left;\n                var tableHeight = $currentTable.outerHeight();\n                var tableWidth = $currentTable.outerWidth();\n\n                // --- 定位 toolbar ---\n\n                // 计算初步结果\n                var top = tableTop + tableHeight;\n                var left = tableLeft;\n                var marginLeft = 0;\n\n                var txtTop = $currentTxt.position().top;\n                var txtHeight = $currentTxt.outerHeight();\n                if (top > txtTop + txtHeight) {\n                    // top 不得超出编辑范围\n                    top = txtTop + txtHeight;\n                }\n\n                // 显示（方便计算 margin）\n                $toolbar.show();\n\n                // 计算 margin\n                var width = $toolbar.outerWidth();\n                marginLeft = tableWidth / 2 - width / 2;\n\n                // 定位\n                $toolbar.css({\n                    top: top + 5,\n                    left: left,\n                    'margin-left': marginLeft\n                });\n                // 如果定位太靠左了\n                if (marginLeft < 0) {\n                    // 得到三角形的margin-left\n                    $toolbar.css('margin-left', '0');\n                    $triangle.hide();\n                } else {\n                    $triangle.show();\n                }\n            }\n\n            // 隐藏 toolbar\n            function hide() {\n                if ($currentTable == null) {\n                    return;\n                }\n                $currentTable.removeClass('clicked');\n                $currentTable = null;\n                $toolbar.hide();\n            }\n\n            // click table 事件\n            $currentTxt.on('click', 'table', function (e) {\n                var $table = $(e.currentTarget);\n\n                // 渲染\n                render();\n\n                if ($currentTable && $currentTable.get(0) === $table.get(0)) {\n                    setTimeout(hide, 100);\n                    return;\n                }\n\n                // 显示 toolbar\n                $currentTable = $table;\n                show();\n\n                // 阻止冒泡\n                e.preventDefault();\n                e.stopPropagation();\n            }).on('click keydown scroll', function (e) {\n                setTimeout(hide, 100);\n            });\n            E.$body.on('click keydown scroll', function (e) {\n                setTimeout(hide, 100);\n            });\n        });\n    });\n    // 编辑器区域 img toolbar\n    _e(function (E, $) {\n\n        if (E.userAgent.indexOf('MSIE 8') > 0) {\n            return;\n        }\n\n        E.plugin(function () {\n            var editor = this;\n            var lang = editor.config.lang;\n            var txt = editor.txt;\n            var $txt = txt.$txt;\n            var html = '';\n            // 说明：设置了 max-height 之后，$txt.parent() 负责滚动处理\n            var $currentTxt = editor.useMaxHeight ? $txt.parent() : $txt;\n            var $editorContainer = editor.$editorContainer;\n            var $currentImg;\n            var currentLink = '';\n\n            // 用到的dom节点\n            var isRendered = false;\n            var $dragPoint = $('<div class=\"img-drag-point\"></div>');\n\n            var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n            var $triangle = $('<div class=\"tip-triangle\"></div>');\n\n            var $menuContainer = $('<div></div>');\n            var $delete = $('<a href=\"#\"><i class=\"wangeditor-menu-img-trash-o\"></i></a>');\n            var $zoomSmall = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-minus\"></i></a>');\n            var $zoomBig = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-plus\"></i></a>');\n            // var $floatLeft = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-left\"></i></a>');\n            // var $noFloat = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-justify\"></i></a>');\n            // var $floatRight = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-right\"></i></a>');\n            var $alignLeft = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-left\"></i></a>');\n            var $alignCenter = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-center\"></i></a>');\n            var $alignRight = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-right\"></i></a>');\n            var $link = $('<a href=\"#\"><i class=\"wangeditor-menu-img-link\"></i></a>');\n            var $unLink = $('<a href=\"#\"><i class=\"wangeditor-menu-img-unlink\"></i></a>');\n\n            var $linkInputContainer = $('<div style=\"display:none;\"></div>');\n            var $linkInput = $('<input type=\"text\" style=\"height:26px; margin-left:10px; width:200px;\"/>');\n            var $linkBtnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $linkBtnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n            // 记录是否正在拖拽\n            var isOnDrag = false;\n\n            // 获取 / 设置 链接\n            function imgLink(e, url) {\n                if (!$currentImg) {\n                    return;\n                }\n                var commandFn;\n                var callback = function callback() {\n                    // 及时保存currentLink\n                    if (url != null) {\n                        currentLink = url;\n                    }\n                    if (html !== $txt.html()) {\n                        $txt.change();\n                    }\n                };\n                var $link;\n                var inLink = false;\n                var $parent = $currentImg.parent();\n                if ($parent.get(0).nodeName.toLowerCase() === 'a') {\n                    // 父元素就是图片链接\n                    $link = $parent;\n                    inLink = true;\n                } else {\n                    // 父元素不是图片链接，则重新创建一个链接\n                    $link = $('<a target=\"_blank\"></a>');\n                }\n\n                if (url == null) {\n                    // url 无值，是获取链接\n                    return $link.attr('href') || '';\n                } else if (url === '') {\n                    // url 是空字符串，是取消链接\n                    if (inLink) {\n                        commandFn = function commandFn() {\n                            $currentImg.unwrap();\n                        };\n                    }\n                } else {\n                    // url 有值，是设置链接\n                    if (url === currentLink) {\n                        return;\n                    }\n                    commandFn = function commandFn() {\n                        $link.attr('href', url);\n\n                        if (!inLink) {\n                            // 当前图片未包含在链接中，则包含进来\n                            $currentImg.wrap($link);\n                        }\n                    };\n                }\n\n                // 执行命令\n                if (commandFn) {\n                    // 记录下执行命令之前的html内容\n                    html = $txt.html();\n                    // 执行命令\n                    editor.customCommand(e, commandFn, callback);\n                }\n            }\n\n            // 渲染到页面\n            function render() {\n                if (isRendered) {\n                    return;\n                }\n\n                // 绑定事件\n                bindToolbarEvent();\n                bindDragEvent();\n\n                // 菜单放入 container\n                $menuContainer.append($delete).append($zoomSmall).append($zoomBig)\n                // .append($floatLeft)\n                // .append($noFloat)\n                // .append($floatRight);\n                .append($alignLeft).append($alignCenter).append($alignRight).append($link).append($unLink);\n\n                // 链接input放入container\n                $linkInputContainer.append($linkInput).append($linkBtnCancel).append($linkBtnSubmit);\n\n                // 拼接 渲染到页面上\n                $toolbar.append($triangle).append($menuContainer).append($linkInputContainer);\n\n                editor.$editorContainer.append($toolbar).append($dragPoint);\n                isRendered = true;\n            }\n\n            // 绑定toolbar事件\n            function bindToolbarEvent() {\n                // 统一执行命令的方法\n                var commandFn;\n                function customCommand(e, callback) {\n                    var cb;\n                    // 记录下执行命令之前的html内容\n                    html = $txt.html();\n                    cb = function cb() {\n                        if (callback) {\n                            callback();\n                        }\n                        if (html !== $txt.html()) {\n                            $txt.change();\n                        }\n                    };\n                    // 执行命令\n                    if (commandFn) {\n                        editor.customCommand(e, commandFn, cb);\n                    }\n                }\n\n                // 删除\n                $delete.click(function (e) {\n                    // 删除之前先unlink\n                    imgLink(e, '');\n\n                    // 删除图片\n                    commandFn = function commandFn() {\n                        $currentImg.remove();\n                    };\n                    customCommand(e, function () {\n                        setTimeout(hide, 100);\n                    });\n                });\n\n                // 放大\n                $zoomBig.click(function (e) {\n                    commandFn = function commandFn() {\n                        var img = $currentImg.get(0);\n                        var width = img.width;\n                        var height = img.height;\n                        width = width * 1.1;\n                        height = height * 1.1;\n\n                        $currentImg.css({\n                            width: width + 'px',\n                            height: height + 'px'\n                        });\n                    };\n                    customCommand(e, function () {\n                        setTimeout(show);\n                    });\n                });\n\n                // 缩小\n                $zoomSmall.click(function (e) {\n                    commandFn = function commandFn() {\n                        var img = $currentImg.get(0);\n                        var width = img.width;\n                        var height = img.height;\n                        width = width * 0.9;\n                        height = height * 0.9;\n\n                        $currentImg.css({\n                            width: width + 'px',\n                            height: height + 'px'\n                        });\n                    };\n                    customCommand(e, function () {\n                        setTimeout(show);\n                    });\n                });\n\n                // // 左浮动\n                // $floatLeft.click(function (e) {\n                //     commandFn = function () {\n                //         $currentImg.css({\n                //             float: 'left'\n                //         });\n                //     };\n                //     customCommand(e, function () {\n                //         setTimeout(hide, 100);\n                //     });\n                // });\n\n                // alignLeft\n                $alignLeft.click(function (e) {\n                    commandFn = function commandFn() {\n                        // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                        $currentImg.parents('p').css({\n                            'text-align': 'left'\n                        }).attr('align', 'left');\n                    };\n                    customCommand(e, function () {\n                        setTimeout(hide, 100);\n                    });\n                });\n\n                // // 右浮动\n                // $floatRight.click(function (e) {\n                //     commandFn = function () {\n                //         $currentImg.css({\n                //             float: 'right'\n                //         });\n                //     };\n                //     customCommand(e, function () {\n                //         setTimeout(hide, 100);\n                //     });\n                // });\n\n                // alignRight\n                $alignRight.click(function (e) {\n                    commandFn = function commandFn() {\n                        // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                        $currentImg.parents('p').css({\n                            'text-align': 'right'\n                        }).attr('align', 'right');\n                    };\n                    customCommand(e, function () {\n                        setTimeout(hide, 100);\n                    });\n                });\n\n                // // 无浮动\n                // $noFloat.click(function (e) {\n                //     commandFn = function () {\n                //         $currentImg.css({\n                //             float: 'none'\n                //         });\n                //     };\n                //     customCommand(e, function () {\n                //         setTimeout(hide, 100);\n                //     });\n                // });\n\n                // alignCenter\n                $alignCenter.click(function (e) {\n                    commandFn = function commandFn() {\n                        // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                        $currentImg.parents('p').css({\n                            'text-align': 'center'\n                        }).attr('align', 'center');\n                    };\n                    customCommand(e, function () {\n                        setTimeout(hide, 100);\n                    });\n                });\n\n                // link\n                // 显示链接input\n                $link.click(function (e) {\n                    e.preventDefault();\n\n                    // 获取当前链接，并显示\n                    currentLink = imgLink(e);\n                    $linkInput.val(currentLink);\n\n                    $menuContainer.hide();\n                    $linkInputContainer.show();\n                });\n                // 设置链接\n                $linkBtnSubmit.click(function (e) {\n                    e.preventDefault();\n\n                    var url = $.trim($linkInput.val());\n                    if (url) {\n                        // 设置链接，同时会自动更新 currentLink 的值\n                        imgLink(e, url);\n                    }\n\n                    // 隐藏 toolbar\n                    setTimeout(hide);\n                });\n                // 取消设置链接\n                $linkBtnCancel.click(function (e) {\n                    e.preventDefault();\n\n                    // 重置链接 input\n                    $linkInput.val(currentLink);\n\n                    $menuContainer.show();\n                    $linkInputContainer.hide();\n                });\n\n                // unlink\n                $unLink.click(function (e) {\n                    e.preventDefault();\n\n                    // 执行 unlink\n                    imgLink(e, '');\n\n                    // 隐藏 toolbar\n                    setTimeout(hide);\n                });\n            }\n\n            // 绑定drag事件\n            function bindDragEvent() {\n                var _x, _y;\n                var dragMarginLeft, dragMarginTop;\n                var imgWidth, imgHeight;\n\n                function mousemove(e) {\n                    var diffX, diffY;\n\n                    // 计算差额\n                    diffX = e.pageX - _x;\n                    diffY = e.pageY - _y;\n\n                    // --------- 计算拖拽点的位置 ---------\n                    var currentDragMarginLeft = dragMarginLeft + diffX;\n                    var currentDragMarginTop = dragMarginTop + diffY;\n                    $dragPoint.css({\n                        'margin-left': currentDragMarginLeft,\n                        'margin-top': currentDragMarginTop\n                    });\n\n                    // --------- 计算图片的大小 ---------\n                    var currentImgWidth = imgWidth + diffX;\n                    var currentImggHeight = imgHeight + diffY;\n                    $currentImg && $currentImg.css({\n                        width: currentImgWidth,\n                        height: currentImggHeight\n                    });\n                }\n\n                $dragPoint.on('mousedown', function (e) {\n                    if (!$currentImg) {\n                        return;\n                    }\n                    // 当前鼠标位置\n                    _x = e.pageX;\n                    _y = e.pageY;\n\n                    // 当前拖拽点的位置\n                    dragMarginLeft = parseFloat($dragPoint.css('margin-left'), 10);\n                    dragMarginTop = parseFloat($dragPoint.css('margin-top'), 10);\n\n                    // 当前图片的大小\n                    imgWidth = $currentImg.width();\n                    imgHeight = $currentImg.height();\n\n                    // 隐藏 $toolbar\n                    $toolbar.hide();\n\n                    // 绑定计算事件\n                    E.$document.on('mousemove._dragResizeImg', mousemove);\n                    E.$document.on('mouseup._dragResizeImg', function (e) {\n                        // 取消绑定\n                        E.$document.off('mousemove._dragResizeImg');\n                        E.$document.off('mouseup._dragResizeImg');\n\n                        // 隐藏，并还原拖拽点的位置\n                        hide();\n                        $dragPoint.css({\n                            'margin-left': dragMarginLeft,\n                            'margin-top': dragMarginTop\n                        });\n\n                        // 记录\n                        isOnDrag = false;\n                    });\n\n                    // 记录\n                    isOnDrag = true;\n                });\n            }\n\n            // 显示 toolbar\n            function show() {\n                if (editor._disabled) {\n                    // 编辑器已经被禁用，则不让显示\n                    return;\n                }\n                if ($currentImg == null) {\n                    return;\n                }\n                $currentImg.addClass('clicked');\n                var imgPosition = $currentImg.position();\n                var imgTop = imgPosition.top;\n                var imgLeft = imgPosition.left;\n                var imgHeight = $currentImg.outerHeight();\n                var imgWidth = $currentImg.outerWidth();\n\n                // --- 定位 dragpoint ---\n                $dragPoint.css({\n                    top: imgTop + imgHeight,\n                    left: imgLeft + imgWidth\n                });\n\n                // --- 定位 toolbar ---\n\n                // 计算初步结果\n                var top = imgTop + imgHeight;\n                var left = imgLeft;\n                var marginLeft = 0;\n\n                var txtTop = $currentTxt.position().top;\n                var txtHeight = $currentTxt.outerHeight();\n                if (top > txtTop + txtHeight) {\n                    // top 不得超出编辑范围\n                    top = txtTop + txtHeight;\n                } else {\n                    // top 超出编辑范围，dragPoint就不显示了\n                    $dragPoint.show();\n                }\n\n                // 显示（方便计算 margin）\n                $toolbar.show();\n\n                // 计算 margin\n                var width = $toolbar.outerWidth();\n                marginLeft = imgWidth / 2 - width / 2;\n\n                // 定位\n                $toolbar.css({\n                    top: top + 5,\n                    left: left,\n                    'margin-left': marginLeft\n                });\n                // 如果定位太靠左了\n                if (marginLeft < 0) {\n                    // 得到三角形的margin-left\n                    $toolbar.css('margin-left', '0');\n                    $triangle.hide();\n                } else {\n                    $triangle.show();\n                }\n\n                // disable 菜单\n                editor.disableMenusExcept();\n            }\n\n            // 隐藏 toolbar\n            function hide() {\n                if ($currentImg == null) {\n                    return;\n                }\n                $currentImg.removeClass('clicked');\n                $currentImg = null;\n\n                $toolbar.hide();\n                $dragPoint.hide();\n\n                // enable 菜单\n                editor.enableMenusExcept();\n            }\n\n            // 判断img是否是一个表情\n            function isEmotion(imgSrc) {\n                var result = false;\n                if (!editor.emotionUrls) {\n                    return result;\n                }\n                $.each(editor.emotionUrls, function (index, url) {\n                    var flag = false;\n                    if (imgSrc === url) {\n                        result = true;\n                        flag = true;\n                    }\n                    if (flag) {\n                        return false; // break 循环\n                    }\n                });\n                return result;\n            }\n\n            // click img 事件\n            $currentTxt.on('mousedown', 'img', function (e) {\n                e.preventDefault();\n            }).on('click', 'img', function (e) {\n                var $img = $(e.currentTarget);\n                var src = $img.attr('src');\n\n                if (!src || isEmotion(src)) {\n                    // 是一个表情图标\n                    return;\n                }\n\n                // ---------- 不是表情图标 ---------- \n\n                // 渲染\n                render();\n\n                if ($currentImg && $currentImg.get(0) === $img.get(0)) {\n                    setTimeout(hide, 100);\n                    return;\n                }\n\n                // 显示 toolbar\n                $currentImg = $img;\n                show();\n\n                // 默认显示menuContainer，其他默认隐藏\n                $menuContainer.show();\n                $linkInputContainer.hide();\n\n                // 阻止冒泡\n                e.preventDefault();\n                e.stopPropagation();\n            }).on('click keydown scroll', function (e) {\n                if (!isOnDrag) {\n                    setTimeout(hide, 100);\n                }\n            });\n        });\n    });\n    // 编辑区域 link toolbar\n    _e(function (E, $) {\n        E.plugin(function () {\n            var editor = this;\n            var lang = editor.config.lang;\n            var $txt = editor.txt.$txt;\n\n            // 当前命中的链接\n            var $currentLink;\n\n            var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n            var $triangle = $('<div class=\"tip-triangle\"></div>');\n            var $triggerLink = $('<a href=\"#\" target=\"_blank\"><i class=\"wangeditor-menu-img-link\"></i> ' + lang.openLink + '</a>');\n            var isRendered;\n\n            // 记录当前的显示/隐藏状态\n            var isShow = false;\n\n            var showTimeoutId, hideTimeoutId;\n            var showTimeoutIdByToolbar, hideTimeoutIdByToolbar;\n\n            // 渲染 dom\n            function render() {\n                if (isRendered) {\n                    return;\n                }\n\n                $toolbar.append($triangle).append($triggerLink);\n\n                editor.$editorContainer.append($toolbar);\n\n                isRendered = true;\n            }\n\n            // 定位\n            function setPosition() {\n                if (!$currentLink) {\n                    return;\n                }\n\n                var position = $currentLink.position();\n                var left = position.left;\n                var top = position.top;\n                var height = $currentLink.height();\n\n                // 初步计算top值\n                var topResult = top + height + 5;\n\n                // 判断 toolbar 是否超过了编辑器区域的下边界\n                var menuHeight = editor.menuContainer.height();\n                var txtHeight = editor.txt.$txt.outerHeight();\n                if (topResult > menuHeight + txtHeight) {\n                    topResult = menuHeight + txtHeight + 5;\n                }\n\n                // 最终设置\n                $toolbar.css({\n                    top: topResult,\n                    left: left\n                });\n            }\n\n            // 显示 toolbar\n            function show() {\n                if (isShow) {\n                    return;\n                }\n\n                if (!$currentLink) {\n                    return;\n                }\n\n                render();\n\n                $toolbar.show();\n\n                // 设置链接\n                var href = $currentLink.attr('href');\n                $triggerLink.attr('href', href);\n\n                // 定位\n                setPosition();\n\n                isShow = true;\n            }\n\n            // 隐藏 toolbar\n            function hide() {\n                if (!isShow) {\n                    return;\n                }\n\n                if (!$currentLink) {\n                    return;\n                }\n\n                $toolbar.hide();\n                isShow = false;\n            }\n\n            // $txt 绑定事件\n            $txt.on('mouseenter', 'a', function (e) {\n                // 延时 500ms 显示toolbar\n                if (showTimeoutId) {\n                    clearTimeout(showTimeoutId);\n                }\n                showTimeoutId = setTimeout(function () {\n                    var a = e.currentTarget;\n                    var $a = $(a);\n                    $currentLink = $a;\n\n                    var $img = $a.children('img');\n                    if ($img.length) {\n                        // 该链接下包含一个图片\n\n                        // 图片点击时，隐藏toolbar\n                        $img.click(function (e) {\n                            hide();\n                        });\n\n                        if ($img.hasClass('clicked')) {\n                            // 图片还处于clicked状态，则不显示toolbar\n                            return;\n                        }\n                    }\n\n                    // 显示toolbar\n                    show();\n                }, 500);\n            }).on('mouseleave', 'a', function (e) {\n                // 延时 500ms 隐藏toolbar\n                if (hideTimeoutId) {\n                    clearTimeout(hideTimeoutId);\n                }\n                hideTimeoutId = setTimeout(hide, 500);\n            }).on('click keydown scroll', function (e) {\n                setTimeout(hide, 100);\n            });\n            // $toolbar 绑定事件\n            $toolbar.on('mouseenter', function (e) {\n                // 先中断掉 $txt.mouseleave 导致的隐藏\n                if (hideTimeoutId) {\n                    clearTimeout(hideTimeoutId);\n                }\n            }).on('mouseleave', function (e) {\n                // 延时 500ms 显示toolbar\n                if (showTimeoutIdByToolbar) {\n                    clearTimeout(showTimeoutIdByToolbar);\n                }\n                showTimeoutIdByToolbar = setTimeout(hide, 500);\n            });\n        });\n    });\n    // menu吸顶\n    _e(function (E, $) {\n\n        E.plugin(function () {\n            var editor = this;\n            var menuFixed = editor.config.menuFixed;\n            if (menuFixed === false || typeof menuFixed !== 'number') {\n                // 没有配置菜单吸顶\n                return;\n            }\n            var bodyMarginTop = parseFloat(E.$body.css('margin-top'), 10);\n            if (isNaN(bodyMarginTop)) {\n                bodyMarginTop = 0;\n            }\n\n            var $editorContainer = editor.$editorContainer;\n            var editorTop = $editorContainer.offset().top;\n            var editorHeight = $editorContainer.outerHeight();\n\n            var $menuContainer = editor.menuContainer.$menuContainer;\n            var menuCssPosition = $menuContainer.css('position');\n            var menuCssTop = $menuContainer.css('top');\n            var menuTop = $menuContainer.offset().top;\n            var menuHeight = $menuContainer.outerHeight();\n            var menuWidth = $menuContainer.width();\n\n            //重新计算宽度\n            E.$window.resize(function () {\n                menuWidth = $menuContainer.width();\n            });\n            //编辑区高度变化\n            editor.onchange = function () {\n                editorHeight = $editorContainer.outerHeight();\n                menuWidth = $menuContainer.width(); //可能出现滚动条\n                menuFixedFunc();\n            };\n\n            //这个变量未使用？\n            //var $txt = editor.txt.$txt;\n\n            E.$window.scroll(menuFixedFunc);\n\n            function menuFixedFunc() {\n                //全屏模式不支持\n                if (editor.isFullScreen) {\n                    return;\n                }\n\n                var sTop = E.$window.scrollTop();\n\n                // 如果 menuTop === 0 说明此前编辑器一直隐藏，后来显示出来了，要重新计算相关数据\n                if (menuTop === 0) {\n                    menuTop = $menuContainer.offset().top;\n                    editorTop = $editorContainer.offset().top;\n                    editorHeight = $editorContainer.outerHeight();\n                    menuHeight = $menuContainer.outerHeight();\n                }\n\n                //菜单fixed条件由离开屏幕后（sTop >= menuTop）触发改为达到menuFixed高度时（sTop + menuFixed >= menuTop）触发\n                if (sTop + menuFixed >= menuTop && sTop + menuFixed + menuHeight + 30 < editorTop + editorHeight) {\n                    // 吸顶\n                    $menuContainer.css({\n                        position: 'fixed',\n                        top: menuFixed\n                    });\n\n                    // 固定宽度\n                    $menuContainer.width(menuWidth);\n\n                    // 增加body margin-top\n                    E.$body.css({\n                        'margin-top': bodyMarginTop + menuHeight\n                    });\n\n                    // 记录\n                    if (!editor._isMenufixed) {\n                        editor._isMenufixed = true;\n                    }\n                } else {\n                    // 取消吸顶\n                    $menuContainer.css({\n                        position: menuCssPosition,\n                        top: menuCssTop\n                    });\n\n                    // 取消宽度固定\n                    $menuContainer.css('width', '100%');\n\n                    // 还原 body margin-top\n                    E.$body.css({\n                        'margin-top': bodyMarginTop\n                    });\n\n                    // 撤销记录\n                    if (editor._isMenufixed) {\n                        editor._isMenufixed = false;\n                    }\n                }\n            }\n        });\n    });\n    // 缩进 菜单插件\n    _e(function (E, $) {\n\n        // 用 createMenu 方法创建菜单\n        E.createMenu(function (check) {\n\n            // 定义菜单id，不要和其他菜单id重复。编辑器自带的所有菜单id，可通过『参数配置-自定义菜单』一节查看\n            var menuId = 'indent';\n\n            // check将检查菜单配置（『参数配置-自定义菜单』一节描述）中是否该菜单id，如果没有，则忽略下面的代码。\n            if (!check(menuId)) {\n                return;\n            }\n\n            // this 指向 editor 对象自身\n            var editor = this;\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor, // 编辑器对象\n                id: menuId, // 菜单id\n                title: '缩进', // 菜单标题\n\n                // 正常状态和选中装下的dom对象，样式需要自定义\n                $domNormal: $('<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-indent-left\"></i></a>'),\n                $domSelected: $('<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-indent-left\"></i></a>')\n            });\n\n            // 菜单正常状态下，点击将触发该事件\n            menu.clickEvent = function (e) {\n                var elem = editor.getRangeElem();\n                var p = editor.getSelfOrParentByName(elem, 'p');\n                var $p;\n\n                if (!p) {\n                    // 未找到 p 元素，则忽略\n                    return e.preventDefault();\n                }\n                $p = $(p);\n\n                // 使用自定义命令\n                function commandFn() {\n                    $p.css('text-indent', '2em');\n                }\n                editor.customCommand(e, commandFn);\n            };\n\n            // 菜单选中状态下，点击将触发该事件\n            menu.clickEventSelected = function (e) {\n                var elem = editor.getRangeElem();\n                var p = editor.getSelfOrParentByName(elem, 'p');\n                var $p;\n\n                if (!p) {\n                    // 未找到 p 元素，则忽略\n                    return e.preventDefault();\n                }\n                $p = $(p);\n\n                // 使用自定义命令\n                function commandFn() {\n                    $p.css('text-indent', '0');\n                }\n                editor.customCommand(e, commandFn);\n            };\n\n            // 根据当前选区，自定义更新菜单的选中状态或者正常状态\n            menu.updateSelectedEvent = function () {\n                // 获取当前选区所在的父元素\n                var elem = editor.getRangeElem();\n                var p = editor.getSelfOrParentByName(elem, 'p');\n                var $p;\n                var indent;\n\n                if (!p) {\n                    // 未找到 p 元素，则标记为未处于选中状态\n                    return false;\n                }\n                $p = $(p);\n                indent = $p.css('text-indent');\n\n                if (!indent || indent === '0px') {\n                    // 得到的p，text-indent 属性是 0，则标记为未处于选中状态\n                    return false;\n                }\n\n                // 找到 p 元素，并且 text-indent 不是 0，则标记为选中状态\n                return true;\n            };\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // 行高 菜单插件\n    _e(function (E, $) {\n\n        // 用 createMenu 方法创建菜单\n        E.createMenu(function (check) {\n\n            // 定义菜单id，不要和其他菜单id重复。编辑器自带的所有菜单id，可通过『参数配置-自定义菜单』一节查看\n            var menuId = 'lineheight';\n\n            // check将检查菜单配置（『参数配置-自定义菜单』一节描述）中是否该菜单id，如果没有，则忽略下面的代码。\n            if (!check(menuId)) {\n                return;\n            }\n\n            // this 指向 editor 对象自身\n            var editor = this;\n\n            // 由于浏览器自身不支持 lineHeight 命令，因此要做一个hook\n            editor.commandHooks.lineHeight = function (value) {\n                var rangeElem = editor.getRangeElem();\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,pre');\n                if (!targetElem) {\n                    return;\n                }\n                $(targetElem).css('line-height', value + '');\n            };\n\n            // 创建 menu 对象\n            var menu = new E.Menu({\n                editor: editor, // 编辑器对象\n                id: menuId, // 菜单id\n                title: '行高', // 菜单标题\n                commandName: 'lineHeight', // 命令名称\n\n                // 正常状态和选中装下的dom对象，样式需要自定义\n                $domNormal: $('<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-arrows-v\"></i></a>'),\n                $domSelected: $('<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-arrows-v\"></i></a>')\n            });\n\n            // 数据源\n            var data = {\n                // 格式： 'value' : 'title'\n                '1.0': '1.0倍',\n                '1.5': '1.5倍',\n                '1.8': '1.8倍',\n                '2.0': '2.0倍',\n                '2.5': '2.5倍',\n                '3.0': '3.0倍'\n            };\n\n            // 为menu创建droplist对象\n            var tpl = '<span style=\"line-height:{#commandValue}\">{#title}</span>';\n            menu.dropList = new E.DropList(editor, menu, {\n                data: data, // 传入数据源\n                tpl: tpl // 传入模板\n            });\n\n            // 增加到editor对象中\n            editor.menus[menuId] = menu;\n        });\n    });\n    // 自定义上传\n    _e(function (E, $) {\n\n        E.plugin(function () {\n\n            var editor = this;\n            var customUpload = editor.config.customUpload;\n            if (!customUpload) {\n                return;\n            } else if (editor.config.uploadImgUrl) {\n                alert('自定义上传无效，详看浏览器日志console.log');\n                E.error('已经配置了 uploadImgUrl ，就不能再配置 customUpload ，两者冲突。将导致自定义上传无效。');\n                return;\n            }\n\n            var $uploadContent = editor.$uploadContent;\n            if (!$uploadContent) {\n                E.error('自定义上传，无法获取 editor.$uploadContent');\n            }\n\n            // UI\n            var $uploadIcon = $('<div class=\"upload-icon-container\"><i class=\"wangeditor-menu-img-upload\"></i></div>');\n            $uploadContent.append($uploadIcon);\n\n            // 设置id，并暴露\n            var btnId = 'upload' + E.random();\n            var containerId = 'upload' + E.random();\n            $uploadIcon.attr('id', btnId);\n            $uploadContent.attr('id', containerId);\n\n            editor.customUploadBtnId = btnId;\n            editor.customUploadContainerId = containerId;\n        });\n    });\n    // 版权提示\n    _e(function (E, $) {\n        E.info('本页面富文本编辑器由 wangEditor 提供 http://wangeditor.github.io/ ');\n    });\n\n    // 最终返回wangEditor构造函数\n    return window.wangEditor;\n});\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(\"3IRH\")(module)))\n\n/***/ }),\n\n/***/ 2:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(\"eZkf\");\n\n\n/***/ }),\n\n/***/ \"3IRH\":\n/***/ (function(module, exports) {\n\nmodule.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n/***/ }),\n\n/***/ \"Cgxu\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"FZ+f\")(undefined);\n// imports\n\n\n// module\nexports.push([module.i, \".wangEditor-container{position:relative;background-color:#fff;border:1px solid #ccc;z-index:1;width:100%}.wangEditor-container a:focus,.wangEditor-container button:focus{outline:none}.wangEditor-container,.wangEditor-container *{margin:0;padding:0;box-sizing:border-box;line-height:1}.wangEditor-container img{border:none}.wangEditor-container .clearfix:after{content:\\\"\\\";display:table;clear:both}.wangEditor-container .clearfix{*zoom:1}.wangEditor-container textarea{border:none}.wangEditor-container textarea:focus{outline:none}.wangEditor-container .height-tip{position:absolute;width:3px;background-color:#ccc;left:0;transition:top .2s}.wangEditor-container .txt-toolbar{position:absolute;background-color:#fff;padding:3px 5px;border-top:2px solid #666;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-container .txt-toolbar .tip-triangle{display:block;position:absolute;width:0;height:0;border:5px solid;border-color:transparent transparent #666;top:-12px;left:50%;margin-left:-5px}.wangEditor-container .txt-toolbar a{color:#666;display:inline-block;margin:0 3px;padding:5px;text-decoration:none;border-radius:3px}.wangEditor-container .txt-toolbar a:hover{background-color:#f1f1f1}.wangEditor-container .img-drag-point{display:block;position:absolute;width:12px;height:12px;border-radius:50%;cursor:se-resize;background-color:#666;margin-left:-6px;margin-top:-6px;box-shadow:1px 1px 5px #999}.wangEditor-container .wangEditor-upload-progress{position:absolute;height:1px;background:#1e88e5;width:0;display:none;-webkit-transition:width .5s;-o-transition:width .5s;transition:width .5s}.wangEditor-fullscreen{position:fixed;top:0;bottom:0;left:0;right:0}.wangEditor-container .code-textarea{resize:none;width:100%;font-size:14px;line-height:1.5;font-family:Verdana;color:#333;padding:0 15px}.wangEditor-menu-container{width:100%;border-bottom:1px solid #f1f1f1;background-color:#fff}.wangEditor-menu-container a{text-decoration:none}.wangEditor-menu-container .menu-group{float:left;padding:0 8px;border-right:1px solid #f1f1f1}.wangEditor-menu-container .menu-item{float:left;position:relative;text-align:center;height:31px;width:35px}.wangEditor-menu-container .menu-item:hover{background-color:#f1f1f1}.wangEditor-menu-container .menu-item a{display:block;text-align:center;color:#666;width:100%;padding:8px 0;font-size:.9em}.wangEditor-menu-container .menu-item .selected{color:#1e88e5}.wangEditor-menu-container .menu-item .active{background-color:#f1f1f1}.wangEditor-menu-container .menu-item .disable{opacity:.5;filter:alpha(opacity=50)}.wangEditor-menu-container .menu-tip{display:block;position:absolute;z-index:20;width:60px;text-align:center;background-color:#666;color:#fff;padding:7px 0;font-size:12px;top:100%;left:50%;margin-left:-30px;border-radius:2px;box-shadow:1px 1px 5px #999;display:none}.wangEditor-menu-container .menu-tip-40{width:40px;margin-left:-20px}.wangEditor-menu-container .menu-tip-50{width:50px;margin-left:-25px}.wangEditor-menu-shadow{border-bottom:1px\\\\9#f1f1f1\\\\9;box-shadow:0 1px 3px #999}.wangEditor-container .wangEditor-txt{width:100%;text-align:left;padding:15px;padding-top:0;margin-top:5px;overflow-y:auto}.wangEditor-container .wangEditor-txt h1,.wangEditor-container .wangEditor-txt h2,.wangEditor-container .wangEditor-txt h3,.wangEditor-container .wangEditor-txt h4,.wangEditor-container .wangEditor-txt h5,.wangEditor-container .wangEditor-txt p{margin:10px 0;line-height:1.8}.wangEditor-container .wangEditor-txt h1 *,.wangEditor-container .wangEditor-txt h2 *,.wangEditor-container .wangEditor-txt h3 *,.wangEditor-container .wangEditor-txt h4 *,.wangEditor-container .wangEditor-txt h5 *,.wangEditor-container .wangEditor-txt p *{line-height:1.8}.wangEditor-container .wangEditor-txt ol,.wangEditor-container .wangEditor-txt ul{padding-left:20px}.wangEditor-container .wangEditor-txt img{cursor:pointer}.wangEditor-container .wangEditor-txt img.clicked,.wangEditor-container .wangEditor-txt table.clicked{box-shadow:1px 1px 10px #999}.wangEditor-container .wangEditor-txt pre code{line-height:1.5}.wangEditor-container .wangEditor-txt:focus{outline:none}.wangEditor-container .wangEditor-txt blockquote{display:block;border-left:8px solid #d0e5f2;padding:5px 10px;margin:10px 0;line-height:1.4;font-size:100%;background-color:#f1f1f1}.wangEditor-container .wangEditor-txt table{border:none;border-collapse:collapse}.wangEditor-container .wangEditor-txt table td,.wangEditor-container .wangEditor-txt table th{border:1px solid #999;padding:3px 5px;min-width:50px;height:20px}.wangEditor-container .wangEditor-txt pre{border:1px solid #ccc;background-color:#f8f8f8;padding:10px;margin:5px 0;font-size:.8em;border-radius:3px}.wangEditor-drop-list{display:none;position:absolute;background-color:#fff;overflow:hidden;z-index:10;transition:height .7s;border-top:1px solid #f1f1f1;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-drop-list a{text-decoration:none;display:block;color:#666;padding:3px 5px}.wangEditor-drop-list a:hover{background-color:#f1f1f1}.txt-toolbar,.wangEditor-drop-panel{display:none;position:absolute;padding:10px;font-size:14px;background-color:#fff;z-index:10;border-top:2px solid #666;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.txt-toolbar .tip-triangle,.wangEditor-drop-panel .tip-triangle{display:block;position:absolute;width:0;height:0;border:5px solid;border-color:transparent transparent #666;top:-12px;left:50%;margin-left:-5px}.txt-toolbar a,.wangEditor-drop-panel a{text-decoration:none}.txt-toolbar input[type=text],.wangEditor-drop-panel input[type=text]{border:none;border-bottom:1px solid #ccc;font-size:14px;height:20px;color:#333;padding:3px 0}.txt-toolbar input[type=text]:focus,.wangEditor-drop-panel input[type=text]:focus{outline:none;border-bottom:2px solid #1e88e5}.txt-toolbar input[type=text].block,.wangEditor-drop-panel input[type=text].block{display:block;width:100%}.txt-toolbar textarea,.wangEditor-drop-panel textarea{border:1px solid #ccc}.txt-toolbar textarea:focus,.wangEditor-drop-panel textarea:focus{outline:none;border-color:#1e88e5}.txt-toolbar button,.wangEditor-drop-panel button{font-size:14px;color:#1e88e5;border:none;padding:10px;background-color:#fff;cursor:pointer;border-radius:3px}.txt-toolbar button:hover,.wangEditor-drop-panel button:hover{background-color:#f1f1f1}.txt-toolbar button:focus,.wangEditor-drop-panel button:focus{outline:none}.txt-toolbar button.right,.wangEditor-drop-panel button.right{float:right;margin-left:10px}.txt-toolbar button.gray,.wangEditor-drop-panel button.gray{color:#999}.txt-toolbar button.link,.wangEditor-drop-panel button.link{padding:5px 10px}.txt-toolbar button.link:hover,.wangEditor-drop-panel button.link:hover{background-color:#fff;text-decoration:underline}.txt-toolbar .color-item,.wangEditor-drop-panel .color-item{display:block;float:left;width:25px;height:25px;text-align:center;padding:2px;border-radius:2px;text-decoration:underline}.txt-toolbar .color-item:hover,.wangEditor-drop-panel .color-item:hover{background-color:#f1f1f1}.txt-toolbar .list-menu-item,.wangEditor-drop-panel .list-menu-item{display:block;float:left;color:#333;padding:5px;border-radius:2px}.txt-toolbar .list-menu-item:hover,.wangEditor-drop-panel .list-menu-item:hover{background-color:#f1f1f1}.txt-toolbar table.choose-table,.wangEditor-drop-panel table.choose-table{border:none;border-collapse:collapse}.txt-toolbar table.choose-table td,.wangEditor-drop-panel table.choose-table td{border:1px solid #ccc;width:16px;height:12px}.txt-toolbar table.choose-table td.active,.wangEditor-drop-panel table.choose-table td.active{background-color:#ccc;opacity:.5;filter:alpha(opacity=50)}.txt-toolbar .panel-tab .tab-container,.wangEditor-drop-panel .panel-tab .tab-container{margin-bottom:5px}.txt-toolbar .panel-tab .tab-container a,.wangEditor-drop-panel .panel-tab .tab-container a{display:inline-block;color:#999;text-align:center;margin:0 5px;padding:5px}.txt-toolbar .panel-tab .tab-container a.selected,.wangEditor-drop-panel .panel-tab .tab-container a.selected{color:#1e88e5;border-bottom:2px solid #1e88e5}.txt-toolbar .panel-tab .content-container .content,.wangEditor-drop-panel .panel-tab .content-container .content{display:none}.txt-toolbar .panel-tab .content-container .content a,.wangEditor-drop-panel .panel-tab .content-container .content a{display:inline-block;margin:2px;padding:2px;border-radius:2px}.txt-toolbar .panel-tab .content-container .content a:hover,.wangEditor-drop-panel .panel-tab .content-container .content a:hover{background-color:#f1f1f1}.txt-toolbar .panel-tab .content-container .selected,.wangEditor-drop-panel .panel-tab .content-container .selected{display:block}.txt-toolbar .panel-tab .emotion-content-container,.wangEditor-drop-panel .panel-tab .emotion-content-container{height:200px;overflow-y:auto}.txt-toolbar .upload-icon-container,.wangEditor-drop-panel .upload-icon-container{color:#ccc;text-align:center;margin:20px 20px 15px!important;padding:5px!important;font-size:65px;cursor:pointer;border:2px dotted #f1f1f1;display:block!important}.txt-toolbar .upload-icon-container:hover,.wangEditor-drop-panel .upload-icon-container:hover{color:#666;border-color:#ccc}.wangEditor-modal{position:absolute;top:50%;left:50%;background-color:#fff;border-top:1px solid #f1f1f1;box-shadow:1px 3px 3px #999;border-top:1px\\\\9#ccc\\\\9;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-modal .wangEditor-modal-close{position:absolute;top:0;right:0;margin-top:-25px;margin-right:-25px;font-size:1.5em;color:#666;cursor:pointer}@font-face{font-family:icomoon;src:url(\" + __webpack_require__(\"sP74\") + \");src:url(\" + __webpack_require__(\"ZB9v\") + \"?#iefix-qdfu1s) format(\\\"embedded-opentype\\\"),url(\" + __webpack_require__(\"bjMF\") + \") format(\\\"truetype\\\"),url(\" + __webpack_require__(\"Vdmf\") + \") format(\\\"woff\\\"),url(\" + __webpack_require__(\"SY6W\") + \"#icomoon) format(\\\"svg\\\");font-weight:400;font-style:normal}[class*=\\\" wangeditor-menu-img-\\\"],[class^=wangeditor-menu-img-]{font-family:icomoon;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.wangeditor-menu-img-link:before{content:\\\"\\\\E800\\\"}.wangeditor-menu-img-unlink:before{content:\\\"\\\\E801\\\"}.wangeditor-menu-img-code:before{content:\\\"\\\\E802\\\"}.wangeditor-menu-img-cancel:before{content:\\\"\\\\E803\\\"}.wangeditor-menu-img-terminal:before{content:\\\"\\\\E804\\\"}.wangeditor-menu-img-angle-down:before{content:\\\"\\\\E805\\\"}.wangeditor-menu-img-font:before{content:\\\"\\\\E806\\\"}.wangeditor-menu-img-bold:before{content:\\\"\\\\E807\\\"}.wangeditor-menu-img-italic:before{content:\\\"\\\\E808\\\"}.wangeditor-menu-img-header:before{content:\\\"\\\\E809\\\"}.wangeditor-menu-img-align-left:before{content:\\\"\\\\E80A\\\"}.wangeditor-menu-img-align-center:before{content:\\\"\\\\E80B\\\"}.wangeditor-menu-img-align-right:before{content:\\\"\\\\E80C\\\"}.wangeditor-menu-img-list-bullet:before{content:\\\"\\\\E80D\\\"}.wangeditor-menu-img-indent-left:before{content:\\\"\\\\E80E\\\"}.wangeditor-menu-img-indent-right:before{content:\\\"\\\\E80F\\\"}.wangeditor-menu-img-list-numbered:before{content:\\\"\\\\E810\\\"}.wangeditor-menu-img-underline:before{content:\\\"\\\\E811\\\"}.wangeditor-menu-img-table:before{content:\\\"\\\\E812\\\"}.wangeditor-menu-img-eraser:before{content:\\\"\\\\E813\\\"}.wangeditor-menu-img-text-height:before{content:\\\"\\\\E814\\\"}.wangeditor-menu-img-brush:before{content:\\\"\\\\E815\\\"}.wangeditor-menu-img-pencil:before{content:\\\"\\\\E816\\\"}.wangeditor-menu-img-minus:before{content:\\\"\\\\E817\\\"}.wangeditor-menu-img-picture:before{content:\\\"\\\\E818\\\"}.wangeditor-menu-img-file-image:before{content:\\\"\\\\E819\\\"}.wangeditor-menu-img-cw:before{content:\\\"\\\\E81A\\\"}.wangeditor-menu-img-ccw:before{content:\\\"\\\\E81B\\\"}.wangeditor-menu-img-music:before{content:\\\"\\\\E911\\\"}.wangeditor-menu-img-play:before{content:\\\"\\\\E912\\\"}.wangeditor-menu-img-location:before{content:\\\"\\\\E947\\\"}.wangeditor-menu-img-happy:before{content:\\\"\\\\E9DF\\\"}.wangeditor-menu-img-sigma:before{content:\\\"\\\\EA67\\\"}.wangeditor-menu-img-enlarge2:before{content:\\\"\\\\E98B\\\"}.wangeditor-menu-img-shrink2:before{content:\\\"\\\\E98C\\\"}.wangeditor-menu-img-newspaper:before{content:\\\"\\\\E904\\\"}.wangeditor-menu-img-camera:before{content:\\\"\\\\E90F\\\"}.wangeditor-menu-img-video-camera:before{content:\\\"\\\\E914\\\"}.wangeditor-menu-img-file-zip:before{content:\\\"\\\\E92B\\\"}.wangeditor-menu-img-stack:before{content:\\\"\\\\E92E\\\"}.wangeditor-menu-img-credit-card:before{content:\\\"\\\\E93F\\\"}.wangeditor-menu-img-address-book:before{content:\\\"\\\\E944\\\"}.wangeditor-menu-img-envelop:before{content:\\\"\\\\E945\\\"}.wangeditor-menu-img-drawer:before{content:\\\"\\\\E95C\\\"}.wangeditor-menu-img-download:before{content:\\\"\\\\E960\\\"}.wangeditor-menu-img-upload:before{content:\\\"\\\\E961\\\"}.wangeditor-menu-img-lock:before{content:\\\"\\\\E98F\\\"}.wangeditor-menu-img-unlocked:before{content:\\\"\\\\E990\\\"}.wangeditor-menu-img-wrench:before{content:\\\"\\\\E991\\\"}.wangeditor-menu-img-eye:before{content:\\\"\\\\E9CE\\\"}.wangeditor-menu-img-eye-blocked:before{content:\\\"\\\\E9D1\\\"}.wangeditor-menu-img-command:before{content:\\\"\\\\EA4E\\\"}.wangeditor-menu-img-font2:before{content:\\\"\\\\EA5C\\\"}.wangeditor-menu-img-libreoffice:before{content:\\\"\\\\EADE\\\"}.wangeditor-menu-img-quotes-left:before{content:\\\"\\\\E977\\\"}.wangeditor-menu-img-strikethrough:before{content:\\\"\\\\EA65\\\"}.wangeditor-menu-img-desktop:before{content:\\\"\\\\F108\\\"}.wangeditor-menu-img-tablet:before{content:\\\"\\\\F10A\\\"}.wangeditor-menu-img-search-plus:before{content:\\\"\\\\F00E\\\"}.wangeditor-menu-img-search-minus:before{content:\\\"\\\\F010\\\"}.wangeditor-menu-img-trash-o:before{content:\\\"\\\\F014\\\"}.wangeditor-menu-img-align-justify:before{content:\\\"\\\\F039\\\"}.wangeditor-menu-img-arrows-v:before{content:\\\"\\\\F07D\\\"}.wangeditor-menu-img-sigma2:before{content:\\\"\\\\EA68\\\"}.wangeditor-menu-img-omega:before{content:\\\"\\\\E900\\\"}.wangeditor-menu-img-cancel-circle:before{content:\\\"\\\\E901\\\"}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment{color:#998;font-style:italic}.css .rule .hljs-keyword,.hljs-keyword,.hljs-request,.hljs-status,.hljs-subst,.hljs-winutils,.nginx .hljs-title{color:#333;font-weight:700}.hljs-hexcolor,.hljs-number,.ruby .hljs-constant{color:teal}.hljs-doctag,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#d14}.hljs-id,.hljs-title,.scss .hljs-preprocessor{color:#900;font-weight:700}.hljs-list .hljs-keyword,.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type,.tex .hljs-command,.vhdl .hljs-literal{color:#458;font-weight:700}.django .hljs-tag .hljs-keyword,.hljs-rule .hljs-property,.hljs-tag,.hljs-tag .hljs-title{color:navy;font-weight:400}.hljs-attribute,.hljs-name,.hljs-variable,.lisp .hljs-body{color:teal}.hljs-regexp{color:#009926}.clojure .hljs-keyword,.hljs-prompt,.hljs-symbol,.lisp .hljs-keyword,.ruby .hljs-symbol .hljs-string,.scheme .hljs-keyword,.tex .hljs-special{color:#990073}.hljs-built_in{color:#0086b3}.hljs-cdata,.hljs-doctype,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-shebang{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.diff .hljs-change{background:#0086b3}.hljs-chunk{color:#aaa}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"DuR2\":\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ }),\n\n/***/ \"EKta\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction placeHoldersCount (b64) {\n  var len = b64.length\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // the number of equal signs (place holders)\n  // if there are two placeholders, than the two characters before it\n  // represent one byte\n  // if there is only one, then the three characters before it represent 2 bytes\n  // this is just a cheap hack to not do indexOf twice\n  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0\n}\n\nfunction byteLength (b64) {\n  // base64 is 4/3 + up to two characters of the original data\n  return b64.length * 3 / 4 - placeHoldersCount(b64)\n}\n\nfunction toByteArray (b64) {\n  var i, j, l, tmp, placeHolders, arr\n  var len = b64.length\n  placeHolders = placeHoldersCount(b64)\n\n  arr = new Arr(len * 3 / 4 - placeHolders)\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  l = placeHolders > 0 ? len - 4 : len\n\n  var L = 0\n\n  for (i = 0, j = 0; i < l; i += 4, j += 3) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]\n    arr[L++] = (tmp >> 16) & 0xFF\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  if (placeHolders === 2) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[L++] = tmp & 0xFF\n  } else if (placeHolders === 1) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var output = ''\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    output += lookup[tmp >> 2]\n    output += lookup[(tmp << 4) & 0x3F]\n    output += '=='\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])\n    output += lookup[tmp >> 10]\n    output += lookup[(tmp >> 4) & 0x3F]\n    output += lookup[(tmp << 2) & 0x3F]\n    output += '='\n  }\n\n  parts.push(output)\n\n  return parts.join('')\n}\n\n\n/***/ }),\n\n/***/ \"EuP9\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global) {/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n\n\nvar base64 = __webpack_require__(\"EKta\")\nvar ieee754 = __webpack_require__(\"ujcs\")\nvar isArray = __webpack_require__(\"sOR5\")\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(\"DuR2\")))\n\n/***/ }),\n\n/***/ \"FZ+f\":\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(Buffer) {/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap) {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n  var base64 = new Buffer(JSON.stringify(sourceMap)).toString('base64');\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n  return '/*# ' + data + ' */';\n}\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(\"EuP9\").Buffer))\n\n/***/ }),\n\n/***/ \"SY6W\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"/fonts/icomoon.svg\";\n\n/***/ }),\n\n/***/ \"Vdmf\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"/fonts/icomoon.woff\";\n\n/***/ }),\n\n/***/ \"ZB9v\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"/fonts/icomoon.eot\";\n\n/***/ }),\n\n/***/ \"bjMF\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"/fonts/icomoon.ttf\";\n\n/***/ }),\n\n/***/ \"eZkf\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/**\r\n * Created by 米饭 on 2017-03-15.\r\n */\r\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar angular = __webpack_require__(0);\r\nvar wangEditor = __webpack_require__(\"1Ufw\");\r\nexports.default = angular.module('wangEditorDirective', [])\r\n    .directive('contentEditable', contentEditable)\r\n    .name;\r\nfunction contentEditable() {\r\n    return {\r\n        restrict: 'A',\r\n        require: '?ngModel',\r\n        replace: false,\r\n        link: function (scope, element, attrs, ngModel) {\r\n            // 初始化 编辑器内容\r\n            if (!ngModel) {\r\n                return;\r\n            }\r\n            ngModel.$render = function () {\r\n                element.html(ngModel.$viewValue || '');\r\n            };\r\n            element.on('blur keyup change', function () {\r\n                scope.$apply(readViewText);\r\n            });\r\n            function readViewText() {\r\n                var html = element.html();\r\n                if (attrs.stripBr && html === '<br>') {\r\n                    html = '';\r\n                }\r\n                ngModel.$setViewValue(html);\r\n            }\r\n            // 创建编辑器\r\n            var editor = new wangEditor(element);\r\n            editor.config.menus = [\r\n                'bold', 'italic', 'strikethrough', 'head', '|',\r\n                'quote', 'unorderlist', 'orderlist', 'alignleft', 'aligncenter', 'alignright', '|',\r\n                'link', 'table', 'img', 'insertcode', '|',\r\n                'undo', 'redo', 'eraser', '|',\r\n                'source'\r\n            ];\r\n            editor.config.menuFixed = 50;\r\n            editor.create();\r\n        }\r\n    };\r\n}\r\n\n\n/***/ }),\n\n/***/ \"fjbf\":\n/***/ (function(module, exports, __webpack_require__) {\n\n/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nvar stylesInDom = {},\n\tmemoize = function(fn) {\n\t\tvar memo;\n\t\treturn function () {\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\treturn memo;\n\t\t};\n\t},\n\tisOldIE = memoize(function() {\n\t\t// Test for IE <= 9 as proposed by Browserhacks\n\t\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t\t// Tests for existence of standard globals is to allow style-loader \n\t\t// to operate correctly into non-standard environments\n\t\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\t\treturn window && document && document.all && !window.atob;\n\t}),\n\tgetElement = (function(fn) {\n\t\tvar memo = {};\n\t\treturn function(selector) {\n\t\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t\t}\n\t\t\treturn memo[selector]\n\t\t};\n\t})(function (styleTarget) {\n\t\treturn document.querySelector(styleTarget)\n\t}),\n\tsingletonElement = null,\n\tsingletonCounter = 0,\n\tstyleElementsInsertedAtTop = [],\n\tfixUrls = __webpack_require__(\"quY5\");\n\nmodule.exports = function(list, options) {\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (typeof options.insertInto === \"undefined\") options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list);\n\taddStylesToDom(styles, options);\n\n\treturn function update(newList) {\n\t\tvar mayRemove = [];\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom(styles, options) {\n\tfor(var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles(list) {\n\tvar styles = [];\n\tvar newStyles = {};\n\tfor(var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\tif(!newStyles[id])\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse\n\t\t\tnewStyles[id].parts.push(part);\n\t}\n\treturn styles;\n}\n\nfunction insertStyleElement(options, styleElement) {\n\tvar styleTarget = getElement(options.insertInto)\n\tif (!styleTarget) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\tif (options.insertAt === \"top\") {\n\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\tstyleTarget.insertBefore(styleElement, styleTarget.firstChild);\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\tstyleTarget.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\tstyleTarget.appendChild(styleElement);\n\t\t}\n\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t} else if (options.insertAt === \"bottom\") {\n\t\tstyleTarget.appendChild(styleElement);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement(styleElement) {\n\tstyleElement.parentNode.removeChild(styleElement);\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\tif(idx >= 0) {\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement(options) {\n\tvar styleElement = document.createElement(\"style\");\n\toptions.attrs.type = \"text/css\";\n\n\tattachTagAttrs(styleElement, options.attrs);\n\tinsertStyleElement(options, styleElement);\n\treturn styleElement;\n}\n\nfunction createLinkElement(options) {\n\tvar linkElement = document.createElement(\"link\");\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\tattachTagAttrs(linkElement, options.attrs);\n\tinsertStyleElement(options, linkElement);\n\treturn linkElement;\n}\n\nfunction attachTagAttrs(element, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\telement.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle(obj, options) {\n\tvar styleElement, update, remove;\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t} else if(obj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\") {\n\t\tstyleElement = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, styleElement, options);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t\tif(styleElement.href)\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t};\n\t} else {\n\t\tstyleElement = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle(newObj) {\n\t\tif(newObj) {\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\treturn;\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = styleElement.childNodes;\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\tif (childNodes.length) {\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyleElement.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag(styleElement, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyleElement.setAttribute(\"media\", media)\n\t}\n\n\tif(styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = css;\n\t} else {\n\t\twhile(styleElement.firstChild) {\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t}\n\t\tstyleElement.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink(linkElement, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/* If convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls){\n\t\tcss = fixUrls(css);\n\t}\n\n\tif(sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = linkElement.href;\n\n\tlinkElement.href = URL.createObjectURL(blob);\n\n\tif(oldSrc)\n\t\tURL.revokeObjectURL(oldSrc);\n}\n\n\n/***/ }),\n\n/***/ \"quY5\":\n/***/ (function(module, exports) {\n\n\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n/***/ }),\n\n/***/ \"sOR5\":\n/***/ (function(module, exports) {\n\nvar toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n\n\n/***/ }),\n\n/***/ \"sP74\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"/fonts/icomoon.eot\";\n\n/***/ }),\n\n/***/ \"ujcs\":\n/***/ (function(module, exports) {\n\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n\n\n/***/ }),\n\n/***/ \"x7Ro\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"Cgxu\");\nif(typeof content === 'string') content = [[module.i, content, '']];\n// add the styles to the DOM\nvar update = __webpack_require__(\"fjbf\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(false) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!./wangEditor.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!./wangEditor.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n/***/ })\n\n},[2]);\n\n\n// WEBPACK FOOTER //\n// scripts/vendor.7a6b57.js","module.exports = angular;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 0\n// module chunks = 1","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 1\n// module chunks = 1","(function (factory) {\n    if (typeof window.define === 'function') {\n        if (window.define.amd) {\n            // AMD模式\n            window.define('wangEditor', [\"jquery\"], factory);\n        } else if (window.define.cmd) {\n            // CMD模式\n            window.define(function (require, exports, module) {\n                return factory;\n            });\n        } else {\n            // 全局模式\n            factory(window.jQuery);\n        }\n    } else if (typeof module === \"object\" && typeof module.exports === \"object\") {\n        // commonjs\n\n        // 引用 css —— webapck\n        require('../css/wangEditor.css');\n        module.exports = factory(\n            // 传入 jquery ，支持使用 npm 方式或者自己定义jquery的路径\n            require('jquery')\n        );\n    } else {\n        // 全局模式\n        factory(window.jQuery);\n    }\n})(function($){\n    \n    // 验证是否引用jquery\n    if (!$ || !$.fn || !$.fn.jquery) {\n        alert('在引用wangEditor.js之前，先引用jQuery，否则无法使用 wangEditor');\n        return;\n    }\n\n    // 定义扩展函数\n    var _e = function (fn) {\n        var E = window.wangEditor;\n        if (E) {\n            // 执行传入的函数\n            fn(E, $);\n        }\n    };\n// 定义构造函数\n(function (window, $) {\n    if (window.wangEditor) {\n        // 重复引用\n        alert('一个页面不能重复引用 wangEditor.js 或 wangEditor.min.js ！！！');\n        return;\n    }\n\n    // 编辑器（整体）构造函数\n    var E = function (elem) {\n        // 支持 id 和 element 两种形式\n        if (typeof elem === 'string') {\n            elem = '#' + elem;\n        }\n\n        // ---------------获取基本节点------------------\n        var $elem = $(elem);\n        if ($elem.length !== 1) {\n            return;\n        }\n        var nodeName = $elem[0].nodeName;\n        if (nodeName !== 'TEXTAREA' && nodeName !== 'DIV') {\n            // 只能是 textarea 和 div ，其他类型的元素不行\n            return;   \n        }\n        this.valueNodeName = nodeName.toLowerCase();\n        this.$valueContainer = $elem;\n\n        // 记录 elem 的 prev 和 parent（最后渲染 editor 要用到）\n        this.$prev = $elem.prev();\n        this.$parent = $elem.parent();\n\n        // ------------------初始化------------------\n        this.init();\n    };\n\n    E.fn = E.prototype;\n\n    E.$body = $('body');\n    E.$document = $(document);\n    E.$window = $(window);\n    E.userAgent = navigator.userAgent;\n    E.getComputedStyle = window.getComputedStyle;\n    E.w3cRange = typeof document.createRange === 'function';\n    E.hostname = location.hostname.toLowerCase();\n    E.websiteHost = 'wangeditor.github.io|www.wangeditor.com|wangeditor.coding.me';\n    E.isOnWebsite = E.websiteHost.indexOf(E.hostname) >= 0;\n    E.docsite = 'http://www.kancloud.cn/wangfupeng/wangeditor2/113961';\n\n    // 暴露给全局对象\n    window.wangEditor = E;\n\n    // 注册 plugin 事件，用于用户自定义插件\n    // 用户在引用 wangEditor.js 之后，还可以通过 E.plugin() 注入自定义函数，\n    // 该函数将会在 editor.create() 方法的最后一步执行\n    E.plugin = function (fn) {\n        if (!E._plugins) {\n            E._plugins = [];\n        }\n\n        if (typeof fn === 'function') {\n            E._plugins.push(fn);\n        }\n    };\n\n})(window, $);\n// editor 绑定事件\n_e(function (E, $) {\n\n    E.fn.init = function () {\n\n        // 初始化 editor 默认配置\n        this.initDefaultConfig();\n\n        // 增加container\n        this.addEditorContainer();\n\n        // 增加编辑区域\n        this.addTxt();\n\n        // 增加menuContainer\n        this.addMenuContainer();\n\n        // 初始化菜单集合\n        this.menus = {};\n\n        // 初始化commandHooks\n        this.commandHooks();\n\n    };\n\n});\n// editor api\n_e(function (E, $) {\n\n    // 预定义 ready 事件\n    E.fn.ready = function (fn) {\n\n        if (!this.readyFns) {\n            this.readyFns = [];\n        }\n\n        this.readyFns.push(fn);\n    };\n\n    // 处理ready事件\n    E.fn.readyHeadler = function () {\n        var fns = this.readyFns;\n\n        while (fns.length) {\n            fns.shift().call(this);\n        }\n    };\n\n    // 更新内容到 $valueContainer\n    E.fn.updateValue = function () {\n        var editor = this;\n        var $valueContainer = editor.$valueContainer;\n        var $txt = editor.txt.$txt;\n\n        if ($valueContainer === $txt) {\n            // 传入生成编辑器的div，即是编辑区域\n            return;\n        }\n\n        var value = $txt.html();\n        $valueContainer.val(value);\n    };\n\n    // 获取初始化的内容\n    E.fn.getInitValue = function () {\n        var editor = this;\n        var $valueContainer = editor.$valueContainer;\n        var currentValue = '';\n        var nodeName = editor.valueNodeName;\n        if (nodeName === 'div') {\n            currentValue = $valueContainer.html();\n        } else if (nodeName === 'textarea') {\n            currentValue = $valueContainer.val();\n        }\n\n        return currentValue;\n    };\n\n    // 触发菜单updatestyle\n    E.fn.updateMenuStyle = function () {\n        var menus = this.menus;\n\n        $.each(menus, function (k, menu) {\n            menu.updateSelected();\n        });\n    };\n\n    // 除了传入的 menuIds，其他全部启用\n    E.fn.enableMenusExcept = function (menuIds) {\n        if (this._disabled) {\n            // 编辑器处于禁用状态，则不执行改操作\n            return;\n        }\n        // menuIds参数：支持数组和字符串\n        menuIds = menuIds || [];\n        if (typeof menuIds === 'string') {\n            menuIds = [menuIds];\n        }\n\n        $.each(this.menus, function (k, menu) {\n            if (menuIds.indexOf(k) >= 0) {\n                return;\n            }\n            menu.disabled(false);\n        });\n    };\n\n    // 除了传入的 menuIds，其他全部禁用\n    E.fn.disableMenusExcept = function (menuIds) {\n        if (this._disabled) {\n            // 编辑器处于禁用状态，则不执行改操作\n            return;\n        }\n        // menuIds参数：支持数组和字符串\n        menuIds = menuIds || [];\n        if (typeof menuIds === 'string') {\n            menuIds = [menuIds];\n        }\n\n        $.each(this.menus, function (k, menu) {\n            if (menuIds.indexOf(k) >= 0) {\n                return;\n            }\n            menu.disabled(true);\n        });\n    };\n\n    // 隐藏所有 dropPanel droplist modal\n    E.fn.hideDropPanelAndModal = function () {\n        var menus = this.menus;\n\n        $.each(menus, function (k, menu) {\n            var m = menu.dropPanel || menu.dropList || menu.modal;\n            if (m && m.hide) {\n                m.hide();\n            }\n        });\n    };\n\n});\n// selection range API\n_e(function (E, $) {\n\n    // 用到 w3c range 的函数，如果检测到浏览器不支持 w3c range，则赋值为空函数\n    var ieRange = !E.w3cRange;\n    function emptyFn() {}\n\n    // 设置或读取当前的range\n    E.fn.currentRange = function (cr){\n        if (cr) {\n            this._rangeData = cr;\n        } else {\n            return this._rangeData;\n        }\n    };\n\n    // 将当前选区折叠\n    E.fn.collapseRange = function (range, opt) {\n        // opt 参数说明：'start'-折叠到开始; 'end'-折叠到结束\n        opt = opt || 'end';\n        opt = opt === 'start' ? true : false;\n\n        range = range || this.currentRange();\n        \n        if (range) {\n            // 合并，保存\n            range.collapse(opt);\n            this.currentRange(range);\n        }\n    };\n\n    // 获取选区的文字\n    E.fn.getRangeText = ieRange ? emptyFn : function (range) {\n        range = range || this.currentRange();\n        if (!range) {\n            return;\n        }\n        return range.toString();\n    };\n\n    // 获取选区对应的DOM对象\n    E.fn.getRangeElem = ieRange ? emptyFn : function (range) {\n        range = range || this.currentRange();\n        var dom = range.commonAncestorContainer;\n\n        if (dom.nodeType === 1) {\n            return dom;\n        } else {\n            return dom.parentNode;\n        }\n    };\n\n    // 选区内容是否为空？\n    E.fn.isRangeEmpty = ieRange ? emptyFn : function (range) {\n        range = range || this.currentRange();\n\n        if (range && range.startContainer) {\n            if (range.startContainer === range.endContainer) {\n                if (range.startOffset === range.endOffset) {\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    };\n\n    // 保存选区数据\n    E.fn.saveSelection = ieRange ? emptyFn : function (range) {\n        var self = this,\n            _parentElem,\n            selection,\n            txt = self.txt.$txt.get(0);\n\n        if (range) {\n            _parentElem = range.commonAncestorContainer;\n        } else {\n            selection = document.getSelection();\n            if (selection.getRangeAt && selection.rangeCount) {\n                range = document.getSelection().getRangeAt(0);\n                _parentElem = range.commonAncestorContainer;\n            }\n        }\n        // 确定父元素一定要包含在编辑器区域内\n        if (_parentElem && ($.contains(txt, _parentElem) || txt === _parentElem) ) {\n            // 保存选择区域\n            self.currentRange(range);\n        }\n    };\n\n    // 恢复选中区域\n    E.fn.restoreSelection = ieRange ? emptyFn : function (range) {\n        var selection;\n\n        range = range || this.currentRange();\n\n        if (!range) {\n            return;\n        }\n\n        // 使用 try catch 来防止 IE 某些情况报错\n        try {\n            selection = document.getSelection();\n            selection.removeAllRanges();\n            selection.addRange(range);\n        } catch (ex) {\n            E.error('执行 editor.restoreSelection 时，IE可能会有异常，不影响使用');\n        }\n    };\n\n    // 根据elem恢复选区\n    E.fn.restoreSelectionByElem = ieRange ? emptyFn : function (elem, opt) {\n        // opt参数说明：'start'-折叠到开始，'end'-折叠到结束，'all'-全部选中\n        if (!elem) {\n            return;\n        }\n        opt = opt || 'end'; // 默认为折叠到结束\n\n        // 根据elem获取选区\n        this.setRangeByElem(elem);\n\n        // 根据 opt 折叠选区\n        if (opt === 'start') {\n            this.collapseRange(this.currentRange(), 'start');\n        }\n        if (opt === 'end') {\n            this.collapseRange(this.currentRange(), 'end');\n        }\n        \n        // 恢复选区\n        this.restoreSelection();\n    };\n\n    // 初始化选区\n    E.fn.initSelection = ieRange ? emptyFn : function () {\n        var editor = this;\n        if( editor.currentRange() ){\n            //如果currentRange有值，则不用再初始化\n            return;\n        }\n\n        var range;\n        var $txt = editor.txt.$txt;\n        var $firstChild = $txt.children().first();\n        \n        if ($firstChild.length) {\n            editor.restoreSelectionByElem($firstChild.get(0));\n        }\n    };\n\n    // 根据元素创建选区\n    E.fn.setRangeByElem = ieRange ? emptyFn : function (elem) {\n        var editor = this;\n        var txtElem = editor.txt.$txt.get(0);\n        if (!elem || !$.contains(txtElem, elem)) {\n            return;\n        }\n\n        // 找到elem的第一个 textNode 和 最后一个 textNode\n        var firstTextNode = elem.firstChild;\n        while (firstTextNode) {\n            if (firstTextNode.nodeType === 3) {\n                break;\n            }\n            // 继续向下\n            firstTextNode = firstTextNode.firstChild;\n        }\n        var lastTextNode = elem.lastChild;\n        while (lastTextNode) {\n            if (lastTextNode.nodeType === 3) {\n                break;\n            }\n            // 继续向下\n            lastTextNode = lastTextNode.lastChild;\n        }\n        \n        var range = document.createRange();\n        if (firstTextNode && lastTextNode) {\n            // 说明 elem 有内容，能取到子元素\n            range.setStart(firstTextNode, 0);\n            range.setEnd(lastTextNode, lastTextNode.textContent.length);\n        } else {\n            // 说明 elem 无内容\n            range.setStart(elem, 0);\n            range.setEnd(elem, 0);\n        }\n\n        // 保存选区\n        editor.saveSelection(range);\n    };\n\n});\n// selection range API - IE8及以下\n_e(function (E, $) {\n\n    if (E.w3cRange) {\n        // 说明支持 W3C 的range方法\n        return;\n    }\n\n    // -----------------IE8时，需要重写以下方法-------------------\n\n    // 获取选区的文字\n    E.fn.getRangeText = function (range) {\n        range = range || this.currentRange();\n        if (!range) {\n            return;\n        }\n        return range.text;\n    };\n\n    // 获取选区对应的DOM对象\n    E.fn.getRangeElem = function (range) {\n        range = range || this.currentRange();\n        if (!range) {\n            return;\n        }\n        var dom = range.parentElement();\n\n        if (dom.nodeType === 1) {\n            return dom;\n        } else {\n            return dom.parentNode;\n        }\n    };\n\n    // 选区内容是否为空？\n    E.fn.isRangeEmpty = function (range) {\n        range = range || this.currentRange();\n\n        if (range && range.text) {\n            return false;\n        }\n\n        return true;\n    };\n\n    // 保存选区数据\n    E.fn.saveSelection = function (range) {\n        var self = this,\n            _parentElem,\n            selection,\n            txt = self.txt.$txt.get(0);\n\n        if (range) {\n            _parentElem = range.parentElement();\n        } else {\n            range = document.selection.createRange();\n            if(typeof range.parentElement === 'undefined'){\n                //IE6、7中，insertImage后会执行此处\n                //由于找不到range.parentElement，所以干脆将_parentElem赋值为null\n                _parentElem = null;\n            }else{\n                _parentElem = range.parentElement();\n            }\n        }\n\n        // 确定父元素一定要包含在编辑器区域内\n        if (_parentElem && ($.contains(txt, _parentElem) || txt === _parentElem) ) {\n            // 保存选择区域\n            self.currentRange(range);\n        }\n    };\n\n    // 恢复选中区域\n    E.fn.restoreSelection = function (currentRange){\n        var editor = this,\n            selection,\n            range;\n\n        currentRange = currentRange || editor.currentRange();\n        if(!currentRange){\n            return;\n        }\n\n        range = document.selection.createRange();\n        try {\n            // 此处，plupload上传上传图片时，IE8-会报一个『参数无效』的错误\n            range.setEndPoint('EndToEnd', currentRange);\n        } catch (ex) {\n\n        }\n        \n        if(currentRange.text.length === 0){\n            try {\n                // IE8 插入表情会报错\n                range.collapse(false);\n            } catch (ex) {\n                \n            }\n            \n        }else{\n            range.setEndPoint('StartToStart', currentRange);\n        }\n        range.select();\n    };\n\n});\n// editor command hooks\n_e(function (E, $) {\n    \n    E.fn.commandHooks = function () {\n        var editor = this;\n        var commandHooks = {};\n        \n        // insertHtml\n        commandHooks.insertHtml = function (html) {\n            var $elem = $(html);\n            var rangeElem = editor.getRangeElem();\n            var targetElem;\n            \n            targetElem = editor.getLegalTags(rangeElem);\n            if (!targetElem) {\n                return;\n            }\n\n            $(targetElem).after($elem);\n        };\n\n        // 保存到对象\n        editor.commandHooks = commandHooks;\n    };\n\n});\n// editor command API\n_e(function (E, $) {\n\n    // 基本命令\n    E.fn.command = function (e, commandName, commandValue, callback) {\n        var editor = this;\n        var hooks;\n        \n        function commandFn() {\n            if (!commandName) {\n                return;\n            }\n            if (editor.queryCommandSupported(commandName)) {\n                // 默认命令\n                document.execCommand(commandName, false, commandValue);\n            } else {\n                // hooks 命令\n                hooks = editor.commandHooks;\n                if (commandName in hooks) {\n                    hooks[commandName](commandValue);\n                }\n            }\n        }\n\n        this.customCommand(e, commandFn, callback);\n    };\n\n    // 针对一个elem对象执行基础命令\n    E.fn.commandForElem = function (elemOpt, e, commandName, commandValue, callback) {\n        // 取得查询elem的查询条件和验证函数\n        var selector;\n        var check;\n        if (typeof elemOpt === 'string') {\n            selector = elemOpt;\n        } else {\n            selector = elemOpt.selector;\n            check = elemOpt.check;\n        }\n\n        // 查询elem\n        var rangeElem = this.getRangeElem();\n        rangeElem = this.getSelfOrParentByName(rangeElem, selector, check);\n\n        // 根据elem设置range\n        if (rangeElem) {\n            this.setRangeByElem(rangeElem);\n        }\n\n        // 然后执行基础命令\n        this.command(e, commandName, commandValue, callback);\n    };\n\n    // 自定义命令\n    E.fn.customCommand = function (e, commandFn, callback) {\n        var editor = this;\n        var range = editor.currentRange();\n\n        if (!range) {\n            // 目前没有选区，则无法执行命令\n            e && e.preventDefault();\n            return;\n        }\n        // 记录内容，以便撤销（执行命令之前就要记录）\n        editor.undoRecord();\n\n        // 恢复选区（有 range 参数）\n        this.restoreSelection(range);\n\n        // 执行命令事件\n        commandFn.call(editor);\n\n        // 保存选区（无参数，要从浏览器直接获取range信息）\n        this.saveSelection();\n        // 重新恢复选区（无参数，要取得刚刚从浏览器得到的range信息）\n        this.restoreSelection();\n\n        // 执行 callback\n        if (callback && typeof callback === 'function') {\n            callback.call(editor);\n        }\n\n        // 最后插入空行\n        editor.txt.insertEmptyP();\n\n        // 包裹暴露的img和text\n        editor.txt.wrapImgAndText();\n\n        // 更新内容\n        editor.updateValue();\n\n        // 更新菜单样式\n        editor.updateMenuStyle();\n\n        // 隐藏 dropPanel dropList modal  设置 200ms 间隔\n        function hidePanelAndModal() {\n            editor.hideDropPanelAndModal();\n        } \n        setTimeout(hidePanelAndModal, 200);\n\n        if (e) {\n            e.preventDefault();\n        }\n    };\n\n    // 封装 document.queryCommandValue 函数\n    // IE8 直接执行偶尔会报错，因此直接用 try catch 封装一下\n    E.fn.queryCommandValue = function (commandName) {\n        var result = '';\n        try {\n            result = document.queryCommandValue(commandName);\n        } catch (ex) {\n\n        }\n        return result;\n    };\n\n    // 封装 document.queryCommandState 函数\n    // IE8 直接执行偶尔会报错，因此直接用 try catch 封装一下\n    E.fn.queryCommandState = function (commandName) {\n        var result = false;\n        try {\n            result = document.queryCommandState(commandName);\n        } catch (ex) {\n\n        }\n        return result;\n    };\n\n    // 封装 document.queryCommandSupported 函数\n    E.fn.queryCommandSupported = function (commandName) {\n        var result = false;\n        try {\n            result = document.queryCommandSupported(commandName);\n        } catch (ex) {\n\n        }\n        return result;\n    };\n\n});\n// dom selector\n_e(function (E, $) {\n\n    var matchesSelector;\n\n    // matchesSelector hook\n    function _matchesSelectorForIE(selector) {\n        var elem = this;\n        var $elems = $(selector);\n        var result = false;\n\n        // 用jquery查找 selector 所有对象，如果其中有一个和传入 elem 相同，则证明 elem 符合 selector\n        $elems.each(function () {\n            if (this === elem) {\n                result = true;\n                return false;\n            }\n        });\n\n        return result;\n    }\n\n    // 从当前的elem，往上去查找合法标签 如 p head table blockquote ul ol 等\n    E.fn.getLegalTags = function (elem) {\n        var legalTags = this.config.legalTags;\n        if (!legalTags) {\n            E.error('配置项中缺少 legalTags 的配置');\n            return;\n        }\n        return this.getSelfOrParentByName(elem, legalTags);\n    };\n\n    // 根据条件，查询自身或者父元素，符合即返回\n    E.fn.getSelfOrParentByName = function (elem, selector, check) {\n\n        if (!elem || !selector) {\n            return;\n        }\n\n        if (!matchesSelector) {\n            // 定义 matchesSelector 函数\n            matchesSelector = elem.webkitMatchesSelector || \n                              elem.mozMatchesSelector ||\n                              elem.oMatchesSelector || \n                              elem.matchesSelector;\n        }\n        if (!matchesSelector) {\n            // 如果浏览器本身不支持 matchesSelector 则使用自定义的hook\n            matchesSelector = _matchesSelectorForIE;\n        }\n\n        var txt = this.txt.$txt.get(0);\n\n        while (elem && txt !== elem && $.contains(txt, elem)) {\n            if (matchesSelector.call(elem, selector)) {\n                // 符合 selector 查询条件\n\n                if (!check) {\n                    // 没有 check 验证函数，直接返回即可\n                    return elem;\n                }\n\n                if (check(elem)) {\n                    // 如果有 check 验证函数，还需 check 函数的确认\n                    return elem;\n                }\n            }\n\n            // 如果上一步没经过验证，则将跳转到父元素\n            elem = elem.parentNode;\n        }\n\n        return;\n    };\n\n});\n// undo redo\n_e(function (E, $) {\n\n    var length = 20;  // 缓存的最大长度\n    function _getRedoList(editor) {\n        if (editor._redoList == null) {\n            editor._redoList = [];\n        }\n        return editor._redoList;\n    }\n    function _getUndoList(editor) {\n        if (editor._undoList == null) {\n            editor._undoList = [];\n        }\n        return editor._undoList;\n    }\n\n    // 数据处理\n    function _handle(editor, data, type) {\n        // var range = data.range;\n        // var range2 = range.cloneRange && range.cloneRange();\n        var val = data.val;\n        var html = editor.txt.$txt.html();\n\n        if(val == null) {\n            return;\n        }\n\n        if (val === html) {\n            if (type === 'redo') { \n                editor.redo();\n                return;\n            } else if (type === 'undo') {\n                editor.undo();\n                return;\n            } else {\n                return;\n            }\n        }\n\n        // 保存数据\n        editor.txt.$txt.html(val);\n        // 更新数据到textarea（有必要的话）\n        editor.updateValue();\n\n        // onchange 事件\n        if (editor.onchange && typeof editor.onchange === 'function') {\n            editor.onchange.call(editor);\n        }\n\n        // ?????\n        // 注释：$txt 被重新赋值之后，range会被重置，cloneRange() 也不好使\n        // // 重置选区\n        // if (range2) {\n        //     editor.restoreSelection(range2);\n        // }\n    }\n\n    // 记录\n    E.fn.undoRecord = function () {\n        var editor = this;\n        var $txt = editor.txt.$txt;\n        var val = $txt.html();\n        var undoList = _getUndoList(editor);\n        var redoList = _getRedoList(editor);\n        var currentVal = undoList.length ? undoList[0] : '';\n\n        if (val === currentVal.val) {\n            return;\n        }\n\n        // 清空 redolist\n        if (redoList.length) {\n            redoList = [];\n        }\n\n        // 添加数据到 undoList\n        undoList.unshift({\n            range: editor.currentRange(),  // 将当前的range也记录下\n            val: val\n        });\n\n        // 限制 undoList 长度\n        if (undoList.length > length) {\n            undoList.pop();\n        }\n    };\n\n    // undo 操作\n    E.fn.undo = function () {\n        var editor = this;\n        var undoList = _getUndoList(editor);\n        var redoList = _getRedoList(editor);\n\n        if (!undoList.length) {\n            return;\n        }\n\n        // 取出 undolist 第一个值，加入 redolist\n        var data = undoList.shift();\n        redoList.unshift(data);\n\n        // 并修改编辑器的内容\n        _handle(this, data, 'undo');\n    };\n\n    // redo 操作\n    E.fn.redo = function () {\n        var editor = this;\n        var undoList = _getUndoList(editor);\n        var redoList = _getRedoList(editor);\n        if (!redoList.length) {\n            return;\n        }\n\n        // 取出 redolist 第一个值，加入 undolist\n        var data = redoList.shift();\n        undoList.unshift(data);\n\n        // 并修改编辑器的内容\n        _handle(this, data, 'redo');\n    };\n});\n// 暴露给用户的 API\n_e(function (E, $) {\n\n    // 创建编辑器\n    E.fn.create = function () {\n        var editor = this;\n\n        // 检查 E.$body 是否有值\n        // 如果在 body 之前引用了 js 文件，body 尚未加载，可能没有值\n        if (!E.$body || E.$body.length === 0) {\n            E.$body = $('body');\n            E.$document = $(document);\n            E.$window = $(window);\n        }\n\n        // 执行 addMenus 之前：\n        // 1. 允许用户修改 editor.UI 自定义配置UI\n        // 2. 允许用户通过修改 editor.menus 来自定义配置菜单\n        // 因此要在 create 时执行，而不是 init           \n        editor.addMenus();\n\n        // 渲染\n        editor.renderMenus();\n        editor.renderMenuContainer();\n        editor.renderTxt();\n        editor.renderEditorContainer();\n\n        // 绑定事件\n        editor.eventMenus();\n        editor.eventMenuContainer();\n        editor.eventTxt();\n\n        // 处理ready事件\n        editor.readyHeadler();\n\n        // 初始化选区\n        editor.initSelection();\n\n        // $txt 快捷方式\n        editor.$txt = editor.txt.$txt;\n\n        // 执行用户自定义事件，通过 E.ready() 添加\n        var _plugins = E._plugins;\n        if (_plugins && _plugins.length) {\n            $.each(_plugins, function (k, val) {\n                val.call(editor);\n            });\n        }\n    };\n\n    // 禁用编辑器\n    E.fn.disable = function () {\n        this.txt.$txt.removeAttr('contenteditable');\n        this.disableMenusExcept();\n\n        // 先禁用，再记录状态\n        this._disabled = true;\n    };\n    // 启用编辑器\n    E.fn.enable = function () {\n        // 先解除状态记录，再启用\n        this._disabled = false;\n        this.txt.$txt.attr('contenteditable', 'true');\n        this.enableMenusExcept();\n    };\n\n    // 销毁编辑器\n    E.fn.destroy = function () {\n        var self = this;\n        var $valueContainer = self.$valueContainer;\n        var $editorContainer = self.$editorContainer;\n        var valueNodeName = self.valueNodeName;\n\n        if (valueNodeName === 'div') {\n            // div 生成的编辑器\n            $valueContainer.removeAttr('contenteditable');\n            $editorContainer.after($valueContainer);\n            $editorContainer.hide();\n        } else {\n            // textarea 生成的编辑器\n            $valueContainer.show();\n            $editorContainer.hide();\n        }\n    };\n\n    // 撤销 销毁编辑器\n    E.fn.undestroy = function () {\n        var self = this;\n        var $valueContainer = self.$valueContainer;\n        var $editorContainer = self.$editorContainer;\n        var $menuContainer = self.menuContainer.$menuContainer;\n        var valueNodeName = self.valueNodeName;\n\n        if (valueNodeName === 'div') {\n            // div 生成的编辑器\n            $valueContainer.attr('contenteditable', 'true');\n            $menuContainer.after($valueContainer);\n            $editorContainer.show();\n        } else {\n            // textarea 生成的编辑器\n            $valueContainer.hide();\n            $editorContainer.show();\n        }\n    };\n\n    // 清空内容的快捷方式\n    E.fn.clear = function () {\n        var editor = this;\n        var $txt = editor.txt.$txt;\n        $txt.html('<p><br></p>');\n        editor.restoreSelectionByElem($txt.find('p').get(0));\n    };\n\n});\n// menuContainer 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var MenuContainer = function (editor) {\n        this.editor = editor;\n        this.init();\n    };\n\n    MenuContainer.fn = MenuContainer.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.MenuContainer = MenuContainer;\n\n});\n// MenuContainer.fn bind fn\n_e(function (E, $) {\n\n    var MenuContainer = E.MenuContainer;\n\n    // 初始化\n    MenuContainer.fn.init = function () {\n        var self = this;\n        var $menuContainer = $('<div class=\"wangEditor-menu-container clearfix\"></div>');\n\n        self.$menuContainer = $menuContainer;\n\n        // change shadow\n        self.changeShadow();\n    };\n\n    // 编辑区域滚动时，增加shadow\n    MenuContainer.fn.changeShadow = function () {\n        var $menuContainer = this.$menuContainer;\n        var editor = this.editor;\n        var $txt = editor.txt.$txt;\n\n        $txt.on('scroll', function () {\n            if ($txt.scrollTop() > 10) {\n                $menuContainer.addClass('wangEditor-menu-shadow');\n            } else {\n                $menuContainer.removeClass('wangEditor-menu-shadow');\n            }\n        });\n    };\n\n});\n// MenuContainer.fn API\n_e(function (E, $) {\n\n    var MenuContainer = E.MenuContainer;\n\n    MenuContainer.fn.render = function () {\n        var $menuContainer = this.$menuContainer;\n        var $editorContainer = this.editor.$editorContainer;\n\n        $editorContainer.append($menuContainer);\n    };\n    \n    // 获取菜单栏的高度\n    MenuContainer.fn.height = function () {\n        var $menuContainer = this.$menuContainer;\n        return $menuContainer.height();\n    };\n\n    // 添加菜单\n    MenuContainer.fn.appendMenu = function (groupIdx, menu) {\n        // 判断是否需要新增一个菜单组\n        this._addGroup(groupIdx);\n        // 增加菜单（返回 $menuItem）\n        return this._addOneMenu(menu);\n    };\n    MenuContainer.fn._addGroup = function (groupIdx) {\n        var $menuContainer = this.$menuContainer;\n        var $menuGroup;\n        if (!this.$currentGroup || this.currentGroupIdx !== groupIdx) {\n            $menuGroup = $('<div class=\"menu-group clearfix\"></div>');\n            $menuContainer.append($menuGroup);\n\n            this.$currentGroup = $menuGroup;\n            this.currentGroupIdx = groupIdx;\n        }\n    };\n    MenuContainer.fn._addOneMenu = function (menu) {\n        var $menuNormal = menu.$domNormal;\n        var $menuSelected = menu.$domSelected;\n\n        var $menuGroup = this.$currentGroup;\n        var $item = $('<div class=\"menu-item clearfix\"></div>');\n        $menuSelected.hide();\n        $item.append($menuNormal).append($menuSelected);\n        $menuGroup.append($item);\n\n        return $item;\n    };\n\n});\n// menu 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var Menu = function (opt) {\n        this.editor = opt.editor;\n        this.id = opt.id;\n        this.title = opt.title;\n        this.$domNormal = opt.$domNormal;\n        this.$domSelected = opt.$domSelected || opt.$domNormal;\n\n        // document.execCommand 的参数\n        this.commandName = opt.commandName;\n        this.commandValue = opt.commandValue;\n        this.commandNameSelected = opt.commandNameSelected || opt.commandName;\n        this.commandValueSelected = opt.commandValueSelected || opt.commandValue;\n    };\n\n    Menu.fn = Menu.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.Menu = Menu;\n});\n// Menu.fn 初始化绑定的事件\n_e(function (E, $) {\n\n    var Menu = E.Menu;\n\n    // 初始化UI\n    Menu.fn.initUI = function () {\n        var editor = this.editor;\n        var uiConfig = editor.UI.menus;\n        var menuId = this.id;\n        var menuUI = uiConfig[menuId];\n\n        if (this.$domNormal && this.$domSelected) {\n            // 自定义的菜单中，已经传入了 $dom 无需从配置文件中查找生成\n            return;\n        }\n\n        if (menuUI == null) {\n            E.warn('editor.UI配置中，没有菜单 \"' + menuId + '\" 的UI配置，只能取默认值');\n            \n            // 必须写成 uiConfig['default'];\n            // 写成 uiConfig.default IE8会报错\n            menuUI = uiConfig['default'];\n        }\n\n        // 正常状态\n        this.$domNormal = $(menuUI.normal);\n\n        // 选中状态\n        if (/^\\./.test(menuUI.selected)) {\n            // 增加一个样式\n            this.$domSelected = this.$domNormal.clone().addClass(menuUI.selected.slice(1));\n        } else {\n            // 一个新的dom对象\n            this.$domSelected = $(menuUI.selected);\n        }\n    };\n\n});\n// Menu.fn API\n_e(function (E, $) {\n\n    var Menu = E.Menu;\n\n    // 渲染菜单\n    Menu.fn.render = function (groupIdx) {\n        // 渲染UI\n        this.initUI();\n        \n        var editor = this.editor;\n        var menuContainer = editor.menuContainer;\n        var $menuItem = menuContainer.appendMenu(groupIdx, this);\n        var onRender = this.onRender;\n\n        // 渲染tip\n        this._renderTip($menuItem);\n\n        // 执行 onRender 函数\n        if (onRender && typeof onRender === 'function') {\n            onRender.call(this);\n        }\n    };\n    Menu.fn._renderTip = function ($menuItem) {\n        var self = this;\n        var editor = self.editor;\n        var title = self.title;\n        var $tip = $('<div class=\"menu-tip\"></div>');\n        // var $triangle = $('<i class=\"tip-triangle\"></i>'); // 小三角\n\n        // 计算 tip 宽度\n        var $tempDiv;\n        if (!self.tipWidth) {\n            // 设置一个纯透明的 p（absolute;top:-10000px;不会显示在内容区域）\n            // 内容赋值为 title ，为了计算tip宽度\n            $tempDiv = $('<p style=\"opacity:0; filter:Alpha(opacity=0); position:absolute;top:-10000px;\">' + title + '</p>');\n            // 先添加到body，计算完再 remove\n            E.$body.append($tempDiv);\n            editor.ready(function () {\n                var editor = this;\n                var titleWidth = $tempDiv.outerWidth() + 5; // 多出 5px 的冗余\n                var currentWidth = $tip.outerWidth();\n                var currentMarginLeft = parseFloat($tip.css('margin-left'), 10);\n                // 计算完，拿到数据，则弃用\n                $tempDiv.remove();\n                $tempDiv = null;\n\n                // 重新设置样式\n                $tip.css({\n                    width: titleWidth,\n                    'margin-left': currentMarginLeft + (currentWidth - titleWidth)/2\n                });\n\n                // 存储\n                self.tipWidth = titleWidth;\n            });\n        }\n\n        // $tip.append($triangle);\n        $tip.append(title);\n        $menuItem.append($tip);\n\n        function show() {\n            $tip.show();\n        }\n        function hide() {\n            $tip.hide();\n        }\n\n        var timeoutId;\n        $menuItem.find('a').on('mouseenter', function (e) {\n            if (!self.active() && !self.disabled()) {\n                timeoutId = setTimeout(show, 200);\n            }\n        }).on('mouseleave', function (e) {\n            timeoutId && clearTimeout(timeoutId);\n            hide();\n        }).on('click', hide);\n    };\n\n    // 绑定事件\n    Menu.fn.bindEvent = function () {\n        var self = this;\n\n        var $domNormal = self.$domNormal;\n        var $domSelected = self.$domSelected;\n\n        // 试图获取该菜单定义的事件（未selected），没有则自己定义\n        var clickEvent = self.clickEvent;\n        if (!clickEvent) {\n            clickEvent = function (e) {\n                // -----------dropPanel dropList modal-----------\n                var dropObj = self.dropPanel || self.dropList || self.modal;\n                if (dropObj && dropObj.show) {\n                    if (dropObj.isShowing) {\n                        dropObj.hide();\n                    } else {\n                        dropObj.show();\n                    }\n                    return;\n                }\n\n                // -----------command-----------\n                var editor = self.editor;\n                var commandName;\n                var commandValue;\n\n                var selected = self.selected;\n                if (selected) {\n                    commandName = self.commandNameSelected;\n                    commandValue = self.commandValueSelected;\n                } else {\n                    commandName = self.commandName;\n                    commandValue = self.commandValue;\n                }\n\n                if (commandName) {\n                    // 执行命令\n                    editor.command(e, commandName, commandValue);\n                } else {\n                    // 提示\n                    E.warn('菜单 \"' + self.id + '\" 未定义click事件');\n                    e.preventDefault();\n                }\n            };\n        }\n        // 获取菜单定义的selected情况下的点击事件\n        var clickEventSelected = self.clickEventSelected || clickEvent;\n\n        // 将事件绑定到菜单dom上\n        $domNormal.click(function (e) {\n            if (!self.disabled()) {\n                clickEvent.call(self, e);\n                self.updateSelected();\n            }\n            e.preventDefault();\n        });\n        $domSelected.click(function (e) {\n            if (!self.disabled()) {\n                clickEventSelected.call(self, e);\n                self.updateSelected();\n            }\n            e.preventDefault();\n        });\n    };\n\n    // 更新选中状态\n    Menu.fn.updateSelected = function () {\n        var self = this;\n        var editor = self.editor;\n\n        // 试图获取用户自定义的判断事件\n        var updateSelectedEvent = self.updateSelectedEvent;\n        if (!updateSelectedEvent) {\n            // 用户未自定义，则设置默认值\n            updateSelectedEvent = function () {\n                var self = this;\n                var editor = self.editor;\n                var commandName = self.commandName;\n                var commandValue = self.commandValue;\n\n                if (commandValue) {\n                    if (editor.queryCommandValue(commandName).toLowerCase() === commandValue.toLowerCase()) {\n                        return true;\n                    }\n                } else if (editor.queryCommandState(commandName)) {\n                    return true;\n                }\n\n                return false;\n            };\n        }\n\n        // 获取结果\n        var result = updateSelectedEvent.call(self);\n        result = !!result;\n\n        // 存储结果、显示效果\n        self.changeSelectedState(result);\n    };\n\n    // 切换选中状态、显示效果\n    Menu.fn.changeSelectedState = function (state) {\n        var self = this;\n        var selected = self.selected;\n\n        if (state != null && typeof state === 'boolean') {\n            if (selected === state) {\n                // 计算结果和当前的状态一样\n                return;\n            }\n            // 存储结果\n            self.selected = state;\n\n            // 切换菜单的显示\n            if (state) {\n                // 选中\n                self.$domNormal.hide();\n                self.$domSelected.show();\n            } else {\n                // 未选中\n                self.$domNormal.show();\n                self.$domSelected.hide();\n            }\n        } // if\n    };\n\n    // 点击菜单，显示了 dropPanel modal 时，菜单的状态 \n    Menu.fn.active = function (active) {\n        if (active == null) {\n            return this._activeState;\n        }\n        this._activeState = active;\n    };\n    Menu.fn.activeStyle = function (active) {\n        var selected = this.selected;\n        var $dom = this.$domNormal;\n        var $domSelected = this.$domSelected;\n\n        if (active) {\n            $dom.addClass('active');\n            $domSelected.addClass('active');\n        } else {\n            $dom.removeClass('active');\n            $domSelected.removeClass('active');\n        }\n\n        // 记录状态 （ menu hover 时会取状态用 ）\n        this.active(active);\n    };\n\n    // 菜单的启用和禁用\n    Menu.fn.disabled = function (opt) {\n        // 参数为空，取值\n        if (opt == null) {\n            return !!this._disabled;\n        }\n\n        if (this._disabled === opt) {\n            // 要设置的参数值和当前参数只一样，无需再次设置\n            return;\n        }\n\n        var $dom = this.$domNormal;\n        var $domSelected = this.$domSelected;\n\n        // 设置样式\n        if (opt) {\n            $dom.addClass('disable');\n            $domSelected.addClass('disable');\n        } else {\n            $dom.removeClass('disable');\n            $domSelected.removeClass('disable');\n        }\n\n        // 存储\n        this._disabled = opt;\n    };\n\n});\n// dropList 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var DropList = function (editor, menu, opt) {\n        this.editor = editor;\n        this.menu = menu;\n\n        // list 的数据源，格式 {'commandValue': 'title', ...}\n        this.data = opt.data;\n        // 要为每个item自定义的模板\n        this.tpl = opt.tpl;\n        // 为了执行 editor.commandForElem 而传入的elem查询方式\n        this.selectorForELemCommand = opt.selectorForELemCommand;\n\n        // 执行事件前后的钩子\n        this.beforeEvent = opt.beforeEvent;\n        this.afterEvent = opt.afterEvent;\n\n        // 初始化\n        this.init();\n    };\n\n    DropList.fn = DropList.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.DropList = DropList;\n});\n// dropList fn bind\n_e(function (E, $) {\n\n    var DropList = E.DropList;\n\n    // init\n    DropList.fn.init = function () {\n        var self = this;\n\n        // 生成dom对象\n        self.initDOM();\n\n        // 绑定command事件\n        self.bindEvent();\n\n        // 声明隐藏的事件\n        self.initHideEvent();\n    };\n\n    // 初始化dom结构\n    DropList.fn.initDOM = function () {\n        var self = this;\n        var data = self.data;\n        var tpl = self.tpl || '<span>{#title}</span>';\n        var $list = $('<div class=\"wangEditor-drop-list clearfix\"></div>');\n\n        var itemContent;\n        var $item;\n        $.each(data, function (commandValue, title) {\n            itemContent = tpl.replace(/{#commandValue}/ig, commandValue).replace(/{#title}/ig, title);\n            $item = $('<a href=\"#\" commandValue=\"' + commandValue + '\"></a>');\n            $item.append(itemContent);\n            $list.append($item);\n        });\n\n        self.$list = $list;\n    };\n\n    // 绑定事件\n    DropList.fn.bindEvent = function () {\n        var self = this;\n        var editor = self.editor;\n        var menu = self.menu;\n        var commandName = menu.commandName;\n        var selectorForELemCommand = self.selectorForELemCommand;\n        var $list = self.$list;\n\n        // 执行事件前后的钩子函数\n        var beforeEvent = self.beforeEvent;\n        var afterEvent = self.afterEvent;\n\n        $list.on('click', 'a[commandValue]', function (e) {\n            // 正式命令执行之前\n            if (beforeEvent && typeof beforeEvent === 'function') {\n                beforeEvent.call(e);\n            }\n\n            // 执行命令\n            var commandValue = $(e.currentTarget).attr('commandValue');\n            if (menu.selected && editor.isRangeEmpty() && selectorForELemCommand) {\n                // 当前处于选中状态，并且选中内容为空\n                editor.commandForElem(selectorForELemCommand, e, commandName, commandValue);\n            } else {\n                // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                editor.command(e, commandName, commandValue);\n            }\n\n            // 正式命令之后的钩子\n            if (afterEvent && typeof afterEvent === 'function') {\n                afterEvent.call(e);\n            }\n        });\n    };\n\n    // 点击其他地方，立即隐藏 droplist\n    DropList.fn.initHideEvent = function () {\n        var self = this;\n\n        // 获取 list elem\n        var thisList = self.$list.get(0);\n\n        E.$body.on('click', function (e) {\n            if (!self.isShowing) {\n                return;\n            }\n            var trigger = e.target;\n\n            // 获取菜单elem\n            var menu = self.menu;\n            var menuDom;\n            if (menu.selected) {\n                menuDom = menu.$domSelected.get(0);\n            } else {\n                menuDom = menu.$domNormal.get(0);\n            }\n\n            if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                // 说明由本菜单点击触发的\n                return;\n            }\n\n            if (thisList === trigger || $.contains(thisList, trigger)) {\n                // 说明由本list点击触发的\n                return;\n            }\n\n            // 其他情况，隐藏 list\n            self.hide();\n        });\n\n        E.$window.scroll(function () {\n            self.hide();\n        });\n\n        E.$window.on('resize', function () {\n            self.hide();\n        });\n    };\n\n});\n// dropListfn api\n_e(function (E, $) {\n    \n    var DropList = E.DropList;\n\n    // 渲染\n    DropList.fn._render = function () {\n        var self = this;\n        var editor = self.editor;\n        var $list = self.$list;\n\n        // 渲染到页面\n        editor.$editorContainer.append($list);\n\n        // 记录状态\n        self.rendered = true;\n    };\n\n    // 定位\n    DropList.fn._position = function () {\n        var self = this;\n        var $list = self.$list;\n        var editor = self.editor;\n        var menu = self.menu;\n        var $menuContainer = editor.menuContainer.$menuContainer;\n        var $menuDom = menu.selected ? menu.$domSelected : menu.$domNormal;\n        // 注意这里的 offsetParent() 要返回 .menu-item 的 position\n        // 因为 .menu-item 是 position:relative\n        var menuPosition = $menuDom.offsetParent().position();\n\n        // 取得 menu 的位置、尺寸属性\n        var menuTop = menuPosition.top;\n        var menuLeft = menuPosition.left;\n        var menuHeight = $menuDom.offsetParent().height();\n        var menuWidth = $menuDom.offsetParent().width();\n\n        // 取得 list 的尺寸属性\n        var listWidth = $list.outerWidth();\n        // var listHeight = $list.outerHeight();\n\n        // 取得 $txt 的尺寸\n        var txtWidth = editor.txt.$txt.outerWidth();\n\n        // ------------开始计算-------------\n\n        // 初步计算 list 位置属性\n        var top = menuTop + menuHeight;\n        var left = menuLeft + menuWidth/2;\n        var marginLeft = 0 - menuWidth/2;\n\n        // 如果超出了有边界，则要左移（且和右侧有间隙）\n        var valWithTxt = (left + listWidth) - txtWidth;\n        if (valWithTxt > -10) {\n            marginLeft = marginLeft - valWithTxt - 10;\n        }\n        // 设置样式\n        $list.css({\n            top: top,\n            left: left,\n            'margin-left': marginLeft\n        });\n\n        // 如果因为向下滚动而导致菜单fixed，则再加一步处理\n        if (editor._isMenufixed) {\n            top = top + (($menuContainer.offset().top + $menuContainer.outerHeight()) - $list.offset().top);\n\n            // 重新设置top\n            $list.css({\n                top: top\n            });\n        }\n    };\n\n    // 显示\n    DropList.fn.show = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.rendered) {\n            // 第一次show之前，先渲染\n            self._render();\n        }\n\n        if (self.isShowing) {\n            return;\n        }\n\n        var $list = self.$list;\n        $list.show();\n\n        // 定位\n        self._position();\n\n        // 记录状态\n        self.isShowing = true;\n\n        // 菜单状态\n        menu.activeStyle(true);\n    };\n\n    // 隐藏\n    DropList.fn.hide = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.isShowing) {\n            return;\n        }\n\n        var $list = self.$list;\n        $list.hide();\n\n        // 记录状态\n        self.isShowing = false;\n\n        // 菜单状态\n        menu.activeStyle(false);\n    };\n});\n// dropPanel 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var DropPanel = function (editor, menu, opt) {\n        this.editor = editor;\n        this.menu = menu;\n        this.$content = opt.$content;\n        this.width = opt.width || 200;\n        this.height = opt.height;\n        this.onRender = opt.onRender;\n\n        // init\n        this.init();\n    };\n\n    DropPanel.fn = DropPanel.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.DropPanel = DropPanel;\n});\n// dropPanel fn bind\n_e(function (E, $) {\n\n    var DropPanel = E.DropPanel;\n\n    // init\n    DropPanel.fn.init = function () {\n        var self = this;\n\n        // 生成dom对象\n        self.initDOM();\n\n        // 声明隐藏的事件\n        self.initHideEvent();\n    };\n\n    // init DOM\n    DropPanel.fn.initDOM = function () {\n        var self = this;\n        var $content = self.$content;\n        var width = self.width;\n        var height = self.height;\n        var $panel = $('<div class=\"wangEditor-drop-panel clearfix\"></div>');\n        var $triangle = $('<div class=\"tip-triangle\"></div>');\n\n        $panel.css({\n            width: width,\n            height: height ? height : 'auto'\n        });\n        $panel.append($triangle);\n        $panel.append($content);\n\n        // 添加对象数据\n        self.$panel = $panel;\n        self.$triangle = $triangle;\n    };\n\n    // 点击其他地方，立即隐藏 dropPanel\n    DropPanel.fn.initHideEvent = function () {\n        var self = this;\n\n        // 获取 panel elem\n        var thisPanle = self.$panel.get(0);\n\n        E.$body.on('click', function (e) {\n            if (!self.isShowing) {\n                return;\n            }\n            var trigger = e.target;\n\n            // 获取菜单elem\n            var menu = self.menu;\n            var menuDom;\n            if (menu.selected) {\n                menuDom = menu.$domSelected.get(0);\n            } else {\n                menuDom = menu.$domNormal.get(0);\n            }\n\n            if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                // 说明由本菜单点击触发的\n                return;\n            }\n\n            if (thisPanle === trigger || $.contains(thisPanle, trigger)) {\n                // 说明由本panel点击触发的\n                return;\n            }\n\n            // 其他情况，隐藏 panel\n            self.hide();\n        });\n\n        E.$window.scroll(function (e) {\n            self.hide();\n        });\n\n        E.$window.on('resize', function () {\n            self.hide();\n        });\n    };\n\n});\n// dropPanel fn api\n_e(function (E, $) {\n   \n    var DropPanel = E.DropPanel;\n\n    // 渲染\n    DropPanel.fn._render = function () {\n        var self = this;\n        var onRender = self.onRender;\n        var editor = self.editor;\n        var $panel = self.$panel;\n\n        // 渲染到页面\n        editor.$editorContainer.append($panel);\n\n        // 渲染后的回调事件\n        onRender && onRender.call(self);\n\n        // 记录状态\n        self.rendered = true;\n    };\n\n    // 定位\n    DropPanel.fn._position = function () {\n        var self = this;\n        var $panel = self.$panel;\n        var $triangle = self.$triangle;\n        var editor = self.editor;\n        var $menuContainer = editor.menuContainer.$menuContainer;\n        var menu = self.menu;\n        var $menuDom = menu.selected ? menu.$domSelected : menu.$domNormal;\n        // 注意这里的 offsetParent() 要返回 .menu-item 的 position\n        // 因为 .menu-item 是 position:relative\n        var menuPosition = $menuDom.offsetParent().position();\n\n        // 取得 menu 的位置、尺寸属性\n        var menuTop = menuPosition.top;\n        var menuLeft = menuPosition.left;\n        var menuHeight = $menuDom.offsetParent().height();\n        var menuWidth = $menuDom.offsetParent().width();\n\n        // 取得 panel 的尺寸属性\n        var panelWidth = $panel.outerWidth();\n        // var panelHeight = $panel.outerHeight();\n\n        // 取得 $txt 的尺寸\n        var txtWidth = editor.txt.$txt.outerWidth();\n\n        // ------------开始计算-------------\n\n        // 初步计算 panel 位置属性\n        var top = menuTop + menuHeight;\n        var left = menuLeft + menuWidth/2;\n        var marginLeft = 0 - panelWidth/2;\n        var marginLeft2 = marginLeft;  // 下文用于和 marginLeft 比较，来设置三角形tip的位置\n\n        // 如果超出了左边界，则移动回来（要和左侧有10px间隙）\n        if ((0 - marginLeft) > (left - 10)) {\n            marginLeft = 0 - (left - 10);\n        }\n\n        // 如果超出了有边界，则要左移（且和右侧有10px间隙）\n        var valWithTxt = (left + panelWidth + marginLeft) - txtWidth;\n        if (valWithTxt > -10) {\n            marginLeft = marginLeft - valWithTxt - 10;\n        }\n\n        // 设置样式\n        $panel.css({\n            top: top,\n            left: left,\n            'margin-left': marginLeft\n        });\n\n        // 如果因为向下滚动而导致菜单fixed，则再加一步处理\n        if (editor._isMenufixed) {\n            top = top + (($menuContainer.offset().top + $menuContainer.outerHeight()) - $panel.offset().top);\n\n            // 重新设置top\n            $panel.css({\n                top: top\n            });\n        }\n\n        // 设置三角形 tip 的位置\n        $triangle.css({\n            'margin-left': marginLeft2 - marginLeft - 5\n        });\n    };\n\n    // focus 第一个 input\n    DropPanel.fn.focusFirstInput = function () {\n        var self = this;\n        var $panel = self.$panel;\n        $panel.find('input[type=text],textarea').each(function () {\n            var $input = $(this);\n            if ($input.attr('disabled') == null) {\n                $input.focus();\n                return false;\n            }\n        });\n    };\n\n    // 显示\n    DropPanel.fn.show = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.rendered) {\n            // 第一次show之前，先渲染\n            self._render();\n        }\n\n        if (self.isShowing) {\n            return;\n        }\n\n        var $panel = self.$panel;\n        $panel.show();\n\n        // 定位\n        self._position();\n\n        // 记录状态\n        self.isShowing = true;\n\n        // 菜单状态\n        menu.activeStyle(true);\n\n        if (E.w3cRange) {\n            // 高级浏览器\n            self.focusFirstInput();\n        } else {\n            // 兼容 IE8 input placeholder\n            E.placeholderForIE8($panel);\n        }\n    };\n\n    // 隐藏\n    DropPanel.fn.hide = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.isShowing) {\n            return;\n        }\n\n        var $panel = self.$panel;\n        $panel.hide();\n\n        // 记录状态\n        self.isShowing = false;\n\n        // 菜单状态\n        menu.activeStyle(false);\n    };\n\n});\n// modal 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var Modal = function (editor, menu, opt) {\n        this.editor = editor;\n        this.menu = menu;\n        this.$content = opt.$content;\n\n        this.init();\n    };\n\n    Modal.fn = Modal.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.Modal = Modal;\n});\n// modal fn bind\n_e(function (E, $) {\n\n    var Modal = E.Modal;\n\n    Modal.fn.init = function () {\n        var self = this;\n\n        // 初始化dom\n        self.initDom();\n\n        // 初始化隐藏事件\n        self.initHideEvent();\n    };\n\n    // 初始化dom\n    Modal.fn.initDom = function () {\n        var self = this;\n        var $content = self.$content;\n        var $modal = $('<div class=\"wangEditor-modal\"></div>');\n        var $close = $('<div class=\"wangEditor-modal-close\"><i class=\"wangeditor-menu-img-cancel-circle\"></i></div>');\n\n        $modal.append($close);\n        $modal.append($content);\n\n        // 记录数据\n        self.$modal = $modal;\n        self.$close = $close;\n    };\n\n    // 初始化隐藏事件\n    Modal.fn.initHideEvent = function () {\n        var self = this;\n        var $close = self.$close;\n        var modal = self.$modal.get(0);\n\n        // 点击 $close 按钮，隐藏\n        $close.click(function () {\n            self.hide();\n        });\n\n        // 点击其他部分，隐藏\n        E.$body.on('click', function (e) {\n            if (!self.isShowing) {\n                return;\n            }\n            var trigger = e.target;\n\n            // 获取菜单elem\n            var menu = self.menu;\n            var menuDom;\n            if (menu) {\n                if (menu.selected) {\n                    menuDom = menu.$domSelected.get(0);\n                } else {\n                    menuDom = menu.$domNormal.get(0);\n                }\n\n                if (menuDom === trigger || $.contains(menuDom, trigger)) {\n                    // 说明由本菜单点击触发的\n                    return;\n                }\n            }\n\n            if (modal === trigger || $.contains(modal, trigger)) {\n                // 说明由本panel点击触发的\n                return;\n            }\n\n            // 其他情况，隐藏 panel\n            self.hide();\n        });\n    };\n});\n// modal fn api\n_e(function (E, $) {\n\n    var Modal = E.Modal;\n\n    // 渲染\n    Modal.fn._render = function () {\n        var self = this;\n        var editor = self.editor;\n        var $modal = self.$modal;\n\n        // $modal的z-index，在配置的z-index基础上再 +10\n        $modal.css('z-index', editor.config.zindex + 10 + '');\n\n        // 渲染到body最后面\n        E.$body.append($modal);\n\n        // 记录状态\n        self.rendered = true;\n    };\n\n    // 定位\n    Modal.fn._position = function () {\n        var self = this;\n        var $modal = self.$modal;\n        var top = $modal.offset().top;\n        var width = $modal.outerWidth();\n        var height = $modal.outerHeight();\n        var marginLeft = 0 - (width / 2);\n        var marginTop = 0 - (height / 2);\n        var sTop = E.$window.scrollTop();\n\n        // 保证modal最顶部，不超过浏览器上边框\n        if ((height / 2) > top) {\n            marginTop = 0 - top;\n        }\n\n        $modal.css({\n            'margin-left': marginLeft + 'px',\n            'margin-top': (marginTop + sTop) + 'px'\n        });\n    };\n\n    // 显示\n    Modal.fn.show = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.rendered) {\n            // 第一次show之前，先渲染\n            self._render();\n        }\n\n        if (self.isShowing) {\n            return;\n        }\n        // 记录状态\n        self.isShowing = true;\n\n        var $modal = self.$modal;\n        $modal.show();\n\n        // 定位\n        self._position();\n\n        // 激活菜单状态\n        menu && menu.activeStyle(true);\n    };\n\n    // 隐藏\n    Modal.fn.hide = function () {\n        var self = this;\n        var menu = self.menu;\n        if (!self.isShowing) {\n            return;\n        }\n        // 记录状态\n        self.isShowing = false;\n\n        // 隐藏\n        var $modal = self.$modal;\n        $modal.hide();\n\n        // 菜单状态\n        menu && menu.activeStyle(false);\n    };\n});\n// txt 构造函数\n_e(function (E, $) {\n\n    // 定义构造函数\n    var Txt = function (editor) {\n        this.editor = editor;\n\n        // 初始化\n        this.init();\n    };\n\n    Txt.fn = Txt.prototype;\n\n    // 暴露给 E 即 window.wangEditor\n    E.Txt = Txt;\n});\n// Txt.fn bind fn\n_e(function (E, $) {\n\n    var Txt = E.Txt;\n\n    // 初始化\n    Txt.fn.init = function () {\n        var self = this;\n        var editor = self.editor;\n        var $valueContainer = editor.$valueContainer;\n        var currentValue = editor.getInitValue();\n        var $txt;\n\n        if ($valueContainer.get(0).nodeName === 'DIV') {\n            // 如果传入生成编辑器的元素就是div，则直接使用\n            $txt = $valueContainer;\n            $txt.addClass(\"wangEditor-txt\");\n            $txt.attr('contentEditable', 'true');\n        } else {\n            // 如果不是div（是textarea），则创建一个div\n            $txt = $(\n                '<div class=\"wangEditor-txt\" contentEditable=\"true\">' +\n                    currentValue +\n                '</div>'\n            );\n        }\n\n        // 试图最后插入一个空行，ready之后才行\n        editor.ready(function () {\n            self.insertEmptyP();\n        });\n\n        self.$txt = $txt;\n\n        // 删除时，如果没有内容了，就添加一个 <p><br></p>\n        self.contentEmptyHandle();\n\n        // enter时，不能使用 div 换行\n        self.bindEnterForDiv();\n\n        // enter时，用 p 包裹 text\n        self.bindEnterForText();\n\n        // tab 插入4个空格\n        self.bindTabEvent();\n\n        // 处理粘贴内容\n        self.bindPasteFilter();\n\n        // $txt.formatText() 方法\n        self.bindFormatText();\n\n        // 定义 $txt.html() 方法\n        self.bindHtml();\n    };\n\n    // 删除时，如果没有内容了，就添加一个 <p><br></p>\n    Txt.fn.contentEmptyHandle = function () {\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n        var $p;\n\n        $txt.on('keydown', function (e) {\n            if (e.keyCode !== 8) {\n                return;\n            }\n            var txtHtml = $.trim($txt.html().toLowerCase());\n            if (txtHtml === '<p><br></p>') {\n                // 如果最后还剩余一个空行，就不再继续删除了\n                e.preventDefault();\n                return;\n            }\n        });\n\n        $txt.on('keyup', function (e) {\n            if (e.keyCode !== 8) {\n                return;\n            }\n            var txtHtml = $.trim($txt.html().toLowerCase());\n            // ff时用 txtHtml === '<br>' 判断，其他用 !txtHtml 判断\n            if (!txtHtml || txtHtml === '<br>') {\n                // 内容空了\n                $p = $('<p><br/></p>');\n                $txt.html(''); // 一定要先清空，否则在 ff 下有问题\n                $txt.append($p);\n                editor.restoreSelectionByElem($p.get(0));\n            }\n        });\n    };\n\n    // enter时，不能使用 div 换行\n    Txt.fn.bindEnterForDiv = function () {\n        var tags = E.config.legalTags; // 配置中编辑器要求的合法标签，如 p head table blockquote ul ol 等\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n\n        var $keydownDivElem;\n        function divHandler() {\n            if (!$keydownDivElem) {\n                return;\n            }\n\n            var $pElem = $('<p>' + $keydownDivElem.html() + '</p>');\n            $keydownDivElem.after($pElem);\n            $keydownDivElem.remove();\n        }\n\n        $txt.on('keydown keyup', function (e) {\n            if (e.keyCode !== 13) {\n                return;\n            }\n            // 查找合法标签\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getLegalTags(rangeElem);\n            var $targetElem;\n            var $pElem;\n\n            if (!targetElem) {\n                // 没找到合法标签，就去查找 div\n                targetElem = editor.getSelfOrParentByName(rangeElem, 'div');\n                if (!targetElem) {\n                    return;\n                }\n                $targetElem = $(targetElem);\n\n                if (e.type === 'keydown') {\n                    // 异步执行（同步执行会出现问题）\n                    $keydownDivElem = $targetElem;\n                    setTimeout(divHandler, 0);\n                }\n\n                if (e.type === 'keyup') {\n                    // 将 div 的内容移动到 p 里面，并移除 div\n                    $pElem = $('<p>' + $targetElem.html() + '</p>');\n                    $targetElem.after($pElem);\n                    $targetElem.remove();\n\n                    // 如果是回车结束，将选区定位到行首\n                    editor.restoreSelectionByElem($pElem.get(0), 'start');\n                }\n            }\n        });\n    };\n\n    // enter时，用 p 包裹 text\n    Txt.fn.bindEnterForText = function () {\n        var self = this;\n        var $txt = self.$txt;\n        var handle;\n        $txt.on('keyup', function (e) {\n            if (e.keyCode !== 13) {\n                return;\n            }\n            if (!handle) {\n                handle = function() {\n                    self.wrapImgAndText();\n                };\n            }\n            setTimeout(handle);\n        });\n    };\n\n    // tab 时，插入4个空格\n    Txt.fn.bindTabEvent = function () {\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n\n        $txt.on('keydown', function (e) {\n            if (e.keyCode !== 9) {\n                // 只监听 tab 按钮\n                return;\n            }\n            // 如果浏览器支持 insertHtml 则插入4个空格。如果不支持，就不管了\n            if (editor.queryCommandSupported('insertHtml')) {\n                editor.command(e, 'insertHtml', '&nbsp;&nbsp;&nbsp;&nbsp;');\n            }\n        });\n    };\n\n    // 处理粘贴内容\n    Txt.fn.bindPasteFilter = function () {\n        var self = this;\n        var editor = self.editor;\n        var resultHtml = '';  //存储最终的结果\n        var $txt = self.$txt;\n        var legalTags = editor.config.legalTags;\n        var legalTagArr = legalTags.split(',');\n\n        $txt.on('paste', function (e) {\n            if (!editor.config.pasteFilter) {\n                // 配置中取消了粘贴过滤\n                return;\n            }\n\n            var currentNodeName = editor.getRangeElem().nodeName;\n            if (currentNodeName === 'TD' || currentNodeName === 'TH') {\n                // 在表格的单元格中粘贴，忽略所有内容。否则会出现异常情况\n                return;\n            }\n\n            resultHtml = ''; // 先清空 resultHtml\n\n            var pasteHtml, $paste, docSplitHtml;\n            var data = e.clipboardData || e.originalEvent.clipboardData;\n            var ieData = window.clipboardData;\n\n            if (editor.config.pasteText) {\n                // 只粘贴纯文本\n\n                if (data && data.getData) {\n                    // w3c\n                    pasteHtml = data.getData('text/plain');\n                } else if (ieData && ieData.getData) {\n                    // IE\n                    pasteHtml = ieData.getData('text');\n                } else {\n                    // 其他情况\n                    return;\n                }\n\n                // 拼接为 <p> 标签\n                if (pasteHtml) {\n                    resultHtml = '<p>' + pasteHtml + '</p>';\n                }\n\n            } else {\n                // 粘贴过滤了样式的、只有标签的 html\n\n                if (data && data.getData) {\n                    // w3c\n\n                    // 获取粘贴过来的html\n                    pasteHtml = data.getData('text/html');\n\n                    // 过滤从 word excel 粘贴过来的乱码\n                    docSplitHtml = pasteHtml.split('</html>');\n                    if (docSplitHtml.length === 2) {\n                        pasteHtml = docSplitHtml[0];\n                    }\n\n                    if (pasteHtml) {\n                        // 创建dom\n                        $paste = $('<div>' + pasteHtml + '</div>');\n                        // 处理，并将结果存储到 resultHtml 『全局』变量\n                        handle($paste.get(0));\n                    } else {\n                        // 得不到html，试图获取text\n                        pasteHtml = data.getData('text/plain');\n                        if (pasteHtml) {\n                            // 替换特殊字符\n                            pasteHtml = pasteHtml.replace(/[ ]/g, '&nbsp;')\n                                                 .replace(/</g, '&lt;')\n                                                 .replace(/>/g, '&gt;')\n                                                 .replace(/\\n/g, '</p><p>');\n                            // 拼接\n                            resultHtml = '<p>' + pasteHtml + '</p>';\n\n                            // 查询链接\n                            resultHtml = resultHtml.replace(/<p>(https?:\\/\\/.*?)<\\/p>/ig, function (match, link) {\n                                return '<p><a href=\"' + link + '\" target=\"_blank\">' + link + '</p>';\n                            });\n                        }\n                    }\n                    \n                } else if (ieData && ieData.getData) {\n                    // IE 直接从剪切板中取出纯文本格式\n                    resultHtml = ieData.getData('text');\n                    if (!resultHtml) {\n                        return;\n                    }\n                    // 拼接为 <p> 标签\n                    resultHtml = '<p>' + resultHtml + '</p>';\n                    resultHtml = resultHtml.replace(new RegExp('\\n', 'g'), '</p><p>');\n                } else {\n                    // 其他情况\n                    return;\n                }\n            }\n\n            // 执行命令\n            if (resultHtml) {\n                editor.command(e, 'insertHtml', resultHtml);\n\n                // 删除内容为空的 p 和嵌套的 p\n                self.clearEmptyOrNestP();\n            }\n        });\n\n        // 处理粘贴的内容\n        function handle(elem) {\n            if (!elem || !elem.nodeType || !elem.nodeName) {\n                return;\n            }\n            var $elem;\n            var nodeName = elem.nodeName.toLowerCase();\n            var nodeType = elem.nodeType;\n            var childNodesClone;\n\n            // 只处理文本和普通node标签\n            if (nodeType !== 3 && nodeType !== 1) {\n                return;\n            }\n\n            $elem = $(elem);\n\n            // 如果是容器，则继续深度遍历\n            if (nodeName === 'div') {\n                childNodesClone = [];\n                $.each(elem.childNodes, function (index, item) {\n                    // elem.childNodes 可获取TEXT节点，而 $elem.children() 就获取不到\n                    // 先将 elem.childNodes 拷贝一份，一面在循环递归过程中 elem 发生变化\n                    childNodesClone.push(item);\n                });\n                // 遍历子元素，执行操作\n                $.each(childNodesClone, function () {\n                    handle(this);\n                });\n                return;\n            }\n            \n            if (legalTagArr.indexOf(nodeName) >= 0) {\n                // 如果是合法标签之内的，则根据元素类型，获取值\n                resultHtml += getResult(elem);\n            } else if (nodeType === 3) {\n                // 如果是文本，则直接插入 p 标签\n                resultHtml += '<p>' + elem.textContent + '</p>';\n            } else if (nodeName === 'br') {\n                // <br>保留\n                resultHtml += '<br/>';\n            }\n            else {\n                // 忽略的标签\n                if (['meta', 'style', 'script', 'object', 'form', 'iframe', 'hr'].indexOf(nodeName) >= 0) {\n                    return;\n                }\n                // 其他标签，移除属性，插入 p 标签\n                $elem = $(removeAttrs(elem));\n                // 注意，这里的 clone() 是必须的，否则会出错\n                resultHtml += $('<div>').append($elem.clone()).html();\n            }\n        }\n\n        // 获取元素的结果\n        function getResult(elem) {\n            var nodeName = elem.nodeName.toLowerCase();\n            var $elem;\n            var htmlForP = '';\n            var htmlForLi = '';\n\n            if (['blockquote'].indexOf(nodeName) >= 0) {\n\n                // 直接取出元素text即可\n                $elem = $(elem);\n                return '<' + nodeName + '>' + $elem.text() + '</' + nodeName + '>';\n\n            } else if (['p', 'h1', 'h2', 'h3', 'h4', 'h5'].indexOf(nodeName) >= 0) {\n\n                //p head 取出 text 和链接\n                elem = removeAttrs(elem);\n                $elem = $(elem);\n                htmlForP = $elem.html();\n\n                // 剔除 a img 之外的元素\n                htmlForP = htmlForP.replace(/<.*?>/ig, function (tag) {\n                    if (tag === '</a>' || tag.indexOf('<a ') === 0 || tag.indexOf('<img ') === 0) {\n                        return tag;\n                    } else {\n                        return '';\n                    }\n                });\n\n                return '<' + nodeName + '>' + htmlForP + '</' + nodeName + '>';\n\n            } else if (['ul', 'ol'].indexOf(nodeName) >= 0) {\n                \n                // ul ol元素，获取子元素（li元素）的text link img，再拼接\n                $elem = $(elem);\n                $elem.children().each(function () {\n                    var $li = $(removeAttrs(this));\n                    var html = $li.html();\n\n                    html = html.replace(/<.*?>/ig, function (tag) {\n                        if (tag === '</a>' || tag.indexOf('<a ') === 0 || tag.indexOf('<img ') === 0) {\n                            return tag;\n                        } else {\n                            return '';\n                        }\n                    });\n\n                    htmlForLi += '<li>' + html + '</li>';\n                });\n                return '<' + nodeName + '>' + htmlForLi + '</' + nodeName + '>';\n            \n            } else {\n                \n                // 其他元素，移除元素属性\n                $elem = $(removeAttrs(elem));\n                return $('<div>').append($elem).html();\n            }\n        }\n\n        // 移除一个元素（子元素）的attr\n        function removeAttrs(elem) {\n            var attrs = elem.attributes || [];\n            var attrNames = [];\n            var exception = ['href', 'target', 'src', 'alt', 'rowspan', 'colspan']; //例外情况\n\n            // 先存储下elem中所有 attr 的名称\n            $.each(attrs, function (key, attr) {\n                if (attr && attr.nodeType === 2) {\n                    attrNames.push(attr.nodeName);\n                }\n            });\n            // 再根据名称删除所有attr\n            $.each(attrNames, function (key, attr) {\n                if (exception.indexOf(attr) < 0) {\n                    // 除了 exception 规定的例外情况，删除其他属性\n                    elem.removeAttribute(attr);\n                }\n            });\n\n\n            // 递归子节点\n            var children = elem.childNodes;\n            if (children.length) {\n                $.each(children, function (key, value) {\n                    removeAttrs(value);\n                });\n            }\n\n            return elem;\n        }\n    };\n\n    // 绑定 $txt.formatText() 方法\n    Txt.fn.bindFormatText = function () {\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n        var legalTags = E.config.legalTags;\n        var legalTagArr = legalTags.split(',');\n        var length = legalTagArr.length;\n        var regArr = [];\n\n        // 将 E.config.legalTags 配置的有效字符，生成正则表达式\n        $.each(legalTagArr, function (k, tag) {\n            var reg = '\\>\\\\s*\\<(' + tag + ')\\>';\n            regArr.push(new RegExp(reg, 'ig'));\n        });\n\n        // 增加 li \n        regArr.push(new RegExp('\\>\\\\s*\\<(li)\\>', 'ig'));\n\n        // 增加 tr\n        regArr.push(new RegExp('\\>\\\\s*\\<(tr)\\>', 'ig'));\n\n        // 增加 code\n        regArr.push(new RegExp('\\>\\\\s*\\<(code)\\>', 'ig'));\n\n        // 生成 formatText 方法\n        $txt.formatText = function () {\n            var $temp = $('<div>');\n            var html = $txt.html();\n\n            // 去除空格\n            html = html.replace(/\\s*</ig, '<');\n\n            // 段落、表格之间换行\n            $.each(regArr, function (k, reg) {\n                if (!reg.test(html)) {\n                    return;\n                }\n                html = html.replace(reg, function (matchStr, tag) {\n                    return '>\\n<' + tag + '>';\n                });\n            });\n\n            $temp.html(html);\n            return $temp.text();\n        };\n    };\n\n    // 定制 $txt.html 方法\n    Txt.fn.bindHtml = function () {\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n        var $valueContainer = editor.$valueContainer;\n        var valueNodeName = editor.valueNodeName;\n\n        $txt.html = function (html) {\n            var result;\n\n            if (valueNodeName === 'div') {\n                // div 生成的编辑器，取值、赋值，都直接触发jquery的html方法\n                result = $.fn.html.call($txt, html);\n            }\n\n            // textarea 生成的编辑器，则需要考虑赋值时，也给textarea赋值\n\n            if (html === undefined) {\n                // 取值，直接触发jquery原生html方法\n                result = $.fn.html.call($txt);\n\n                // 替换 html 中，src和href属性中的 & 字符。\n                // 因为 .html() 或者 .innerHTML 会把所有的 & 字符都改成 &amp; 但是 src 和 href 中的要保持 &\n                result = result.replace(/(href|src)\\=\\\"(.*)\\\"/igm, function (a, b, c) {\n                    return b + '=\"' + c.replace('&amp;', '&') + '\"';\n                });\n            } else {\n                // 赋值，需要同时给 textarea 赋值\n                result = $.fn.html.call($txt, html);\n                $valueContainer.val(html);\n            }\n\n            if (html === undefined) {\n                return result;\n            } else {\n                // 手动触发 change 事件，因为 $txt 监控了 change 事件来判断是否需要执行 editor.onchange \n                $txt.change();\n            }\n        };\n    };\n});\n// Txt.fn api\n_e(function (E, $) {\n\n    var Txt = E.Txt;\n\n    var txtChangeEventNames = 'propertychange change click keyup input paste';\n\n    // 渲染\n    Txt.fn.render = function () {\n        var $txt = this.$txt;\n        var $editorContainer = this.editor.$editorContainer;\n        $editorContainer.append($txt);\n    };\n\n    // 计算高度\n    Txt.fn.initHeight = function () {\n        var editor = this.editor;\n        var $txt = this.$txt;\n        var valueContainerHeight = editor.$valueContainer.height();\n        var menuHeight = editor.menuContainer.height();\n        var txtHeight = valueContainerHeight - menuHeight;\n\n        // 限制最小为 50px\n        txtHeight = txtHeight < 50 ? 50 : txtHeight;\n\n        $txt.height(txtHeight);\n\n        // 记录原始高度\n        editor.valueContainerHeight = valueContainerHeight;\n\n        // 设置 max-height\n        this.initMaxHeight(txtHeight, menuHeight);\n    };\n\n    // 计算最大高度\n    Txt.fn.initMaxHeight = function (txtHeight, menuHeight) {\n        var editor = this.editor;\n        var $menuContainer = editor.menuContainer.$menuContainer;\n        var $txt = this.$txt;\n        var $wrap = $('<div>');\n\n        // 需要浏览器支持 max-height，否则不管\n        if (window.getComputedStyle && 'max-height'in window.getComputedStyle($txt.get(0))) {\n            // 获取 max-height 并判断是否有值\n            var maxHeight = parseInt(editor.$valueContainer.css('max-height'));\n            if (isNaN(maxHeight)) {\n                return;\n            }\n\n            // max-height 和『全屏』暂时有冲突\n            if (editor.menus.fullscreen) {\n                E.warn('max-height和『全屏』菜单一起使用时，会有一些问题尚未解决，请暂时不要两个同时使用');\n                return;\n            }\n\n            // 标记\n            editor.useMaxHeight = true;\n\n            // 设置maxheight\n            $wrap.css({\n                'max-height': (maxHeight - menuHeight) + 'px',\n                'overflow-y': 'auto'\n            });\n            $txt.css({\n                'height': 'auto',\n                'overflow-y': 'visible',\n                'min-height': txtHeight + 'px'\n            });\n\n            // 滚动式，菜单阴影\n            $wrap.on('scroll', function () {\n                if ($txt.parent().scrollTop() > 10) {\n                    $menuContainer.addClass('wangEditor-menu-shadow');\n                } else {\n                    $menuContainer.removeClass('wangEditor-menu-shadow');\n                }\n            });\n\n            // 需在编辑器区域外面再包裹一层\n            $txt.wrap($wrap);\n        }\n    };\n\n    // 保存选区\n    Txt.fn.saveSelectionEvent = function () {\n        var $txt = this.$txt;\n        var editor = this.editor;\n        var timeoutId;\n        var dt = Date.now();\n\n        function save() {\n            editor.saveSelection();\n        }\n\n        // 同步保存选区\n        function saveSync() {\n            // 100ms之内，不重复保存\n            if (Date.now() - dt < 100) {\n                return;\n            }\n\n            dt = Date.now();\n            save();\n        }\n\n        // 异步保存选区\n        function saveAync() {\n            // 节流，防止高频率重复操作\n            if (timeoutId) {\n                clearTimeout(timeoutId);\n            }\n            timeoutId = setTimeout(save, 300);\n        }\n\n        // txt change 、focus、blur 时随时保存选区\n        $txt.on(txtChangeEventNames + ' focus blur', function (e) {\n            // 先同步保存选区，为了让接下来就马上要执行 editor.getRangeElem() 的程序\n            // 能够获取到正确的 rangeElem\n            saveSync();\n\n            // 再异步保存选区，为了确定更加准确的选区，为后续的操作做准备\n            saveAync();\n        });\n\n        // 鼠标拖拽选择时，可能会拖拽到编辑器区域外面再松手，此时 $txt 就监听不到 click事件了\n        $txt.on('mousedown', function () {\n            $txt.on('mouseleave.saveSelection', function (e) {\n                // 先同步后异步，如上述注释\n                saveSync();\n                saveAync();\n\n                // 顺道吧菜单状态也更新了\n                editor.updateMenuStyle();\n            });\n        }).on('mouseup', function () {\n            $txt.off('mouseleave.saveSelection');\n        });\n        \n    };\n\n    // 随时更新 value\n    Txt.fn.updateValueEvent = function () {\n        var $txt = this.$txt;\n        var editor = this.editor;\n        var timeoutId, oldValue;\n\n        // 触发 onchange 事件\n        function doOnchange() {\n            var val = $txt.html();\n            if (oldValue === val) {\n                // 无变化\n                return;\n            }\n\n            // 触发 onchange 事件\n            if (editor.onchange && typeof editor.onchange === 'function') {\n                editor.onchange.call(editor);\n            }\n\n            // 更新内容\n            editor.updateValue();\n\n            // 记录最新内容\n            oldValue = val;\n        }\n\n        // txt change 时随时更新内容\n        $txt.on(txtChangeEventNames, function (e) {\n            // 初始化\n            if (oldValue == null) {\n                oldValue = $txt.html();\n            }\n\n            // 监控内容变化（停止操作 100ms 之后立即执行）\n            if (timeoutId) {\n                clearTimeout(timeoutId);\n            }\n            timeoutId = setTimeout(doOnchange, 100);\n        });\n    };\n\n    // 随时更新 menustyle\n    Txt.fn.updateMenuStyleEvent = function () {\n        var $txt = this.$txt;\n        var editor = this.editor;\n\n        // txt change 时随时更新内容\n        $txt.on(txtChangeEventNames, function (e) {\n            editor.updateMenuStyle();\n        });\n    };\n\n    // 最后插入试图插入 <p><br><p>\n    Txt.fn.insertEmptyP = function () {\n        var $txt = this.$txt;\n        var $children = $txt.children();\n\n        if ($children.length === 0) {\n            $txt.append($('<p><br></p>'));\n            return;\n        }\n\n        if ($.trim($children.last().html()).toLowerCase() !== '<br>') {\n            $txt.append($('<p><br></p>'));\n        }\n    };\n\n    // 将编辑器暴露出来的文字和图片，都用 p 来包裹\n    Txt.fn.wrapImgAndText = function () {\n        var $txt = this.$txt;\n        var $imgs = $txt.children('img');\n        var txt = $txt[0];\n        var childNodes = txt.childNodes;\n        var childrenLength = childNodes.length;\n        var i, childNode, p;\n\n        // 处理图片\n        $imgs.length && $imgs.each(function () {\n            $(this).wrap('<p>');\n        });\n\n        // 处理文字\n        for (i = 0; i < childrenLength; i++) {\n            childNode = childNodes[i];\n            if (childNode.nodeType === 3 && childNode.textContent && $.trim(childNode.textContent)) {\n                $(childNode).wrap('<p>');\n            }\n        }\n    };\n\n    // 清空内容为空的<p>，以及重复包裹的<p>（在windows下的chrome粘贴文字之后，会出现上述情况）\n    Txt.fn.clearEmptyOrNestP = function () {\n        var $txt = this.$txt;\n        var $pList = $txt.find('p');\n\n        $pList.each(function () {\n            var $p = $(this);\n            var $children = $p.children();\n            var childrenLength = $children.length;\n            var $firstChild;\n            var content = $.trim($p.html());\n\n            // 内容为空的p\n            if (!content) {\n                $p.remove();\n                return;\n            }\n\n            // 嵌套的p\n            if (childrenLength === 1) {\n                $firstChild = $children.first();\n                if ($firstChild.get(0) && $firstChild.get(0).nodeName === 'P') {\n                    $p.html( $firstChild.html() );\n                }\n            }\n        });\n    };\n\n    // 获取 scrollTop\n    Txt.fn.scrollTop = function (val) {\n        var self = this;\n        var editor = self.editor;\n        var $txt = self.$txt;\n\n        if (editor.useMaxHeight) {\n            return $txt.parent().scrollTop(val);\n        } else {\n            return $txt.scrollTop(val);\n        }\n    };\n\n    // 鼠标hover时候，显示p、head的高度\n    Txt.fn.showHeightOnHover = function () {\n        var editor = this.editor;\n        var $editorContainer = editor.$editorContainer;\n        var menuContainer = editor.menuContainer;\n        var $txt = this.$txt;\n        var $tip = $('<i class=\"height-tip\"><i>');\n        var isTipInTxt = false;\n\n        function addAndShowTip($target) {\n            if (!isTipInTxt) {\n                $editorContainer.append($tip);\n                isTipInTxt = true;\n            }\n\n            var txtTop = $txt.position().top;\n            var txtHeight = $txt.outerHeight();\n\n            var height = $target.height();\n            var top = $target.position().top;\n            var marginTop = parseInt($target.css('margin-top'), 10);\n            var paddingTop = parseInt($target.css('padding-top'), 10);\n            var marginBottom = parseInt($target.css('margin-bottom'), 10);\n            var paddingBottom = parseInt($target.css('padding-bottom'), 10);\n\n            // 计算初步的结果\n            var resultHeight = height + paddingTop + marginTop + paddingBottom + marginBottom;\n            var resultTop = top + menuContainer.height();\n            \n            // var spaceValue;\n\n            // // 判断是否超出下边界\n            // spaceValue = (resultTop + resultHeight) - (txtTop + txtHeight);\n            // if (spaceValue > 0) {\n            //     resultHeight = resultHeight - spaceValue;\n            // }\n\n            // // 判断是否超出了下边界\n            // spaceValue = txtTop > resultTop;\n            // if (spaceValue) {\n            //     resultHeight = resultHeight - spaceValue;\n            //     top = top + spaceValue;\n            // }\n\n            // 按照最终结果渲染\n            $tip.css({\n                height: height + paddingTop + marginTop + paddingBottom + marginBottom,\n                top: top + menuContainer.height()\n            });\n        }\n        function removeTip() {\n            if (!isTipInTxt) {\n                return;\n            }\n            $tip.remove();\n            isTipInTxt = false;\n        }\n\n        $txt.on('mouseenter', 'ul,ol,blockquote,p,h1,h2,h3,h4,h5,table,pre', function (e) {\n            addAndShowTip($(e.currentTarget));\n        }).on('mouseleave', function () {\n            removeTip();\n        });\n    };\n\n});\n// 工具函数\n_e(function (E, $) {\n\n    // IE8 [].indexOf()\n    if(!Array.prototype.indexOf){\n        //IE低版本不支持 arr.indexOf \n        Array.prototype.indexOf = function(elem){\n            var i = 0,\n                length = this.length;\n            for(; i<length; i++){\n                if(this[i] === elem){\n                    return i;\n                }\n            }\n            return -1;\n        };\n        //IE低版本不支持 arr.lastIndexOf\n        Array.prototype.lastIndexOf = function(elem){\n            var length = this.length;\n            for(length = length - 1; length >= 0; length--){\n                if(this[length] === elem){\n                    return length;\n                }\n            }\n            return -1;\n        };\n    }\n\n    // IE8 Date.now()\n    if (!Date.now) {\n        Date.now = function () {\n            return new Date().valueOf(); \n        };\n    }\n\n    // console.log && console.warn && console.error\n    var console = window.console;\n    var emptyFn = function () {};\n    $.each(['info', 'log', 'warn', 'error'], function (key, value) {\n        if (console == null) {\n            E[value] = emptyFn;\n        } else {\n            E[value] = function (info) {\n                // 通过配置来控制打印输出\n                if (E.config && E.config.printLog) {\n                    console[value]('wangEditor提示: ' + info);\n                }\n            };\n        }\n    });\n\n    // 获取随机数\n    E.random = function () {\n        return Math.random().toString().slice(2);\n    };\n\n    // 浏览器是否支持 placeholder\n    E.placeholder = 'placeholder' in document.createElement('input');\n\n    // 兼容IE8的 input placeholder\n    E.placeholderForIE8 = function ($container) {\n        if (E.placeholder) {\n            return;\n        }\n        $container.find('input[placeholder]').each(function () {\n            var $input = $(this);\n            var placeholder = $input.attr('placeholder');\n\n            if ($input.val() === '') {\n                $input.css('color', '#666');\n                $input.val(placeholder);\n\n                $input.on('focus.placeholder click.placeholder', function () {\n                    $input.val('');\n                    $input.css('color', '#333');\n                    $input.off('focus.placeholder click.placeholder');\n                });\n            }\n        });\n    };\n});\n// 语言包\n_e(function (E, $) {\n    E.langs = {};\n    \n    // 中文\n    E.langs['zh-cn'] = {\n        bold: '粗体',\n        underline: '下划线',\n        italic: '斜体',\n        forecolor: '文字颜色',\n        bgcolor: '背景色',\n        strikethrough: '删除线',\n        eraser: '清空格式',\n        source: '源码',\n        quote: '引用',\n        fontfamily: '字体',\n        fontsize: '字号',\n        head: '标题',\n        orderlist: '有序列表',\n        unorderlist: '无序列表',\n        alignleft: '左对齐',\n        aligncenter: '居中',\n        alignright: '右对齐',\n        link: '链接',\n        text: '文本',\n        submit: '提交',\n        cancel: '取消',\n        unlink: '取消链接',\n        table: '表格',\n        emotion: '表情',\n        img: '图片',\n        uploadImg: '上传图片',\n        linkImg: '网络图片',\n        video: '视频',\n        'width': '宽',\n        'height': '高',\n        location: '位置',\n        loading: '加载中',\n        searchlocation: '搜索位置',\n        dynamicMap: '动态地图',\n        clearLocation: '清除位置',\n        langDynamicOneLocation: '动态地图只能显示一个位置',\n        insertcode: '插入代码',\n        undo: '撤销',\n        redo: '重复',\n        fullscreen: '全屏',\n        openLink: '打开链接'\n    };\n\n    // 英文\n    E.langs.en = {\n        bold: 'Bold',\n        underline: 'Underline',\n        italic: 'Italic',\n        forecolor: 'Color',\n        bgcolor: 'Backcolor',\n        strikethrough: 'Strikethrough',\n        eraser: 'Eraser',\n        source: 'Codeview',\n        quote: 'Quote',\n        fontfamily: 'Font family',\n        fontsize: 'Font size',\n        head: 'Head',\n        orderlist: 'Ordered list',\n        unorderlist: 'Unordered list',\n        alignleft: 'Align left',\n        aligncenter: 'Align center',\n        alignright: 'Align right',\n        link: 'Insert link',\n        text: 'Text',\n        submit: 'Submit',\n        cancel: 'Cancel',\n        unlink: 'Unlink',\n        table: 'Table',\n        emotion: 'Emotions',\n        img: 'Image',\n        uploadImg: 'Upload',\n        linkImg: 'Link',\n        video: 'Video',\n        'width': 'width',\n        'height': 'height',\n        location: 'Location',\n        loading: 'Loading',\n        searchlocation: 'search',\n        dynamicMap: 'Dynamic',\n        clearLocation: 'Clear',\n        langDynamicOneLocation: 'Only one location in dynamic map',\n        insertcode: 'Insert Code',\n        undo: 'Undo',\n        redo: 'Redo',\n        fullscreen: 'Full screnn',\n        openLink: 'open link'\n    };\n});\n// 全局配置\n_e(function (E, $) {\n\n    E.config = {};\n\n    // 全屏时的 z-index\n    E.config.zindex = 10000;\n\n    // 是否打印log\n    E.config.printLog = true;\n\n    // 菜单吸顶：false - 不吸顶；number - 吸顶，值为top值\n    E.config.menuFixed = 0;\n\n    // 编辑源码时，过滤 javascript\n    E.config.jsFilter = true;\n\n    // 编辑器允许的标签\n    E.config.legalTags = 'p,h1,h2,h3,h4,h5,h6,blockquote,table,ul,ol,pre';\n\n    // 语言包\n    E.config.lang = E.langs['zh-cn'];\n\n    // 菜单配置\n    E.config.menus = [\n        'source',\n        '|',\n        'bold',\n        'underline',\n        'italic',\n        'strikethrough',\n        'eraser',\n        'forecolor',\n        'bgcolor',\n        '|',\n        'quote',\n        'fontfamily',\n        'fontsize',\n        'head',\n        'unorderlist',\n        'orderlist',\n        'alignleft',\n        'aligncenter',\n        'alignright',\n        '|',\n        'link',\n        'unlink',\n        'table',\n        'emotion',\n        '|',\n        'img',\n        'video',\n        'location',\n        'insertcode',\n        '|',\n        'undo',\n        'redo',\n        'fullscreen'\n    ];\n\n    // 颜色配置\n    E.config.colors = {\n        // 'value': 'title'\n        '#880000': '暗红色',\n        '#800080': '紫色',\n        '#ff0000': '红色',\n        '#ff00ff': '鲜粉色',\n        '#000080': '深蓝色',\n        '#0000ff': '蓝色',\n        '#00ffff': '湖蓝色',\n        '#008080': '蓝绿色',\n        '#008000': '绿色',\n        '#808000': '橄榄色',\n        '#00ff00': '浅绿色',\n        '#ffcc00': '橙黄色',\n        '#808080': '灰色',\n        '#c0c0c0': '银色',\n        '#000000': '黑色',\n        '#ffffff': '白色'\n    };\n\n    // 字体\n    E.config.familys = [\n        '宋体', '黑体', '楷体', '微软雅黑',\n        'Arial', 'Verdana', 'Georgia',\n        'Times New Roman', 'Microsoft JhengHei',\n        'Trebuchet MS', 'Courier New', 'Impact', 'Comic Sans MS', 'Consolas'\n    ];\n\n    // 字号\n    E.config.fontsizes = {\n        // 格式：'value': 'title'\n        1: '12px',\n        2: '13px',\n        3: '16px',\n        4: '18px',\n        5: '24px',\n        6: '32px',\n        7: '48px'\n    };\n\n    // 表情包\n    E.config.emotionsShow = 'icon'; // 显示项，默认为'icon'，也可以配置成'value'\n    E.config.emotions = {\n        // 'default': {\n        //     title: '默认',\n        //     data: './emotions.data'\n        // },\n        'weibo': {\n            title: '微博表情',\n            data: [\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif',\n                    value: '[草泥马]'    \n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif',\n                    value: '[神马]'    \n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/fuyun_thumb.gif',\n                    value: '[浮云]'    \n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c9/geili_thumb.gif',\n                    value: '[给力]'    \n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/f2/wg_thumb.gif',\n                    value: '[围观]'    \n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/70/vw_thumb.gif',\n                    value: '[威武]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6e/panda_thumb.gif',\n                    value: '[熊猫]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/81/rabbit_thumb.gif',\n                    value: '[兔子]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/otm_thumb.gif',\n                    value: '[奥特曼]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/15/j_thumb.gif',\n                    value: '[囧]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/89/hufen_thumb.gif',\n                    value: '[互粉]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c4/liwu_thumb.gif',\n                    value: '[礼物]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/ac/smilea_thumb.gif',\n                    value: '[呵呵]'\n                },\n                {\n                    icon: 'http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/0b/tootha_thumb.gif',\n                    value: '[哈哈]'\n                }\n            ]\n        }\n    };\n\n    // 百度地图的key\n    E.config.mapAk = 'TVhjYjq1ICT2qqL5LdS8mwas';\n\n    // 上传图片的配置\n    // server地址\n    E.config.uploadImgUrl = '';\n    // 超时时间\n    E.config.uploadTimeout = 20 * 1000;\n    // 用于存储上传回调事件\n    E.config.uploadImgFns = {};\n    // 自定义上传图片的filename\n    // E.config.uploadImgFileName = 'customFileName';\n\n    // 自定义上传，设置为 true 之后，显示上传图标\n    E.config.customUpload = false;\n    // 自定义上传的init事件\n    // E.config.customUploadInit = function () {....};\n\n    // 自定义上传时传递的参数（如 token）\n    E.config.uploadParams = {\n        /* token: 'abcdef12345' */\n    };\n\n    // 自定义上传是的header参数\n    E.config.uploadHeaders = {\n         /* 'Accept' : 'text/x-json' */\n    };\n\n    // 跨域上传时传递 cookie，默认为 true\n    E.config.withCredentials = true;\n\n    // 隐藏网络图片，默认为 false\n    E.config.hideLinkImg = false;\n\n    // 是否过滤粘贴内容\n    E.config.pasteFilter = true;\n\n    // 是否粘贴纯文本，当 editor.config.pasteFilter === false 时候，此配置将失效\n    E.config.pasteText = false;\n\n    // 插入代码时，默认的语言\n    E.config.codeDefaultLang = 'javascript';\n\n});\n// 全局UI\n_e(function (E, $) {\n\n     E.UI = {};\n\n     // 为菜单自定义配置的UI\n     E.UI.menus = {\n        // 这个 default 不加引号，在 IE8 会报错\n        'default': {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-command\"></i></a>',\n            selected: '.selected'\n        },\n        bold: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-bold\"></i></a>',\n            selected: '.selected'\n        },\n        underline: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-underline\"></i></a>',\n            selected: '.selected'\n        },\n        italic: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-italic\"></i></a>',\n            selected: '.selected'\n        },\n        forecolor: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-pencil\"></i></a>',\n            selected: '.selected'\n        },\n        bgcolor: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-brush\"></i></a>',\n            selected: '.selected'\n        },\n        strikethrough: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-strikethrough\"></i></a>',\n            selected: '.selected'\n        },\n        eraser: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-eraser\"></i></a>',\n            selected: '.selected'\n        },\n        quote: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-quotes-left\"></i></a>',\n            selected: '.selected'\n        },\n        source: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-code\"></i></a>',\n            selected: '.selected'\n        },\n        fontfamily: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-font2\"></i></a>',\n            selected: '.selected'\n        },\n        fontsize: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-text-height\"></i></a>',\n            selected: '.selected'\n        },\n        head: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-header\"></i></a>',\n            selected: '.selected'\n        },\n        orderlist: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-list-numbered\"></i></a>',\n            selected: '.selected'\n        },\n        unorderlist: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-list-bullet\"></i></a>',\n            selected: '.selected'\n        },\n        alignleft: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-left\"></i></a>',\n            selected: '.selected'\n        },\n        aligncenter: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-center\"></i></a>',\n            selected: '.selected'\n        },\n        alignright: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-align-right\"></i></a>',\n            selected: '.selected'\n        },\n        link: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-link\"></i></a>',\n            selected: '.selected'\n        },\n        unlink: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-unlink\"></i></a>',\n            selected: '.selected'\n        },\n        table: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-table\"></i></a>',\n            selected: '.selected'\n        },\n        emotion: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-happy\"></i></a>',\n            selected: '.selected'\n        },\n        img: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-picture\"></i></a>',\n            selected: '.selected'\n        },\n        video: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-play\"></i></a>',\n            selected: '.selected'\n        },\n        location: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-location\"></i></a>',\n            selected: '.selected'\n        },\n        insertcode: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-terminal\"></i></a>',\n            selected: '.selected'\n        },\n        undo: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-ccw\"></i></a>',\n            selected: '.selected'\n        },\n        redo: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-cw\"></i></a>',\n            selected: '.selected'\n        },\n        fullscreen: {\n            normal: '<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-enlarge2\"></i></a>',\n            selected: '<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-shrink2\"></i></a>'\n        }\n     };\n     \n});\n// 对象配置\n_e(function (E, $) {\n\n    E.fn.initDefaultConfig = function () {\n        var editor = this;\n        editor.config = $.extend({}, E.config);\n        editor.UI = $.extend({}, E.UI);\n    };\n\n});\n// 增加 container\n_e(function (E, $) {\n\n    E.fn.addEditorContainer = function () {\n        this.$editorContainer = $('<div class=\"wangEditor-container\"></div>');\n    };\n\n});\n// 增加编辑区域对象\n_e(function (E, $) {\n\n    E.fn.addTxt = function () {\n        var editor = this;\n        var txt = new E.Txt(editor);\n\n        editor.txt = txt;\n    };\n\n});\n// 增加menuContainer对象\n_e(function (E, $) {\n\n    E.fn.addMenuContainer = function () {\n        var editor = this;\n        editor.menuContainer = new E.MenuContainer(editor);\n    };\n\n});\n// 增加menus\n_e(function (E, $) {\n\n    // 存储创建菜单的函数\n    E.createMenuFns = [];\n    E.createMenu = function (fn) {\n        E.createMenuFns.push(fn);\n    };\n\n    // 创建所有菜单\n    E.fn.addMenus = function () {\n        var editor = this;\n        var menuIds = editor.config.menus;\n\n        // 检验 menuId 是否在配置中存在\n        function check(menuId) {\n            if (menuIds.indexOf(menuId) >= 0) {\n                return true;\n            }\n            return false;\n        }\n\n        // 遍历所有的菜单创建函数，并执行\n        $.each(E.createMenuFns, function (k, createMenuFn) {\n            createMenuFn.call(editor, check);\n        });\n    };\n\n});\n// bold菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'bold';\n        if (!check(menuId)) {\n            return;\n        }\n\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.bold,\n            commandName: 'Bold'\n        });\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 如果选区有内容，则执行基础命令\n                editor.command(e, 'Bold');\n            } else {\n                // 如果选区没有内容\n                editor.commandForElem('b,strong,h1,h2,h3,h4,h5', e, 'Bold');\n            }\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// underline菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'underline';\n        if (!check(menuId)) {\n            return;\n        }\n\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.underline,\n            commandName: 'Underline'\n        });\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 如果选区有内容，则执行基础命令\n                editor.command(e, 'Underline');\n            } else {\n                // 如果选区没有内容\n                editor.commandForElem('u,a', e, 'Underline');\n            }\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// italic 菜单\n_e(function (E, $) {\n    \n    E.createMenu(function (check) {\n        var menuId = 'italic';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.italic,\n            commandName: 'Italic'\n        });\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 如果选区有内容，则执行基础命令\n                editor.command(e, 'Italic');\n            } else {\n                // 如果选区没有内容\n                editor.commandForElem('i', e, 'Italic');\n            }\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// forecolor 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'forecolor';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var configColors = editor.config.colors;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.forecolor\n        });\n\n        // 创建 dropPanel\n        var $content = $('<div></div>');\n        $.each(configColors, function (k, v) {\n            $content.append(\n                [\n                    '<a href=\"#\" class=\"color-item\"',\n                    '    title=\"' + v + '\" commandValue=\"' + k + '\" ',\n                    '    style=\"color: ' + k + '\" ',\n                    '><i class=\"wangeditor-menu-img-pencil\"></i></a>'\n                ].join('')\n            );\n        });\n        $content.on('click', 'a[commandValue]', function (e) {\n            // 执行命令\n            var $elem = $(this);\n            var commandValue = $elem.attr('commandValue');\n\n            if (menu.selected && editor.isRangeEmpty()) {\n                // 当前处于选中状态，并且选中内容为空\n                editor.commandForElem('font[color]', e, 'forecolor', commandValue);\n            } else {\n                // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                editor.command(e, 'forecolor', commandValue);\n            }\n        });\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 125\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[color]');\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// bgcolor 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'bgcolor';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var configColors = editor.config.colors;\n\n        // 检查元素是否有 background-color: 内联样式\n        function checkElemFn(elem) {\n            var cssText;\n            if (elem && elem.style && elem.style.cssText != null) {\n                cssText = elem.style.cssText;\n                if (cssText && cssText.indexOf('background-color:') >= 0) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.bgcolor\n        });\n\n        // 创建 dropPanel\n        var $content = $('<div></div>');\n        $.each(configColors, function (k, v) {\n            $content.append(\n                [\n                    '<a href=\"#\" class=\"color-item\"',\n                    '    title=\"' + v + '\" commandValue=\"' + k + '\" ',\n                    '    style=\"color: ' + k + '\" ',\n                    '><i class=\"wangeditor-menu-img-brush\"></i></a>'\n                ].join('')\n            );\n        });\n        $content.on('click', 'a[commandValue]', function (e) {\n            // 执行命令\n\n            var $elem = $(this);\n            var commandValue = $elem.attr('commandValue');\n\n            if (menu.selected && editor.isRangeEmpty()) {\n                // 当前处于选中状态，并且选中内容为空。使用 commandForElem 执行命令\n                editor.commandForElem({\n                    selector: 'span,font',\n                    check: checkElemFn\n                }, e, 'BackColor', commandValue);\n            } else {\n                // 当前未处于选中状态，或者有选中内容。则执行默认命令\n                editor.command(e, 'BackColor', commandValue);\n            }\n        });\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 125\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'span,font', checkElemFn);\n            \n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// strikethrough 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'strikethrough';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.strikethrough,\n            commandName: 'StrikeThrough'\n        });\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 如果选区有内容，则执行基础命令\n                editor.command(e, 'StrikeThrough');\n            } else {\n                // 如果选区没有内容\n                editor.commandForElem('strike', e, 'StrikeThrough');\n            }\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// eraser 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'eraser';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.eraser,\n            commandName: 'RemoveFormat'\n        });\n\n        // 定义点击事件\n        menu.clickEvent = function (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n\n            if (!isRangeEmpty) {\n                // 选区不是空的，则执行默认命令\n                editor.command(e, 'RemoveFormat');\n                return;\n            }\n\n            var $clearElem;\n\n            // 自定义的命令函数\n            function commandFn() {\n                var editor = this;\n                var rangeElem;\n                var pElem, $pElem;\n                var quoteElem, $quoteElem;\n                var listElem, $listElem;\n\n                // 获取选区 elem\n                rangeElem = editor.getRangeElem();\n                // 第一步，获取 quote 父元素\n                quoteElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                if (quoteElem) {\n                    $quoteElem = $(quoteElem);\n                    $clearElem = $('<p>' + $quoteElem.text() + '</p>');\n                    $quoteElem.after($clearElem).remove();\n                }\n                // 第二步，获取 p h 父元素\n                pElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5');\n                if (pElem) {\n                    $pElem = $(pElem);\n                    $clearElem = $('<p>' + $pElem.text() + '</p>');\n                    $pElem.after($clearElem).remove();\n                }\n                // 第三步，获取list\n                listElem = editor.getSelfOrParentByName(rangeElem, 'ul,ol');\n                if (listElem) {\n                    $listElem = $(listElem);\n                    $clearElem = $('<p>' + $listElem.text() + '</p>');\n                    $listElem.after($clearElem).remove();\n                }\n            }\n\n            // 自定义 callback 事件\n            function callback() {\n                // callback中，设置range为clearElem\n                var editor = this;\n                if ($clearElem) {\n                    editor.restoreSelectionByElem($clearElem.get(0));\n                }\n            }\n\n            // 执行自定义命令\n            editor.customCommand(e, commandFn, callback);\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// source 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'source';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var txtHtml;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.source\n        });\n\n        menu.isShowCode = false;\n\n        // 更新内容\n        function updateValue() {\n            var $code = menu.$codeTextarea;\n            var $txt = editor.txt.$txt;\n            var value = $.trim($code.val()); // 取值\n\n            if (!value) {\n                value = '<p><br></p>';\n            }\n            \n            // 过滤js代码\n            if (editor.config.jsFilter) {\n                \n                value = value.replace(/<script[\\s\\S]*?<\\/script>/ig, '');\n            }\n            // 赋值\n            try {\n                $txt.html(value);\n            } catch (ex) {\n                // 更新 html 源码出错，一般都是取消了 js 过滤之后，js报错导致的\n            }\n        }\n\n        // 定义click事件\n        menu.clickEvent = function (e) {\n            var self = this;\n            var editor = self.editor;\n            var $txt = editor.txt.$txt;\n            var txtOuterHeight = $txt.outerHeight();\n            var txtHeight = $txt.height();\n\n            if (!self.$codeTextarea) {\n                self.$codeTextarea = $('<textarea class=\"code-textarea\"></textarea>');\n            }\n            var $code = self.$codeTextarea;\n            $code.css({\n                height: txtHeight,\n                'margin-top': txtOuterHeight - txtHeight\n            });\n\n            // 赋值\n            $code.val($txt.html());\n\n            // 监控变化\n            $code.on('change', function (e) {\n                updateValue();\n            });\n\n            // 渲染\n            $txt.after($code).hide();\n            $code.show();\n\n            // 更新状态\n            menu.isShowCode = true;\n\n            // 执行 updateSelected 事件\n            this.updateSelected();\n\n            // 禁用其他菜单\n            editor.disableMenusExcept('source');\n\n            // 记录当前html值\n            txtHtml = $txt.html();\n        };\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var self = this;\n            var editor = self.editor;\n            var $txt = editor.txt.$txt;\n            var $code = self.$codeTextarea;\n            var value;\n\n            if (!$code) {\n                return;\n            }\n\n            // 更新内容\n            updateValue();\n\n            // 渲染\n            $code.after($txt).hide();\n            $txt.show();\n\n            // 更新状态\n            menu.isShowCode = false;\n\n            // 执行 updateSelected 事件\n            this.updateSelected();\n\n            // 启用其他菜单\n            editor.enableMenusExcept('source');\n\n            // 判断是否执行 onchange 事件\n            if ($txt.html() !== txtHtml) {\n                if (editor.onchange && typeof editor.onchange === 'function') {\n                    editor.onchange.call(editor);\n                }\n            }\n        };\n\n        // 定义切换选中状态事件\n        menu.updateSelectedEvent = function () {\n            return this.isShowCode;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// quote 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'quote';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.quote,\n            commandName: 'formatBlock',\n            commandValue: 'blockquote'\n        });\n\n        // 定义click事件\n        menu.clickEvent = function (e) {\n            var rangeElem = editor.getRangeElem();\n            var $rangeElem;\n            if (!rangeElem) {\n                e.preventDefault();\n                return;\n            }\n            var currentQuote = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n            var $quote;\n\n            if (currentQuote) {\n                // 说明当前在quote之内，不做任何处理\n                e.preventDefault();\n                return;\n            }\n\n            rangeElem = editor.getLegalTags(rangeElem);\n            $rangeElem = $(rangeElem);\n\n            // 无文字，则不允许执行引用\n            if (!$rangeElem.text()) {\n                return;\n            }\n\n\n            if (!rangeElem) {\n                // 执行默认命令\n                // IE8 下执行此处（不过，经测试代码无效，也不报错）\n                editor.command(e, 'formatBlock', 'blockquote');\n                return;\n            }\n\n            // 自定义command事件\n            function commandFn() {\n                $quote = $('<p>' + $rangeElem.text() + '</p>');\n                $rangeElem.after($quote).remove();\n                $quote.wrap('<blockquote>');\n            }\n\n            // 自定义 callback 事件\n            function callback() {\n                // callback中，设置range为quote\n                var editor = this;\n                if ($quote) {\n                    editor.restoreSelectionByElem($quote.get(0));\n                }\n            }\n\n            // 执行自定义命令\n            editor.customCommand(e, commandFn, callback);\n        };\n\n        // 定义选中状态下的click事件\n        menu.clickEventSelected = function (e) {\n            var rangeElem;\n            var quoteElem;\n            var $lastChild;\n\n            // 获取当前选区的elem，并试图往上找 quote 元素\n            rangeElem = editor.getRangeElem();\n            quoteElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n            if (!quoteElem) {\n                // 没找到，则返回\n                e.preventDefault();\n                return;\n            }\n\n            // 自定义的command事件\n            function commandFn() {\n                var $quoteElem;\n                var $children;\n\n                $quoteElem = $(quoteElem);\n                $children = $quoteElem.children();\n                if ($children.length) {\n                    $children.each(function (k) {\n                        var $item = $(this);\n                        if ($item.get(0).nodeName === 'P') {\n                            $quoteElem.after($item);\n                        } else {\n                            $quoteElem.after('<p>' + $item.text() + '</p>');\n                        }\n                        $lastChild = $item;  // 记录最后一个子元素，用于callback中的range定位\n                    });\n                    $quoteElem.remove();\n                    return;\n                }\n            }\n\n            // 自定义的callback函数\n            function callback() {\n                // callback中，设置range为lastChild\n                var editor = this;\n                if ($lastChild) {\n                    editor.restoreSelectionByElem($lastChild.get(0));\n                }\n            }\n\n            // 执行自定义命令\n            editor.customCommand(e, commandFn, callback);\n        };\n\n        // 定义更新选中状态的事件\n        menu.updateSelectedEvent = function () {\n            var self = this; //菜单对象\n            var editor = self.editor;\n            var rangeElem;\n\n            rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n\n            if (rangeElem) {\n                return true;\n            }\n\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n\n        // --------------- 两次点击 enter 跳出引用 ---------------\n        editor.ready(function () {\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            var isPrevEnter = false;  // 是不是刚刚在quote中按了 enter 键\n            $txt.on('keydown', function (e) {\n                if (e.keyCode !== 13) {\n                    // 不是 enter 键\n                    isPrevEnter = false;\n                    return;\n                }\n\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                if (!rangeElem) {\n                    // 选区不是 quote\n                    isPrevEnter = false;\n                    return;\n                }\n\n                if (!isPrevEnter) {\n                    // 最近没有在qote中按enter键\n                    isPrevEnter = true;\n                    return;\n                }\n\n                var currentRangeElem = editor.getRangeElem();\n                var $currentRangeElem = $(currentRangeElem);\n                if ($currentRangeElem.length) {\n                    $currentRangeElem.parent().after($currentRangeElem);\n                }\n\n                // 设置选区\n                editor.restoreSelectionByElem(currentRangeElem, 'start');\n\n                isPrevEnter = false;\n                // 阻止默认行文\n                e.preventDefault();\n\n            });\n        }); // editor.ready(\n\n        // --------------- 处理quote中无内容时不能删除的问题 ---------------\n        editor.ready(function () {\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            var $rangeElem;\n\n            function commandFn() {\n                $rangeElem && $rangeElem.remove();\n            }\n            function callback() {\n                if (!$rangeElem) {\n                    return;\n                }\n                var $prev = $rangeElem.prev();\n                if ($prev.length) {\n                    // 有 prev 则定位到 prev 最后\n                    editor.restoreSelectionByElem($prev.get(0));\n                } else {\n                    // 无 prev 则初始化选区\n                    editor.initSelection();\n                }\n            }\n\n            $txt.on('keydown', function (e) {\n                if (e.keyCode !== 8) {\n                    // 不是 backspace 键\n                    return;\n                }\n\n                var rangeElem = editor.getRangeElem();\n                rangeElem = editor.getSelfOrParentByName(rangeElem, 'blockquote');\n                if (!rangeElem) {\n                    // 选区不是 quote\n                    return;\n                }\n                $rangeElem = $(rangeElem);\n\n                var text = $rangeElem.text();\n                if (text) {\n                    // quote 中还有内容\n                    return;\n                }\n                editor.customCommand(e, commandFn, callback);\n\n            }); // $txt.on\n        }); // editor.ready(\n    });\n\n});\n// 字体 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'fontfamily';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var configFamilys = editor.config.familys;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.fontfamily,\n            commandName: 'fontName'\n        });\n\n        // 初始化数据\n        var data  = {};\n        /*\n            data 需要的结构\n            {\n                'commandValue': 'title'\n                ...\n            }\n        */\n        $.each(configFamilys, function (k, v) {\n            // configFamilys 是数组，data 是对象\n            data[v] = v;\n        });\n\n        // 创建droplist\n        var tpl = '<span style=\"font-family:{#commandValue};\">{#title}</span>';\n        menu.dropList = new E.DropList(editor, menu, {\n            data: data,\n            tpl: tpl,\n            selectorForELemCommand: 'font[face]'  // 为了执行 editor.commandForElem 而传入的elem查询方式\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[face]');\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n});\n// 字号 菜单\n_e(function (E, $) {\n    E.createMenu(function (check) {\n        var menuId = 'fontsize';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var configSize = editor.config.fontsizes;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.fontsize,\n            commandName: 'fontSize'\n        });\n\n        // 初始化数据\n        var data  = configSize;\n        /*\n            data 需要的结构\n            {\n                'commandValue': 'title'\n                ...\n            }\n        */\n\n        // 创建droplist\n        var tpl = '<span style=\"font-size:{#title};\">{#title}</span>';\n        menu.dropList = new E.DropList(editor, menu, {\n            data: data,\n            tpl: tpl,\n            selectorForELemCommand: 'font[size]'  // 为了执行 editor.commandForElem 而传入的elem查询方式\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'font[size]');\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n});\n// head 菜单\n_e(function (E, $) {\n    E.createMenu(function (check) {\n        var menuId = 'head';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.head,\n            commandName: 'formatBlock'\n        });\n\n        // 初始化数据\n        var data  = {\n            '<h1>': '标题1',\n            '<h2>': '标题2',\n            '<h3>': '标题3',\n            '<h4>': '标题4',\n            '<h5>': '标题5'\n        };\n        /*\n            data 需要的结构\n            {\n                'commandValue': 'title'\n                ...\n            }\n        */\n\n        var isOrderedList;\n        function beforeEvent(e) {\n            if (editor.queryCommandState('InsertOrderedList')) {\n                isOrderedList = true;\n\n                // 先取消有序列表\n                editor.command(e, 'InsertOrderedList');\n            } else {\n                isOrderedList = false;\n            }\n        }\n\n        function afterEvent(e) {\n            if (isOrderedList) {\n                // 再设置有序列表\n                editor.command(e, 'InsertOrderedList');\n            }\n        }\n\n        // 创建droplist\n        var tpl = '{#commandValue}{#title}';\n        menu.dropList = new E.DropList(editor, menu, {\n            data: data,\n            tpl: tpl,\n            // 对 ol 直接设置 head，会出现每个 li 的 index 都变成 1 的问题，因此要先取消 ol，然后设置 head，最后再增加上 ol\n            beforeEvent: beforeEvent,\n            afterEvent: afterEvent\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'h1,h2,h3,h4,h5');\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n});\n// unorderlist 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'unorderlist';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.unorderlist,\n            commandName: 'InsertUnorderedList'\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// orderlist 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'orderlist';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.orderlist,\n            commandName: 'InsertOrderedList'\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// alignleft 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'alignleft';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.alignleft,\n            commandName: 'JustifyLeft'\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                var cssText;\n                if (elem && elem.style && elem.style.cssText != null) {\n                    cssText = elem.style.cssText;\n                    if (cssText && /text-align:\\s*left;/.test(cssText)) {\n                        return true;\n                    }\n                }\n                if ($(elem).attr('align') === 'left') {\n                    // ff 中，设置align-left之后，会是 <p align=\"left\">xxx</p>\n                    return true;\n                }\n                return false;\n            });\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// aligncenter 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'aligncenter';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.aligncenter,\n            commandName: 'JustifyCenter'\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                var cssText;\n                if (elem && elem.style && elem.style.cssText != null) {\n                    cssText = elem.style.cssText;\n                    if (cssText && /text-align:\\s*center;/.test(cssText)) {\n                        return true;\n                    }\n                }\n                if ($(elem).attr('align') === 'center') {\n                    // ff 中，设置align-center之后，会是 <p align=\"center\">xxx</p>\n                    return true;\n                }\n                return false;\n            });\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// alignright 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'alignright';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.alignright,\n            commandName: 'JustifyRight'\n        });\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,li', function (elem) {\n                var cssText;\n                if (elem && elem.style && elem.style.cssText != null) {\n                    cssText = elem.style.cssText;\n                    if (cssText && /text-align:\\s*right;/.test(cssText)) {\n                        return true;\n                    }\n                }\n                if ($(elem).attr('align') === 'right') {\n                    // ff 中，设置align-right之后，会是 <p align=\"right\">xxx</p>\n                    return true;\n                }\n                return false;\n            });\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// link 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'link';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.link\n        });\n\n        // 创建 dropPanel\n        var $content = $('<div></div>');\n        var $div1 = $('<div style=\"margin:20px 10px;\" class=\"clearfix\"></div>');\n        var $div2 = $div1.clone();\n        var $div3 = $div1.clone().css('margin', '0 10px');\n        var $textInput = $('<input type=\"text\" class=\"block\" placeholder=\"' + lang.text + '\"/>');\n        var $urlInput = $('<input type=\"text\" class=\"block\" placeholder=\"' + lang.link + '\"/>');\n        var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n        var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n        $div1.append($textInput);\n        $div2.append($urlInput);\n        $div3.append($btnSubmit).append($btnCancel);\n        $content.append($div1).append($div2).append($div3);\n        \n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 300\n        });\n\n        // 定义click事件\n        menu.clickEvent = function (e) {\n            var menu = this;\n            var dropPanel = menu.dropPanel;\n\n            // -------------隐藏----------------\n            if (dropPanel.isShowing) {\n                dropPanel.hide();\n                return;\n            }\n\n            // -------------显示----------------\n\n            // 重置 input\n            $textInput.val('');\n            $urlInput.val('http://');\n\n            // 获取url\n            var url = '';\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'a');\n            if (rangeElem) {\n                url = rangeElem.href || '';\n            }\n\n            // 获取 text\n            var text = '';\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 选区不是空\n                text = editor.getRangeText() || '';\n            } else if (rangeElem) {\n                // 如果选区空，并且在 a 标签之内\n                text = rangeElem.textContent || rangeElem.innerHTML;\n            }\n\n            // 设置 url 和 text\n            url && $urlInput.val(url);\n            text && $textInput.val(text);\n\n            // 如果有选区内容，textinput 不能修改\n            if (!isRangeEmpty) {\n                $textInput.attr('disabled', true);\n            } else {\n                $textInput.removeAttr('disabled');\n            }\n\n            // 显示（要设置好了所有input的值和属性之后再显示）\n            dropPanel.show();\n        };\n\n        // 定义 update selected 事件\n        menu.updateSelectedEvent = function () {\n            var rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'a');\n            if (rangeElem) {\n                return true;\n            }\n            return false;\n        };\n\n        // 『取消』 按钮\n        $btnCancel.click(function (e) {\n            e.preventDefault();\n            menu.dropPanel.hide();\n        });\n\n        // 『确定』按钮\n        $btnSubmit.click(function (e) {\n            e.preventDefault();\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getSelfOrParentByName(rangeElem, 'a');\n            var isRangeEmpty = editor.isRangeEmpty();\n\n            var $linkElem, linkHtml;\n            var commandFn, callback;\n            var $txt = editor.txt.$txt;\n            var $oldLinks, $newLinks;\n            var uniqId = 'link' + E.random();\n\n            // 获取数据\n            var url = $.trim($urlInput.val());\n            var text = $.trim($textInput.val());\n\n            if (!url) {\n                menu.dropPanel.focusFirstInput();\n                return;\n            }\n            if (!text) {\n                text = url;\n            }\n\n            if (!isRangeEmpty) {\n                // 选中区域有内容，则执行默认命令\n\n                // 获取目前 txt 内所有链接，并为当前链接做一个标记\n                $oldLinks = $txt.find('a');\n                $oldLinks.attr(uniqId, '1');\n\n                // 执行命令 \n                editor.command(e, 'createLink', url);\n\n                // 去的没有标记的链接，即刚刚插入的链接\n                $newLinks = $txt.find('a').not('[' + uniqId + ']');\n                $newLinks.attr('target', '_blank'); // 增加 _blank\n\n                // 去掉之前做的标记\n                $oldLinks.removeAttr(uniqId);\n\n            } else if (targetElem) {\n                // 无选中区域，在 a 标签之内，修改该 a 标签的内容和链接\n                $linkElem = $(targetElem);\n                commandFn = function () {\n                    $linkElem.attr('href', url);\n                    $linkElem.text(text);\n                };\n                callback = function () {\n                    var editor = this;\n                    editor.restoreSelectionByElem(targetElem);\n                };\n                // 执行命令\n                editor.customCommand(e, commandFn, callback);\n            } else {\n                // 无选中区域，不在 a 标签之内，插入新的链接\n\n                linkHtml = '<a href=\"' + url + '\" target=\"_blank\">' + text + '</a>';\n                if (E.userAgent.indexOf('Firefox') > 0) {\n                    linkHtml += '<span>&nbsp;</span>';\n                }\n                editor.command(e, 'insertHtml', linkHtml);\n            }\n\n        });\n        \n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// unlink 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'unlink';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.unlink,\n            commandName: 'unLink'\n        });\n\n        // click 事件\n        menu.clickEvent = function  (e) {\n            var isRangeEmpty = editor.isRangeEmpty();\n            if (!isRangeEmpty) {\n                // 有选中区域，或者IE8，执行默认命令\n                editor.command(e, 'unLink');\n                return;\n            }\n\n            // 无选中区域...\n\n            var rangeElem = editor.getRangeElem();\n            var aElem = editor.getSelfOrParentByName(rangeElem, 'a');\n            if (!aElem) {\n                // 不在 a 之内，返回\n                e.preventDefault();\n                return;\n            }\n\n            // 在 a 之内\n            var $a = $(aElem);\n            var $span = $('<span>' + $a.text() + '</span>');\n            function commandFn() {\n                $a.after($span).remove();\n            }\n            function callback() {\n                editor.restoreSelectionByElem($span.get(0));\n            }\n            editor.customCommand(e, commandFn, callback);\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// table 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'table';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.table\n        });\n\n        // dropPanel 内容\n        var $content = $('<div style=\"font-size: 14px; color: #666; text-align:right;\"></div>');\n        var $table = $('<table class=\"choose-table\" style=\"margin-bottom:10px;margin-top:5px;\">');\n        var $row = $('<span>0</span>');\n        var $rowspan = $('<span> 行 </span>');\n        var $col = $('<span>0</span>');\n        var $colspan = $('<span> 列</span>');\n        var $tr;\n        var i, j;\n\n        // 创建一个n行n列的表格\n        for (i = 0; i < 15; i++) {\n            $tr = $('<tr index=\"' + (i + 1) + '\">');\n            for (j = 0; j < 20; j++) {\n                $tr.append($('<td index=\"' + (j + 1) + '\">'));\n            }\n            $table.append($tr);\n        }\n        $content.append($table);\n        $content.append($row).append($rowspan).append($col).append($colspan);\n\n        // 定义table事件\n        $table.on('mouseenter', 'td', function (e) {\n            var $currentTd = $(e.currentTarget);\n            var currentTdIndex = $currentTd.attr('index');\n            var $currentTr = $currentTd.parent();\n            var currentTrIndex = $currentTr.attr('index');\n\n            // 显示\n            $row.text(currentTrIndex);\n            $col.text(currentTdIndex);\n\n            // 遍历设置背景颜色\n            $table.find('tr').each(function () {\n                var $tr = $(this);\n                var trIndex = $tr.attr('index');\n                if (parseInt(trIndex, 10) <= parseInt(currentTrIndex, 10)) {\n                    // 该行需要可能需要设置背景色\n                    $tr.find('td').each(function () {\n                        var $td = $(this);\n                        var tdIndex = $td.attr('index');\n                        if (parseInt(tdIndex, 10) <= parseInt(currentTdIndex, 10)) {\n                            // 需要设置背景色\n                            $td.addClass('active');\n                        } else {\n                            // 需要移除背景色\n                            $td.removeClass('active');\n                        }\n                    });\n                } else {\n                    // 改行不需要设置背景色\n                    $tr.find('td').removeClass('active');\n                }\n            });\n        }).on('mouseleave', function (e) {\n            // mouseleave 删除背景色\n            $table.find('td').removeClass('active');\n\n            $row.text(0);\n            $col.text(0);\n        });\n\n        // 插入表格\n        $table.on('click', 'td', function (e) {\n            var $currentTd = $(e.currentTarget);\n            var currentTdIndex = $currentTd.attr('index');\n            var $currentTr = $currentTd.parent();\n            var currentTrIndex = $currentTr.attr('index');\n\n            var rownum = parseInt(currentTrIndex, 10);\n            var colnum = parseInt(currentTdIndex, 10);\n\n            // -------- 拼接tabel html --------\n\n            var i, j;\n            var tableHtml = '<table>';\n            for (i = 0; i < rownum; i++) {\n                tableHtml += '<tr>';\n\n                for (j = 0; j < colnum; j++) {\n                    tableHtml += '<td><span>&nbsp;</span></td>';\n                }\n                tableHtml += '</tr>';\n            }\n            tableHtml += '</table>';\n\n            // -------- 执行命令 --------\n            editor.command(e, 'insertHtml', tableHtml);\n        });\n\n        // 创建 panel\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 262\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// emotion 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'emotion';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var config = editor.config;\n        var lang = config.lang;\n        var configEmotions = config.emotions;\n        var emotionsShow = config.emotionsShow;\n\n        // 记录每一个表情图片的地址\n        editor.emotionUrls = [];\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.emotion\n        });\n\n        // 添加表情图片的函数\n        function insertEmotionImgs(data, $tabContent) {\n            // 添加表情图片\n            $.each(data, function (k, emotion) {\n                var src = emotion.icon || emotion.url;\n                var value = emotion.value || emotion.title;\n                // 通过配置 editor.config.emotionsShow 的值来修改插入到编辑器的内容（图片/value）\n                var commandValue = emotionsShow === 'icon' ? src : value;\n                var $command = $('<a href=\"#\" commandValue=\"' + commandValue + '\"></a>');\n                var $img = $('<img>');\n                $img.attr('_src', src);  // 先将 src 复制到 '_src' 属性，先不加载\n\n                $command.append($img);\n                $tabContent.append($command);\n\n                // 记录下每一个表情图片的地址\n                editor.emotionUrls.push(src);\n            });\n        }\n\n        // 拼接 dropPanel 内容\n        var $panelContent = $('<div class=\"panel-tab\"></div>');\n        var $tabContainer = $('<div class=\"tab-container\"></div>');\n        var $contentContainer = $('<div class=\"content-container emotion-content-container\"></div>');\n        $.each(configEmotions, function (k, emotion) {\n            var title = emotion.title;\n            var data = emotion.data;\n\n            E.log('正在处理 ' + title + ' 表情的数据...');\n\n            // 增加该组表情的tab和content\n            var $tab = $('<a href=\"#\">' + title +' </a>');\n            $tabContainer.append($tab);\n            var $tabContent = $('<div class=\"content\"></div>');\n            $contentContainer.append($tabContent);\n\n            // tab 切换事件\n            $tab.click(function (e) {\n                $tabContainer.children().removeClass('selected');\n                $contentContainer.children().removeClass('selected');\n                $tabContent.addClass('selected');\n                $tab.addClass('selected');\n                e.preventDefault();\n            });\n\n            // 处理data\n            if (typeof data === 'string') {\n                // url 形式，需要通过ajax从该url获取数据\n                E.log('将通过 ' + data + ' 地址ajax下载表情包');\n                $.get(data, function (result) {\n                    result = $.parseJSON(result);\n                    E.log('下载完毕，得到 ' + result.length + ' 个表情');\n                    insertEmotionImgs(result, $tabContent);\n                });\n                \n            } else if ( Object.prototype.toString.call(data).toLowerCase().indexOf('array') > 0 ) {\n                // 数组，即 data 直接就是表情包数据\n                insertEmotionImgs(data, $tabContent);\n            } else {\n                // 其他情况，data格式不对\n                E.error('data 数据格式错误，请修改为正确格式，参考文档：' + E.docsite);\n                return;\n            }\n        });\n        $panelContent.append($tabContainer).append($contentContainer);\n\n        // 默认显示第一个tab\n        $tabContainer.children().first().addClass('selected');\n        $contentContainer.children().first().addClass('selected');\n\n        // 插入表情command事件\n        $contentContainer.on('click', 'a[commandValue]', function (e) {\n            var $a = $(e.currentTarget);\n            var commandValue = $a.attr('commandValue');\n            var img;\n\n            // commandValue 有可能是图片url，也有可能是表情的 value，需要区别对待\n\n            if (emotionsShow === 'icon') {\n                // 插入图片\n                editor.command(e, 'InsertImage', commandValue);\n            } else {\n                // 插入value\n                editor.command(e, 'insertHtml', '<span>' + commandValue + '</span>');\n            }\n\n            e.preventDefault();\n        });\n\n        // 添加panel\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $panelContent,\n            width: 350\n        });\n\n        // 定义click事件（异步加载表情图片）\n        menu.clickEvent = function (e) {\n            var menu = this;\n            var dropPanel = menu.dropPanel;\n\n            // -------------隐藏-------------\n            if (dropPanel.isShowing) {\n                dropPanel.hide();\n                return;\n            }\n\n            // -------------显示-------------\n            dropPanel.show();\n\n            // 异步加载图片\n            if (menu.imgLoaded) {\n                return;\n            }\n            $contentContainer.find('img').each(function () {\n                var $img = $(this);\n                var _src = $img.attr('_src');\n                $img.on('error', function () {\n                    E.error('加载不出表情图片 ' + _src);\n                });\n                $img.attr('src', _src);\n                $img.removeAttr('_src');\n            });\n            menu.imgLoaded = true;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// img 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'img';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.img\n        });\n\n        // 创建 panel content\n        var $panelContent = $('<div class=\"panel-tab\"></div>');\n        var $tabContainer = $('<div class=\"tab-container\"></div>');\n        var $contentContainer = $('<div class=\"content-container\"></div>');\n        $panelContent.append($tabContainer).append($contentContainer);\n\n        // tab\n        var $uploadTab = $('<a href=\"#\">' + lang.uploadImg + '</a>');\n        var $linkTab = $('<a href=\"#\">' + lang.linkImg + '</a>');\n        $tabContainer.append($uploadTab).append($linkTab);\n\n        // 上传图片 content\n        var $uploadContent = $('<div class=\"content\"></div>');\n        $contentContainer.append($uploadContent);\n\n        // 网络图片 content\n        var $linkContent = $('<div class=\"content\"></div>');\n        $contentContainer.append($linkContent);\n        linkContentHandler(editor, menu, $linkContent);\n\n        // 添加panel\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $panelContent,\n            width: 400,\n            onRender: function () {\n                // 渲染后的回调事件，用于执行自定义上传的init\n                // 因为渲染之后，上传面板的dom才会被渲染到页面，才能让第三方空间获取到\n                var init = editor.config.customUploadInit;\n                init && init.call(editor);\n            }\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n\n        // tab 切换事件\n        function tabToggle() {\n            $uploadTab.click(function (e) {\n                $tabContainer.children().removeClass('selected');\n                $contentContainer.children().removeClass('selected');\n                $uploadContent.addClass('selected');\n                $uploadTab.addClass('selected');\n                e.preventDefault();\n            });\n            $linkTab.click(function (e) {\n                $tabContainer.children().removeClass('selected');\n                $contentContainer.children().removeClass('selected');\n                $linkContent.addClass('selected');\n                $linkTab.addClass('selected');\n                e.preventDefault();\n\n                // focus input\n                if (E.placeholder) {\n                    $linkContent.find('input[type=text]').focus();\n                }\n            });\n\n            // 默认情况\n            // $uploadTab.addClass('selected');\n            // $uploadContent.addClass('selected');\n            $uploadTab.click();\n        }\n\n        // 隐藏上传图片\n        function hideUploadImg() {\n            $tabContainer.remove();\n            $uploadContent.remove();\n            $linkContent.addClass('selected');\n        }\n\n        // 隐藏网络图片\n        function hideLinkImg() {\n            $tabContainer.remove();\n            $linkContent.remove();\n            $uploadContent.addClass('selected');\n        }\n\n        // 判断用户是否配置了上传图片\n        editor.ready(function () {\n            var editor = this;\n            var config = editor.config;\n            var uploadImgUrl = config.uploadImgUrl;\n            var customUpload = config.customUpload;\n            var linkImg = config.hideLinkImg;\n            var $uploadImgPanel;\n\n            if (uploadImgUrl || customUpload) {\n                // 第一，暴露出 $uploadContent 以便用户自定义 ！！！重要\n                editor.$uploadContent = $uploadContent;\n\n                // 第二，绑定tab切换事件\n                tabToggle();\n\n                if (linkImg) {\n                    // 隐藏网络图片\n                    hideLinkImg();\n                }\n            } else {\n                // 未配置上传图片功能\n                hideUploadImg();\n            }\n\n            // 点击 $uploadContent 立即隐藏 dropPanel\n            // 为了兼容IE8、9的上传，因为IE8、9使用 modal 上传\n            // 这里使用异步，为了不妨碍高级浏览器通过点击 $uploadContent 选择文件\n            function hidePanel() {\n                menu.dropPanel.hide();\n            }\n            $uploadContent.click(function () {\n                setTimeout(hidePanel);\n            });\n        });\n    });\n\n    // --------------- 处理网络图片content ---------------\n    function linkContentHandler (editor, menu, $linkContent) {\n        var lang = editor.config.lang;\n        var $urlContainer = $('<div style=\"margin:20px 10px 10px 10px;\"></div>');\n        var $urlInput = $('<input type=\"text\" class=\"block\" placeholder=\"http://\"/>');\n        $urlContainer.append($urlInput);\n        var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n        var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n        $linkContent.append($urlContainer).append($btnSubmit).append($btnCancel);\n\n        // 取消\n        $btnCancel.click(function (e) {\n            e.preventDefault();\n            menu.dropPanel.hide();\n        });\n\n        // callback \n        function callback() {\n            $urlInput.val('');\n        }\n\n        // 确定\n        $btnSubmit.click(function (e) {\n            e.preventDefault();\n            var url = $.trim($urlInput.val());\n            if (!url) {\n                // 无内容\n                $urlInput.focus();\n                return;\n            }\n\n            var imgHtml = '<img style=\"max-width:100%;\" src=\"' + url + '\"/>';\n            editor.command(e, 'insertHtml', imgHtml, callback);\n        });\n    }\n\n});\n// video 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'video';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n        var reg = /^<(iframe)|(embed)/i;  // <iframe... 或者 <embed... 格式\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.video\n        });\n\n        // 创建 panel 内容\n        var $content = $('<div></div>');\n        var $linkInputContainer = $('<div style=\"margin:20px 10px;\"></div>');\n        var $linkInput = $('<input type=\"text\" class=\"block\" placeholder=\\'格式如：<iframe src=\"...\" frameborder=0 allowfullscreen></iframe>\\'/>');\n        $linkInputContainer.append($linkInput);\n        var $sizeContainer = $('<div style=\"margin:20px 10px;\"></div>');\n        var $widthInput = $('<input type=\"text\" value=\"640\" style=\"width:50px;text-align:center;\"/>');\n        var $heightInput = $('<input type=\"text\" value=\"498\" style=\"width:50px;text-align:center;\"/>');\n        $sizeContainer.append('<span> ' + lang.width + ' </span>')\n                      .append($widthInput)\n                      .append('<span> px &nbsp;&nbsp;&nbsp;</span>')\n                      .append('<span> ' + lang.height + ' </span>')\n                      .append($heightInput)\n                      .append('<span> px </span>');\n        var $btnContainer = $('<div></div>');\n        var $howToCopy = $('<a href=\"http://www.kancloud.cn/wangfupeng/wangeditor2/134973\" target=\"_blank\" style=\"display:inline-block;margin-top:10px;margin-left:10px;color:#999;\">如何复制视频链接？</a>');\n        var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n        var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n        $btnContainer.append($howToCopy).append($btnSubmit).append($btnCancel);\n        $content.append($linkInputContainer).append($sizeContainer).append($btnContainer);\n\n        // 取消按钮\n        $btnCancel.click(function (e) {\n            e.preventDefault();\n            $linkInput.val('');\n            menu.dropPanel.hide();\n        });\n\n        // 确定按钮\n        $btnSubmit.click(function (e) {\n            e.preventDefault();\n            var link = $.trim($linkInput.val());\n            var $link;\n            var width = parseInt($widthInput.val());\n            var height = parseInt($heightInput.val());\n            var $div = $('<div>');\n            var html = '<p>{content}</p>';\n\n            // 验证数据\n            if (!link) {\n                menu.dropPanel.focusFirstInput();\n                return;\n            }\n\n            if (!reg.test(link)) {\n                alert('视频链接格式错误！');\n                menu.dropPanel.focusFirstInput();\n                return;\n            }\n\n            if (isNaN(width) || isNaN(height)) {\n                alert('宽度或高度不是数字！');\n                return;\n            }\n\n            $link = $(link);\n\n            // 设置高度和宽度\n            $link.attr('width', width)\n                 .attr('height', height);\n\n            // 拼接字符串\n            html = html.replace('{content}', $div.append($link).html());\n\n            // 执行命令\n            editor.command(e, 'insertHtml', html);\n            $linkInput.val('');\n        });\n\n        // 创建panel\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 400\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// location 菜单\n_e(function (E, $) {\n\n    // 判断浏览器的 input 是否支持 keyup\n    var inputKeyup = (function (input) {\n        return 'onkeyup' in input;\n    })(document.createElement('input'));\n\n    // 百度地图的key\n    E.baiduMapAk = 'TVhjYjq1ICT2qqL5LdS8mwas';\n\n    // 一个页面中，如果有多个编辑器，地图会出现问题。这个参数记录一下，如果超过 1 就提示\n    E.numberOfLocation = 0;\n\n    E.createMenu(function (check) {\n        var menuId = 'location';\n        if (!check(menuId)) {\n            return;\n        }\n\n        if (++E.numberOfLocation > 1) {\n            E.error('目前不支持在一个页面多个编辑器上同时使用地图，可通过自定义菜单配置去掉地图菜单');\n            return;\n        }\n\n        var editor = this;\n        var config = editor.config;\n        var lang = config.lang;\n        var ak = config.mapAk;\n\n        // 地图的变量存储到这个地方\n        editor.mapData = {};\n        var mapData = editor.mapData;\n\n        // ---------- 地图事件 ----------\n        mapData.markers = [];\n        mapData.mapContainerId = 'map' + E.random();\n\n        mapData.clearLocations = function () {\n            var map = mapData.map;\n            if (!map) {\n                return;\n            }\n            map.clearOverlays();\n\n            //同时，清空marker数组\n            mapData.markers = [];\n        };\n\n        mapData.searchMap = function () {\n            var map = mapData.map;\n            if (!map) {\n                return;\n            }\n\n            var BMap = window.BMap;\n            var cityName = $cityInput.val();\n            var locationName = $searchInput.val();\n            var myGeo, marker;\n\n            if(cityName !== ''){\n                if(!locationName || locationName === ''){\n                    map.centerAndZoom(cityName, 11);\n                }\n\n                //地址解析\n                if(locationName && locationName !== ''){\n                    myGeo = new BMap.Geocoder();\n                    // 将地址解析结果显示在地图上,并调整地图视野\n                    myGeo.getPoint(locationName, function(point){\n                        if (point) {\n                            map.centerAndZoom(point, 13);\n                            marker = new BMap.Marker(point);\n                            map.addOverlay(marker);\n                            marker.enableDragging();  //允许拖拽\n                            mapData.markers.push(marker);  //将marker加入到数组中\n                        }else{\n                            // alert('未找到');\n                            map.centerAndZoom(cityName, 11);  //找不到则重新定位到城市\n                        }\n                    }, cityName);\n                }\n            } // if(cityName !== '')\n        };\n\n        // load script 之后的 callback\n        var hasCallback = false;\n        window.baiduMapCallBack = function(){\n            // 避免重复加载\n            if (hasCallback) {\n                return;\n            } else {\n                hasCallback = true;\n            }\n\n            var BMap = window.BMap;\n            if (!mapData.map) {\n                // 创建Map实例\n                mapData.map = new BMap.Map(mapData.mapContainerId);\n            }\n            var map = mapData.map;\n\n            map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  // 初始化地图,设置中心点坐标和地图级别\n            map.addControl(new BMap.MapTypeControl());   //添加地图类型控件\n            map.setCurrentCity(\"北京\");          // 设置地图显示的城市 此项是必须设置的\n            map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放\n\n            //根据IP定位\n            function locationFun(result){\n                var cityName = result.name;\n                map.setCenter(cityName);\n\n                // 设置城市名称\n                $cityInput.val(cityName);\n                if (E.placeholder) {\n                    $searchInput.focus();\n                }\n                var timeoutId, searchFn;\n                if (inputKeyup) {\n                   // 并绑定搜索事件 - input 支持 keyup\n                   searchFn = function (e) {\n                       if (e.type === 'keyup' && e.keyCode === 13) {\n                           e.preventDefault();\n                       }\n                       if (timeoutId) {\n                           clearTimeout(timeoutId);\n                       }\n                       timeoutId = setTimeout(mapData.searchMap, 500);\n                   };\n                   $cityInput.on('keyup change paste', searchFn);\n                   $searchInput.on('keyup change paste', searchFn); \n                } else {\n                    // 并绑定搜索事件 - input 不支持 keyup\n                    searchFn = function () {\n                        if (!$content.is(':visible')) {\n                            // panel 不显示了，就不用再监控了\n                            clearTimeout(timeoutId);\n                            return;\n                        }\n\n                        var currentCity = '';\n                        var currentSearch = '';\n                        var city = $cityInput.val();\n                        var search = $searchInput.val();\n\n                        if (city !== currentCity || search !== currentSearch) {\n                            // 刚获取的数据和之前的数据不一致，执行查询\n                            mapData.searchMap();\n                            // 更新数据\n                            currentCity = city;\n                            currentSearch = search;\n                        }\n\n                        // 继续监控\n                        if (timeoutId) {\n                            clearTimeout(timeoutId);\n                        }\n                        timeoutId = setTimeout(searchFn, 1000);\n                    };\n                    // 开始监控\n                    timeoutId = setTimeout(searchFn, 1000);\n                }\n            }\n            var myCity = new BMap.LocalCity();\n            myCity.get(locationFun);\n\n            //鼠标点击，创建位置\n            map.addEventListener(\"click\", function(e){\n                var marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat)); \n                map.addOverlay(marker);  \n                marker.enableDragging();\n                mapData.markers.push(marker);  //加入到数组中\n            }, false);\n        };\n\n        mapData.loadMapScript = function () {\n            var script = document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.src = \"https://api.map.baidu.com/api?v=2.0&ak=\" + ak + \"&s=1&callback=baiduMapCallBack\";  // baiduMapCallBack是一个本地函数\n            try {\n                // IE10- 报错\n                document.body.appendChild(script);\n            } catch (ex) {\n                E.error('加载地图过程中发生错误');\n            }\n        };\n\n        // 初始化地图\n        mapData.initMap = function () {\n            if (window.BMap) {\n                // 不是第一次，直接处理地图即可\n                window.baiduMapCallBack();\n            } else {\n                // 第一次，先加载地图 script，再处理地图（script加载完自动执行处理）\n                mapData.loadMapScript();\n            }\n        };\n\n        // ---------- 创建 menu 对象 ----------\n\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.location\n        });\n\n        editor.menus[menuId] = menu;\n\n        // ---------- 构建UI ----------\n\n        // panel content \n        var $content = $('<div></div>');\n\n        // 搜索框\n        var $inputContainer = $('<div style=\"margin:10px 0;\"></div>');\n        var $cityInput = $('<input type=\"text\"/>');\n        $cityInput.css({\n            width: '80px',\n            'text-align': 'center'\n        });\n        var $searchInput = $('<input type=\"text\"/>');\n        $searchInput.css({\n            width: '300px',\n            'margin-left': '10px'\n        }).attr('placeholder', lang.searchlocation);\n        var $clearBtn = $('<button class=\"right link\">' + lang.clearLocation + '</button>');\n        $inputContainer.append($clearBtn)\n                       .append($cityInput)\n                       .append($searchInput);\n        $content.append($inputContainer);\n\n        // 清除位置按钮\n        $clearBtn.click(function (e) {\n            $searchInput.val('');\n            $searchInput.focus();\n            mapData.clearLocations();\n            e.preventDefault();\n        });\n\n        // 地图\n        var $map = $('<div id=\"' + mapData.mapContainerId + '\"></div>');\n        $map.css({\n            height: '260px',\n            width: '100%',\n            position: 'relative',\n            'margin-top': '10px',\n            border: '1px solid #f1f1f1'\n        });\n        var $mapLoading = $('<span>' + lang.loading + '</span>');\n        $mapLoading.css({\n            position: 'absolute',\n            width: '100px',\n            'text-align': 'center',\n            top: '45%',\n            left: '50%',\n            'margin-left': '-50px'\n        });\n        $map.append($mapLoading);\n        $content.append($map);\n\n        // 按钮\n        var $btnContainer = $('<div style=\"margin:10px 0;\"></div>');\n        var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n        var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n        var $checkLabel = $('<label style=\"display:inline-block;margin-top:10px;color:#666;\"></label>');\n        var $check = $('<input type=\"checkbox\">');\n        $checkLabel.append($check).append('<span style=\"display:inline-block;margin-left:5px;\">  ' + lang.dynamicMap + '</span>');\n        $btnContainer.append($checkLabel)\n                     .append($btnSubmit)\n                     .append($btnCancel);\n        $content.append($btnContainer);\n\n        function callback() {\n            $searchInput.val('');\n        }\n\n        // 『取消』按钮事件\n        $btnCancel.click(function (e) {\n            e.preventDefault();\n            callback();\n            menu.dropPanel.hide();\n        });\n\n        // 『确定』按钮事件\n        $btnSubmit.click(function (e) {\n            e.preventDefault();\n            var map = mapData.map,\n                isDynamic = $check.is(':checked'),\n                markers =  mapData.markers,\n\n                center = map.getCenter(),\n                centerLng = center.lng,\n                centerLat = center.lat,\n\n                zoom = map.getZoom(),\n\n                size = map.getSize(),\n                sizeWidth = size.width,\n                sizeHeight = size.height,\n\n                position,\n                src,\n                iframe;\n\n            if(isDynamic){\n                //动态地址\n                src = 'http://ueditor.baidu.com/ueditor/dialogs/map/show.html#';\n            }else{\n                //静态地址\n                src = 'http://api.map.baidu.com/staticimage?';\n            }\n\n            //src参数\n            src = src +'center=' + centerLng + ',' + centerLat +\n                '&zoom=' + zoom +\n                '&width=' + sizeWidth +\n                '&height=' + sizeHeight;\n            if(markers.length > 0){\n                src = src + '&markers=';\n\n                //添加所有的marker\n                $.each(markers, function(key, value){\n                    position = value.getPosition();\n                    if(key > 0){\n                        src = src + '|';\n                    }\n                    src = src + position.lng + ',' + position.lat;\n                });\n            }\n\n            if(isDynamic){\n                if(markers.length > 1){\n                    alert( lang.langDynamicOneLocation );\n                    return;\n                }\n\n                src += '&markerStyles=l,A';\n\n                //插入iframe\n                iframe = '<iframe class=\"ueditor_baidumap\" src=\"{src}\" frameborder=\"0\" width=\"' + sizeWidth + '\" height=\"' + sizeHeight + '\"></iframe>';\n                iframe = iframe.replace('{src}', src);\n                editor.command(e, 'insertHtml', iframe, callback);\n            }else{\n                //插入图片\n                editor.command(e, 'insertHtml', '<img style=\"max-width:100%;\" src=\"' + src + '\"/>', callback);\n            }\n        });\n\n        // 根据 UI 创建菜单 panel\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 500\n        });\n\n        // ---------- 事件 ----------\n\n        // render 时执行事件\n        menu.onRender = function () {\n            if (ak === E.baiduMapAk) {\n                E.warn('建议在配置中自定义百度地图的mapAk，否则可能影响地图功能，文档：' + E.docsite);\n            }\n        };\n\n        // click 事件\n        menu.clickEvent = function (e) {\n            var menu = this;\n            var dropPanel = menu.dropPanel;\n            var firstTime = false;\n\n            // -------------隐藏-------------\n            if (dropPanel.isShowing) {\n                dropPanel.hide();\n                return;\n            }\n\n            // -------------显示-------------\n            if (!mapData.map) {\n                // 第一次，先加载地图\n                firstTime = true;\n            }\n            \n            dropPanel.show();\n            mapData.initMap();\n\n            if (!firstTime) {\n                $searchInput.focus();\n            }\n        };\n\n    });\n\n});\n// insertcode 菜单\n_e(function (E, $) {\n\n    // 加载 highlightjs 代码\n    function loadHljs() {\n        if (E.userAgent.indexOf('MSIE 8') > 0) {\n            // 不支持 IE8\n            return;\n        }\n        if (window.hljs) {\n            // 不要重复加载\n            return;\n        }\n        var script = document.createElement(\"script\");\n        script.type = \"text/javascript\";\n        script.src = \"//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js\";\n        document.body.appendChild(script);\n    }\n    \n\n    E.createMenu(function (check) {\n        var menuId = 'insertcode';\n        if (!check(menuId)) {\n            return;\n        }\n\n        // 加载 highlightjs 代码\n        setTimeout(loadHljs, 0);\n\n        var editor = this;\n        var config = editor.config;\n        var lang = config.lang;\n        var $txt = editor.txt.$txt;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.insertcode\n        });\n\n        // click 事件\n        menu.clickEvent = function (e) {\n            var menu = this;\n            var dropPanel = menu.dropPanel;\n\n            // 隐藏\n            if (dropPanel.isShowing) {\n                dropPanel.hide();\n                return;\n            }\n\n            // 显示\n            $textarea.val('');\n            dropPanel.show();\n\n            // highlightjs 语言列表\n            var hljs = window.hljs;\n            if (hljs && hljs.listLanguages) {\n                if ($langSelect.children().length !== 0) {\n                    return;\n                }\n                $langSelect.css({\n                    'margin-top': '9px',\n                    'margin-left': '5px'\n                });\n                $.each(hljs.listLanguages(), function (key, lang) {\n                    if (lang === 'xml') {\n                        lang = 'html';\n                    }\n                    if (lang === config.codeDefaultLang) {\n                        $langSelect.append('<option value=\"' + lang + '\" selected=\"selected\">' + lang + '</option>');\n                    } else {\n                        $langSelect.append('<option value=\"' + lang + '\">' + lang + '</option>');\n                    }\n                });\n            } else {\n                $langSelect.hide();\n            }\n        };\n\n        // 选中状态下的 click 事件\n        menu.clickEventSelected = function (e) {\n            var menu = this;\n            var dropPanel = menu.dropPanel;\n\n            // 隐藏\n            if (dropPanel.isShowing) {\n                dropPanel.hide();\n                return;\n            }\n\n            // 显示\n            dropPanel.show();\n\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n            var $targetElem;\n            var className;\n            if (targetElem) {\n                // 确定找到 pre 之后，再找 code\n                targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n            }\n            if (!targetElem) {\n                return;\n            }\n            $targetElem = $(targetElem);\n\n            // 赋值内容\n            $textarea.val($targetElem.text());\n            if ($langSelect) {\n                // 赋值语言\n                className = $targetElem.attr('class');\n                if (className) {\n                    $langSelect.val(className.split(' ')[0]);\n                }\n            }\n        };\n\n        // 定义更新选中状态的事件\n        menu.updateSelectedEvent = function () {\n            var self = this; //菜单对象\n            var editor = self.editor;\n            var rangeElem;\n\n            rangeElem = editor.getRangeElem();\n            rangeElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n\n            if (rangeElem) {\n                return true;\n            }\n\n            return false;\n        };\n\n        // 创建 panel\n        var $content = $('<div></div>');\n        var $textarea = $('<textarea></textarea>');\n        var $langSelect = $('<select></select>');\n        contentHandle($content);\n        menu.dropPanel = new E.DropPanel(editor, menu, {\n            $content: $content,\n            width: 500\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n\n        // ------ 增加 content 内容 ------\n        function contentHandle($content) {\n            // textarea 区域\n            var $textareaContainer = $('<div></div>');\n            $textareaContainer.css({\n                margin: '15px 5px 5px 5px',\n                height: '160px',\n                'text-align': 'center'\n            });\n            $textarea.css({\n                width: '100%',\n                height: '100%',\n                padding: '10px'\n            });\n            $textarea.on('keydown', function (e) {\n                // 取消 tab 键默认行为\n                if (e.keyCode === 9) {\n                    e.preventDefault();\n                }\n            });\n            $textareaContainer.append($textarea);\n            $content.append($textareaContainer);\n\n            // 按钮区域\n            var $btnContainer = $('<div></div>');\n            var $btnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n            var $btnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n            $btnContainer.append($btnSubmit).append($btnCancel).append($langSelect);\n            $content.append($btnContainer);\n\n            // 取消按钮\n            $btnCancel.click(function (e) {\n                e.preventDefault();\n                menu.dropPanel.hide();\n            });\n\n            // 确定按钮\n            var codeTpl = '<pre style=\"max-width:100%;overflow-x:auto;\"><code{#langClass}>{#content}</code></pre>';\n            $btnSubmit.click(function (e) {\n                e.preventDefault();\n                var val = $textarea.val();\n                if (!val) {\n                    // 无内容\n                    $textarea.focus();\n                    return;\n                }\n\n                var rangeElem = editor.getRangeElem();\n                if ($.trim($(rangeElem).text()) && codeTpl.indexOf('<p><br></p>') !== 0) {\n                    codeTpl = '<p><br></p>' + codeTpl;\n                }\n\n                var lang = $langSelect ? $langSelect.val() : ''; // 获取高亮语言\n                var langClass = '';\n                var doHightlight = function () {\n                    $txt.find('pre code').each(function (i, block) {\n                        var $block = $(block);\n                        if ($block.attr('codemark')) {\n                            // 有 codemark 标记的代码块，就不再重新格式化了\n                            return;\n                        } else if (window.hljs) {\n                            // 新代码块，格式化之后，立即标记 codemark\n                            window.hljs.highlightBlock(block);\n                            $block.attr('codemark', '1');\n                        }\n                    });\n                };\n\n                // 语言高亮样式\n                if (lang) {\n                    langClass = ' class=\"' + lang + ' hljs\"';\n                }\n\n                // 替换标签\n                val = val.replace(/&/gm, '&amp;')\n                         .replace(/</gm, '&lt;')\n                         .replace(/>/gm, '&gt;');\n\n                // ---- menu 未选中状态 ----\n                if (!menu.selected) {\n                    // 拼接html\n                    var html = codeTpl.replace('{#langClass}', langClass).replace('{#content}', val);\n                    editor.command(e, 'insertHtml', html, doHightlight);\n                    return;\n                }\n\n                // ---- menu 选中状态 ----\n                var targetElem = editor.getSelfOrParentByName(rangeElem, 'pre');\n                var $targetElem;\n                if (targetElem) {\n                    // 确定找到 pre 之后，再找 code\n                    targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n                }\n                if (!targetElem) {\n                    return;\n                }\n                $targetElem = $(targetElem);\n\n                function commandFn() {\n                    var className;\n                    if (lang) {\n                        className = $targetElem.attr('class');\n                        if (className !== lang + ' hljs') {\n                            $targetElem.attr('class', lang + ' hljs');\n                        }\n                    }\n                    $targetElem.html(val);\n                }\n                function callback() {\n                    editor.restoreSelectionByElem(targetElem);\n                    doHightlight();\n                }\n                editor.customCommand(e, commandFn, callback);\n            });\n        }\n\n        // ------ enter 时，不另起标签，只换行 ------\n        $txt.on('keydown', function (e) {\n            if (e.keyCode !== 13) {\n                return;\n            }\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n            if (!targetElem) {\n                return;\n            }\n\n            editor.command(e, 'insertHtml', '\\n');\n        });\n\n        // ------ 点击时，禁用其他标签 ------\n        function updateMenu() {\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getSelfOrParentByName(rangeElem, 'code');\n            if (targetElem) {\n                // 在 code 之内，禁用其他菜单\n                editor.disableMenusExcept('insertcode');\n            } else {\n                // 不是在 code 之内，启用其他菜单\n                editor.enableMenusExcept('insertcode');\n            }\n        }\n        $txt.on('keydown click', function (e) {\n            // 此处必须使用 setTimeout 异步处理，否则不对\n            setTimeout(updateMenu);\n        });\n    });\n\n});\n// undo 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'undo';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.undo\n        });\n\n        // click 事件\n        menu.clickEvent = function (e) {\n            editor.undo();\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n\n\n        // ------------ 初始化时、enter 时、打字中断时，做记录 ------------\n        // ------------ ctrl + z 是调用记录撤销，而不是使用浏览器默认的撤销 ------------\n        editor.ready(function () {\n            var editor = this;\n            var $txt = editor.txt.$txt;\n            var timeoutId;\n\n            // 执行undo记录\n            function undo() {\n                editor.undoRecord();\n            }\n\n            $txt.on('keydown', function (e) {\n                var keyCode = e.keyCode;\n\n                // 撤销 ctrl + z\n                if (e.ctrlKey && keyCode === 90) {\n                    editor.undo();\n                    return;\n                }\n\n                if (keyCode === 13) {\n                    // enter 做记录\n                    undo();\n                } else {\n                    // keyup 之后 1s 之内不操作，则做一次记录\n                    if (timeoutId) {\n                        clearTimeout(timeoutId);\n                    }\n                    timeoutId = setTimeout(undo, 1000);\n                }\n            });\n\n            // 初始化做记录\n            editor.undoRecord();\n        });\n    });\n\n});\n// redo 菜单\n_e(function (E, $) {\n\n    E.createMenu(function (check) {\n        var menuId = 'redo';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var lang = editor.config.lang;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.redo\n        });\n\n        // click 事件\n        menu.clickEvent = function (e) {\n            editor.redo();\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// 全屏 菜单\n_e(function (E, $) {\n\n    // 记录全屏时的scrollTop\n    var scrollTopWhenFullScreen;\n\n    E.createMenu(function (check) {\n        var menuId = 'fullscreen';\n        if (!check(menuId)) {\n            return;\n        }\n        var editor = this;\n        var $txt = editor.txt.$txt;\n        var config = editor.config;\n        var zIndexConfig = config.zindex || 10000;\n        var lang = config.lang;\n\n        var isSelected = false;\n        var zIndex;\n\n        var maxHeight;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,\n            id: menuId,\n            title: lang.fullscreen\n        });\n\n        // 定义click事件\n        menu.clickEvent = function (e) {\n            // 增加样式\n            var $editorContainer = editor.$editorContainer;\n            $editorContainer.addClass('wangEditor-fullscreen');\n\n            // （先保存当前的）再设置z-index\n            zIndex = $editorContainer.css('z-index');\n            $editorContainer.css('z-index', zIndexConfig);\n\n            var $wrapper;\n            var txtHeight = $txt.height();\n            var txtOuterHeight = $txt.outerHeight();\n\n            if (editor.useMaxHeight) {\n                // 记录 max-height，并暂时去掉maxheight\n                maxHeight = $txt.css('max-height');\n                $txt.css('max-height', 'none');\n\n                // 如果使用了maxHeight， 将$txt从它的父元素中移出来\n                $wrapper = $txt.parent();\n                $wrapper.after($txt);\n                $wrapper.remove();\n                $txt.css('overflow-y', 'auto');\n            }\n\n            // 设置高度到全屏\n            var menuContainer = editor.menuContainer;\n            $txt.height(\n                E.$window.height() - \n                menuContainer.height() - \n                (txtOuterHeight - txtHeight)  // 去掉内边距和外边距\n            );\n\n            // 取消menuContainer的内联样式（menu吸顶时，会为 menuContainer 设置一些内联样式）\n            editor.menuContainer.$menuContainer.attr('style', '');\n\n            // 保存状态\n            isSelected = true;\n\n            // 记录编辑器是否全屏\n            editor.isFullScreen = true;\n\n            // 记录设置全屏时的高度\n            scrollTopWhenFullScreen = E.$window.scrollTop();\n        };\n\n        // 定义选中状态的 click 事件\n        menu.clickEventSelected = function (e) {\n            // 取消样式\n            var $editorContainer = editor.$editorContainer;\n            $editorContainer.removeClass('wangEditor-fullscreen');\n            $editorContainer.css('z-index', zIndex);\n\n            // 还原height\n            if (editor.useMaxHeight) {\n                $txt.css('max-height', maxHeight);\n            } else {\n                // editor.valueContainerHeight 在 editor.txt.initHeight() 中事先保存了\n                editor.$valueContainer.css('height', editor.valueContainerHeight);\n            }\n\n            // 重新计算高度\n            editor.txt.initHeight();\n\n            // 保存状态\n            isSelected = false;\n\n            // 记录编辑器是否全屏\n            editor.isFullScreen = false;\n\n            // 还原scrollTop\n            if (scrollTopWhenFullScreen != null) {\n                E.$window.scrollTop(scrollTopWhenFullScreen);\n            }\n        };\n\n        // 定义选中事件\n        menu.updateSelectedEvent = function (e) {\n            return isSelected;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// 渲染menus\n_e(function (E, $) {\n\n    E.fn.renderMenus = function () {\n\n        var editor = this;\n        var menus = editor.menus;\n        var menuIds = editor.config.menus;\n        var menuContainer = editor.menuContainer;\n\n        var menu;\n        var groupIdx = 0;\n        $.each(menuIds, function (k, v) {\n            if (v === '|') {\n                groupIdx++;\n                return;\n            }\n\n            menu = menus[v];\n            if (menu) {\n                menu.render(groupIdx);\n            }\n        });\n    };\n\n});\n// 渲染menus\n_e(function (E, $) {\n\n    E.fn.renderMenuContainer = function () {\n\n        var editor = this;\n        var menuContainer = editor.menuContainer;\n        var $editorContainer = editor.$editorContainer;\n\n        menuContainer.render();\n\n    };\n\n});\n// 渲染 txt\n_e(function (E, $) {\n\n    E.fn.renderTxt = function () {\n\n        var editor = this;\n        var txt = editor.txt;\n\n        txt.render();\n\n        // ready 时候，计算txt的高度\n        editor.ready(function () {\n            txt.initHeight();\n        });\n    };\n\n});\n// 渲染 container\n_e(function (E, $) {\n\n    E.fn.renderEditorContainer = function () {\n\n        var editor = this;\n        var $valueContainer = editor.$valueContainer;\n        var $editorContainer = editor.$editorContainer;\n        var $txt = editor.txt.$txt;\n        var $prev, $parent;\n\n        // 将编辑器渲染到页面中\n        if ($valueContainer === $txt) {\n            $prev = editor.$prev;\n            $parent = editor.$parent;\n\n            if ($prev && $prev.length) {\n                // 有前置节点，就插入到前置节点的后面\n                $prev.after($editorContainer);\n            } else {\n                // 没有前置节点，就直接插入到父元素\n                $parent.prepend($editorContainer);\n            }\n\n        } else {\n            $valueContainer.after($editorContainer);\n            $valueContainer.hide();\n        }\n\n        // 设置宽度（这样设置宽度有问题）\n        // $editorContainer.css('width', $valueContainer.css('width'));\n    };\n\n});\n// 菜单事件\n_e(function (E, $) {\n\n    // 绑定每个菜单的click事件\n    E.fn.eventMenus = function () {\n\n        var menus = this.menus;\n\n        // 绑定菜单的点击事件\n        $.each(menus, function (k, v) {\n            v.bindEvent();\n        });\n\n    };\n\n});\n// 菜单container事件\n_e(function (E, $) {\n\n    E.fn.eventMenuContainer = function () {\n\n    };\n\n});\n// 编辑区域事件\n_e(function (E, $) {\n\n    E.fn.eventTxt = function () {\n\n        var txt = this.txt;\n\n        // txt内容变化时，保存选区\n        txt.saveSelectionEvent();\n\n        // txt内容变化时，随时更新 value\n        txt.updateValueEvent();\n\n        // txt内容变化时，随时更新 menu style\n        txt.updateMenuStyleEvent();\n\n        // // 鼠标hover时，显示 p head 高度（暂时关闭这个功能）\n        // if (!/ie/i.test(E.userAgent)) {\n        //     // 暂时不支持IE\n        //     txt.showHeightOnHover();\n        // }\n    };\n\n});\n// 上传图片事件\n_e(function (E, $) {\n\n    E.plugin(function () {\n        var editor = this;\n        var fns = editor.config.uploadImgFns; // editor.config.uploadImgFns = {} 在config文件中定义了\n\n        // -------- 定义load函数 --------\n        fns.onload || (fns.onload = function (resultText, xhr) {\n            E.log('上传结束，返回结果为 ' + resultText);\n\n            var editor = this;\n            var originalName = editor.uploadImgOriginalName || '';  // 上传图片时，已经将图片的名字存在 editor.uploadImgOriginalName\n            var img;\n            if (resultText.indexOf('error|') === 0) {\n                // 提示错误\n                E.warn('上传失败：' + resultText.split('|')[1]);\n                alert(resultText.split('|')[1]);\n            } else {\n                E.log('上传成功，即将插入编辑区域，结果为：' + resultText);\n\n                // 将结果插入编辑器\n                img = document.createElement('img');\n                img.onload = function () {\n                    var html = '<img src=\"' + resultText + '\" alt=\"' + originalName + '\" style=\"max-width:100%;\"/>';\n                    editor.command(null, 'insertHtml', html);\n\n                    E.log('已插入图片，地址 ' + resultText);\n                    img = null;\n                };\n                img.onerror = function () {\n                    E.error('使用返回的结果获取图片，发生错误。请确认以下结果是否正确：' + resultText);\n                    img = null;\n                };\n                img.src = resultText;\n            }\n\n        });\n\n        // -------- 定义tiemout函数 --------\n        fns.ontimeout || (fns.ontimeout = function (xhr) {\n            E.error('上传图片超时');\n            alert('上传图片超时');\n        });\n\n        // -------- 定义error函数 --------\n        fns.onerror || (fns.onerror = function (xhr) {\n            E.error('上传上图片发生错误');\n            alert('上传上图片发生错误');\n        });\n\n    });\n});\n// xhr 上传图片\n_e(function (E, $) {\n\n    if (!window.FileReader || !window.FormData) {\n        // 如果不支持html5的文档操作，直接返回\n        return;\n    }\n\n    E.plugin(function () {\n\n        var editor = this;\n        var config = editor.config;\n        var uploadImgUrl = config.uploadImgUrl;\n        var uploadTimeout = config.uploadTimeout;\n\n        // 获取配置中的上传事件\n        var uploadImgFns = config.uploadImgFns;\n        var onload = uploadImgFns.onload;\n        var ontimeout = uploadImgFns.ontimeout;\n        var onerror = uploadImgFns.onerror;\n\n        if (!uploadImgUrl) {\n            return;\n        }\n\n        // -------- 将以base64的图片url数据转换为Blob --------\n        function convertBase64UrlToBlob(urlData, filetype){\n            //去掉url的头，并转换为byte\n            var bytes = window.atob(urlData.split(',')[1]);\n            \n            //处理异常,将ascii码小于0的转换为大于0\n            var ab = new ArrayBuffer(bytes.length);\n            var ia = new Uint8Array(ab);\n            var i;\n            for (i = 0; i < bytes.length; i++) {\n                ia[i] = bytes.charCodeAt(i);\n            }\n\n            return new Blob([ab], {type : filetype});\n        }\n\n        // -------- 插入图片的方法 --------\n        function insertImg(src, event) {\n            var img = document.createElement('img');\n            img.onload = function () {\n                var html = '<img src=\"' + src + '\" style=\"max-width:100%;\"/>';\n                editor.command(event, 'insertHtml', html);\n\n                E.log('已插入图片，地址 ' + src);\n                img = null;\n            };\n            img.onerror = function () {\n                E.error('使用返回的结果获取图片，发生错误。请确认以下结果是否正确：' + src);\n                img = null;\n            };\n            img.src = src;\n        }\n\n        // -------- onprogress 事件 --------\n        function updateProgress(e) {\n            if (e.lengthComputable) {\n                var percentComplete = e.loaded / e.total;\n                editor.showUploadProgress(percentComplete * 100);\n            }\n        }\n\n        // -------- xhr 上传图片 --------\n        editor.xhrUploadImg = function (opt) {\n            // opt 数据\n            var event = opt.event;\n            var fileName = opt.filename || '';\n            var base64 = opt.base64;\n            var fileType = opt.fileType || 'image/png'; // 无扩展名则默认使用 png\n            var name = opt.name || 'wangEditor_upload_file';\n            var loadfn = opt.loadfn || onload;\n            var errorfn = opt.errorfn || onerror;\n            var timeoutfn = opt.timeoutfn || ontimeout;\n\n            // 上传参数（如 token）\n            var params = editor.config.uploadParams || {};\n\n            // headers\n            var headers = editor.config.uploadHeaders || {};\n\n            // 获取文件扩展名\n            var fileExt = 'png';  // 默认为 png\n            if (fileName.indexOf('.') > 0) {\n                // 原来的文件名有扩展名\n                fileExt = fileName.slice(fileName.lastIndexOf('.') - fileName.length + 1);\n            } else if (fileType.indexOf('/') > 0 && fileType.split('/')[1]) {\n                // 文件名没有扩展名，通过类型获取，如从 'image/png' 取 'png'\n                fileExt = fileType.split('/')[1];\n            }\n\n            // ------------ begin 预览模拟上传 ------------\n            if (E.isOnWebsite) {\n                E.log('预览模拟上传');\n                insertImg(base64, event);\n                return;\n            }\n            // ------------ end 预览模拟上传 ------------\n\n            // 变量声明\n            var xhr = new XMLHttpRequest();\n            var timeoutId;\n            var src;\n            var formData = new FormData();\n\n            // 超时处理\n            function timeoutCallback() {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n                if (xhr && xhr.abort) {\n                    xhr.abort();\n                }\n\n                // 超时了就阻止默认行为\n                event.preventDefault();\n\n                // 执行回调函数，提示什么内容，都应该在回调函数中定义\n                timeoutfn && timeoutfn.call(editor, xhr);\n\n                // 隐藏进度条\n                editor.hideUploadProgress();\n            }\n\n            xhr.onload = function () {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n\n                // 记录文件名到 editor.uploadImgOriginalName ，插入图片时，可做 alt 属性用\n                editor.uploadImgOriginalName = fileName;\n                if (fileName.indexOf('.') > 0) {\n                    editor.uploadImgOriginalName = fileName.split('.')[0];\n                }\n\n                // 执行load函数，任何操作，都应该在load函数中定义\n                loadfn && loadfn.call(editor, xhr.responseText, xhr);\n\n                // 隐藏进度条\n                editor.hideUploadProgress();\n            };\n            xhr.onerror = function () {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n\n                // 超时了就阻止默认行为\n                event.preventDefault();\n\n                // 执行error函数，错误提示，应该在error函数中定义\n                errorfn && errorfn.call(editor, xhr);\n\n                // 隐藏进度条\n                editor.hideUploadProgress();\n            };\n            // xhr.onprogress = updateProgress;\n            xhr.upload.onprogress = updateProgress;\n\n            // 填充数据\n            formData.append(name, convertBase64UrlToBlob(base64, fileType), E.random() + '.' + fileExt);\n\n            // 添加参数\n            $.each(params, function (key, value) {\n                formData.append(key, value);\n            });\n\n            // 开始上传\n            xhr.open('POST', uploadImgUrl, true);\n            // xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");  // 将参数解析成传统form的方式上传\n\n            // 修改自定义配置的headers\n            $.each(headers, function (key, value) {\n                xhr.setRequestHeader(key, value);\n            });\n\n            // 跨域上传时，传cookie\n            xhr.withCredentials = editor.config.withCredentials || true;\n\n            // 发送数据\n            xhr.send(formData);\n            timeoutId = setTimeout(timeoutCallback, uploadTimeout);\n\n            E.log('开始上传...并开始超时计算');\n        };\n    });\n});\n// 进度条\n_e(function (E, $) {\n\n    E.plugin(function () {\n\n        var editor = this;\n        var menuContainer = editor.menuContainer;\n        var menuHeight = menuContainer.height();\n        var $editorContainer = editor.$editorContainer;\n        var width = $editorContainer.width();\n        var $progress = $('<div class=\"wangEditor-upload-progress\"></div>');\n\n        // 渲染事件\n        var isRender = false;\n        function render() {\n            if (isRender) {\n                return;\n            }\n            isRender = true;\n\n            $progress.css({\n                top: menuHeight + 'px'\n            });\n            $editorContainer.append($progress);\n        }\n\n        // ------ 显示进度 ------\n        editor.showUploadProgress = function (progress) {\n            if (timeoutId) {\n                clearTimeout(timeoutId);\n            }\n\n            // 显示之前，先判断是否渲染\n            render();\n\n            $progress.show();\n            $progress.width(progress * width / 100);\n        };\n\n        // ------ 隐藏进度条 ------\n        var timeoutId;\n        function hideProgress() {\n            $progress.hide();\n            timeoutId = null;\n        }\n        editor.hideUploadProgress = function (time) {\n            if (timeoutId) {\n                clearTimeout(timeoutId);\n            }\n            time = time || 750;\n            timeoutId = setTimeout(hideProgress, time);\n        };\n    });\n});\n// upload img 插件\n_e(function (E, $) {\n\n    E.plugin(function () {\n        var editor = this;\n        var config = editor.config;\n        var uploadImgUrl = config.uploadImgUrl;\n        var uploadTimeout = config.uploadTimeout;\n        var event;\n\n        if (!uploadImgUrl) {\n            return;\n        }\n\n        // 获取editor的上传dom\n        var $uploadContent = editor.$uploadContent;\n        if (!$uploadContent) {\n            return;\n        }\n\n        // 自定义UI，并添加到上传dom节点上\n        var $uploadIcon = $('<div class=\"upload-icon-container\"><i class=\"wangeditor-menu-img-upload\"></i></div>');\n        $uploadContent.append($uploadIcon);\n\n        // ---------- 构建上传对象 ----------\n        var upfile = new E.UploadFile({\n            editor: editor,\n            uploadUrl: uploadImgUrl,\n            timeout: uploadTimeout,\n            fileAccept: 'image/jpg,image/jpeg,image/png,image/gif,image/bmp'    // 只允许选择图片 \n        });\n\n        // 选择本地文件，上传\n        $uploadIcon.click(function (e) {\n            event = e;\n            upfile.selectFiles();\n        });\n    });\n});\n// h5 方式上传图片\n_e(function (E, $) {\n\n    if (!window.FileReader || !window.FormData) {\n        // 如果不支持html5的文档操作，直接返回\n        return;\n    }\n\n    // 构造函数\n    var UploadFile = function (opt) {\n        this.editor = opt.editor;\n        this.uploadUrl = opt.uploadUrl;\n        this.timeout = opt.timeout;\n        this.fileAccept = opt.fileAccept;\n        this.multiple = true;\n    };\n\n    UploadFile.fn = UploadFile.prototype;\n\n    // clear\n    UploadFile.fn.clear = function () {\n        this.$input.val('');\n        E.log('input value 已清空');\n    };\n\n    // 渲染\n    UploadFile.fn.render = function () {\n        var self = this;\n        if (self._hasRender) {\n            // 不要重复渲染\n            return;\n        }\n\n        E.log('渲染dom');\n\n        var fileAccept = self.fileAccept;\n        var acceptTpl = fileAccept ? 'accept=\"' + fileAccept + '\"' : '';\n        var multiple = self.multiple;\n        var multipleTpl = multiple ? 'multiple=\"multiple\"' : '';\n        var $input = $('<input type=\"file\" ' + acceptTpl + ' ' + multipleTpl + '/>');\n        var $container = $('<div style=\"display:none;\"></div>');\n\n        $container.append($input);\n        E.$body.append($container);\n\n        // onchange 事件\n        $input.on('change', function (e) {\n            self.selected(e, $input.get(0));\n        });\n\n        // 记录对象数据\n        self.$input = $input;\n\n        // 记录\n        self._hasRender = true;\n    };\n\n    // 选择\n    UploadFile.fn.selectFiles = function () {\n        var self = this;\n\n        E.log('使用 html5 方式上传');\n\n        // 先渲染\n        self.render();\n\n        // 选择\n        E.log('选择文件');\n        self.$input.click();\n    };\n\n    // 选中文件之后\n    UploadFile.fn.selected = function (e, input) {\n        var self = this;\n        var files = input.files || [];\n        if (files.length === 0) {\n            return;\n        }\n\n        E.log('选中 ' + files.length + ' 个文件');\n\n        // 遍历选中的文件，预览、上传\n        $.each(files, function (key, value) {\n            self.upload(value);\n        });\n    };\n\n    // 上传单个文件\n    UploadFile.fn.upload = function (file) {\n        var self = this;\n        var editor = self.editor;\n        var filename = file.name || '';\n        var fileType = file.type || '';\n        var uploadImgFns = editor.config.uploadImgFns;\n        var uploadFileName = editor.config.uploadImgFileName || 'wangEditorH5File';\n        var onload = uploadImgFns.onload;\n        var ontimeout = uploadImgFns.ontimeout;\n        var onerror = uploadImgFns.onerror;\n        var reader = new FileReader();\n\n        if (!onload || !ontimeout || !onerror) {\n            E.error('请为编辑器配置上传图片的 onload ontimeout onerror 回调事件');\n            return;\n        }\n\n\n        E.log('开始执行 ' + filename + ' 文件的上传');\n\n        // 清空 input 数据\n        function clearInput() {\n            self.clear();\n        }\n\n        // onload事件\n        reader.onload = function (e) {\n            E.log('已读取' + filename + '文件');\n\n            var base64 = e.target.result || this.result;\n            editor.xhrUploadImg({\n                event: e,\n                filename: filename,\n                base64: base64,\n                fileType: fileType,\n                name: uploadFileName,\n                loadfn: function (resultText, xhr) {\n                    clearInput();\n                    // 执行配置中的方法\n                    var editor = this;\n                    onload.call(editor, resultText, xhr);\n                },\n                errorfn: function (xhr) {\n                    clearInput();\n                    if (E.isOnWebsite) {\n                        alert('wangEditor官网暂时没有服务端，因此报错。实际项目中不会发生');\n                    }\n                    // 执行配置中的方法\n                    var editor = this;\n                    onerror.call(editor, xhr);\n                },\n                timeoutfn: function (xhr) {\n                    clearInput();\n                    if (E.isOnWebsite) {\n                        alert('wangEditor官网暂时没有服务端，因此超时。实际项目中不会发生');\n                    }\n                    // 执行配置中的方法\n                    var editor = this;\n                    ontimeout(editor, xhr);\n                }\n            });\n        };\n\n        // 开始取文件\n        reader.readAsDataURL(file);\n    };\n\n    // 暴露给 E\n    E.UploadFile = UploadFile;\n\n});\n// form方式上传图片\n_e(function (E, $) {\n\n    if (window.FileReader && window.FormData) {\n        // 如果支持 html5 上传，则返回\n        return;\n    }\n    \n    // 构造函数\n    var UploadFile = function (opt) {\n        this.editor = opt.editor;\n        this.uploadUrl = opt.uploadUrl;\n        this.timeout = opt.timeout;\n        this.fileAccept = opt.fileAccept;\n        this.multiple = false;\n    };\n\n    UploadFile.fn = UploadFile.prototype;\n\n    // clear\n    UploadFile.fn.clear = function () {\n        this.$input.val('');\n        E.log('input value 已清空');\n    };\n\n    // 隐藏modal\n    UploadFile.fn.hideModal = function () {\n        this.modal.hide();\n    };\n\n    // 渲染\n    UploadFile.fn.render = function () {\n        var self = this;\n        var editor = self.editor;\n        var uploadFileName = editor.config.uploadImgFileName || 'wangEditorFormFile';\n        if (self._hasRender) {\n            // 不要重复渲染\n            return;\n        }\n\n        // 服务器端路径\n        var uploadUrl = self.uploadUrl;\n\n        E.log('渲染dom');\n\n        // 创建 form 和 iframe\n        var iframeId = 'iframe' + E.random();\n        var $iframe = $('<iframe name=\"' + iframeId + '\" id=\"' + iframeId + '\" frameborder=\"0\" width=\"0\" height=\"0\"></iframe>');\n        var multiple = self.multiple;\n        var multipleTpl = multiple ? 'multiple=\"multiple\"' : '';\n        var $p = $('<p>选择图片并上传</p>');\n        var $input = $('<input type=\"file\" ' + multipleTpl + ' name=\"' + uploadFileName + '\"/>');\n        var $btn = $('<input type=\"submit\" value=\"上传\"/>');\n        var $form = $('<form enctype=\"multipart/form-data\" method=\"post\" action=\"' + uploadUrl + '\" target=\"' + iframeId + '\"></form>');\n        var $container = $('<div style=\"margin:10px 20px;\"></div>');\n\n        $form.append($p).append($input).append($btn);\n\n        // 增加用户配置的参数，如 token\n        $.each(editor.config.uploadParams, function (key, value) {\n            $form.append( $('<input type=\"hidden\" name=\"' + key + '\" value=\"' + value + '\"/>') );\n        });\n\n        $container.append($form);\n        $container.append($iframe);\n\n        self.$input = $input;\n        self.$iframe = $iframe;\n\n        // 生成 modal\n        var modal = new E.Modal(editor, undefined, {\n            $content: $container\n        });\n        self.modal = modal;\n\n        // 记录\n        self._hasRender = true;\n    };\n\n    // 绑定 iframe load 事件\n    UploadFile.fn.bindLoadEvent = function () {\n        var self = this;\n        if (self._hasBindLoad) {\n            // 不要重复绑定\n            return;\n        }\n\n        var editor = self.editor;\n        var $iframe = self.$iframe;\n        var iframe = $iframe.get(0);\n        var iframeWindow = iframe.contentWindow;\n        var onload = editor.config.uploadImgFns.onload;\n\n        // 定义load事件\n        function onloadFn() {\n            var resultText = $.trim(iframeWindow.document.body.innerHTML);\n            if (!resultText) {\n                return;\n            }\n\n            // 获取文件名\n            var fileFullName = self.$input.val();  // 结果如 C:\\folder\\abc.png 格式\n            var fileOriginalName = fileFullName;\n            if (fileFullName.lastIndexOf('\\\\') >= 0) {\n                // 获取 abc.png 格式\n                fileOriginalName = fileFullName.slice(fileFullName.lastIndexOf('\\\\') + 1);\n                if (fileOriginalName.indexOf('.') > 0) {\n                    // 获取 abc （即不带扩展名的文件名）\n                    fileOriginalName = fileOriginalName.split('.')[0];\n                }\n            }\n\n            // 将文件名暂存到 editor.uploadImgOriginalName ，插入图片时，可作为 alt 属性来用\n            editor.uploadImgOriginalName = fileOriginalName;\n\n            // 执行load函数，插入图片的操作，应该在load函数中执行\n            onload.call(editor, resultText);\n\n            // 清空 input 数据\n            self.clear();\n\n            // 隐藏modal\n            self.hideModal();\n        }\n\n        // 绑定 load 事件\n        if (iframe.attachEvent) {\n            iframe.attachEvent('onload', onloadFn);\n        } else {\n            iframe.onload = onloadFn;\n        }\n\n        // 记录\n        self._hasBindLoad = true;\n    };\n\n    UploadFile.fn.show = function () {\n        var self = this;\n        var modal = self.modal;\n\n        function show() {\n            modal.show();\n            self.bindLoadEvent();\n        }\n        setTimeout(show);\n    };\n\n    // 选择\n    UploadFile.fn.selectFiles = function () {\n        var self = this;\n\n        E.log('使用 form 方式上传');\n\n        // 先渲染\n        self.render();\n\n        // 先清空\n        self.clear();\n\n        // 显示\n        self.show();\n    };\n\n    // 暴露给 E\n    E.UploadFile = UploadFile;\n\n});\n// upload img 插件 粘贴图片\n_e(function (E, $) {\n    \n    E.plugin(function () {\n        var editor = this;\n        var txt = editor.txt;\n        var $txt = txt.$txt;\n        var config = editor.config;\n        var uploadImgUrl = config.uploadImgUrl;\n        var uploadFileName = config.uploadImgFileName || 'wangEditorPasteFile';\n        var pasteEvent;\n        var $imgsBeforePaste;\n\n        // 未配置上传图片url，则忽略\n        if (!uploadImgUrl) {\n            return;\n        }\n\n        // -------- 非 chrome 下，通过查找粘贴的图片的方式上传 --------\n        function findPasteImgAndUpload() {\n            var reg = /^data:(image\\/\\w+);base64/;\n            var $imgs = $txt.find('img');\n\n            E.log('粘贴后，检查到编辑器有' + $imgs.length + '个图片。开始遍历图片，试图找到刚刚粘贴过来的图片');\n\n            $.each($imgs, function () {\n                var img = this;\n                var $img = $(img);\n                var flag;\n                var base64 = $img.attr('src');\n                var type;\n\n                // 判断当前图片是否是粘贴之前的\n                $imgsBeforePaste.each(function () {\n                    if (img === this) {\n                        // 当前图片是粘贴之前的\n                        flag = true;\n                        return false;\n                    }\n                });\n\n                // 当前图片是粘贴之前的，则忽略\n                if (flag) {\n                    return;\n                }\n\n                E.log('找到一个粘贴过来的图片');\n\n                if (reg.test(base64)) {\n                    // 得到的粘贴的图片是 base64 格式，符合要求\n                    E.log('src 是 base64 格式，可以上传');\n                    type = base64.match(reg)[1];\n                    editor.xhrUploadImg({\n                        event: pasteEvent,\n                        base64: base64,\n                        fileType: type,\n                        name: uploadFileName\n                    });\n                } else {\n                    E.log('src 为 ' + base64 + ' ，不是 base64 格式，暂时不支持上传');\n                }\n\n                // 最终移除原图片\n                $img.remove();\n            });\n\n            E.log('遍历结束');\n        }\n\n        // 开始监控粘贴事件\n        $txt.on('paste', function (e) {\n            pasteEvent = e;\n            var data = pasteEvent.clipboardData || pasteEvent.originalEvent.clipboardData;\n            var text;\n            var items;\n\n            // -------- 试图获取剪切板中的文字，有文字的情况下，就不处理图片粘贴 --------\n            if (data == null) {\n                text = window.clipboardData && window.clipboardData.getData('text');\n            } else {\n                text = data.getData('text/plain') || data.getData('text/html');\n            }\n            if (text) {\n                return;\n            }\n\n            items = data && data.items;\n            if (items) {\n                // -------- chrome 可以用 data.items 取出图片 -----\n                E.log('通过 data.items 得到了数据');\n\n                $.each(items, function (key, value) {\n                    var fileType = value.type || '';\n                    if(fileType.indexOf('image') < 0) {\n                        // 不是图片\n                        return;\n                    }\n\n                    var file = value.getAsFile();\n                    var reader = new FileReader();\n\n                    E.log('得到一个粘贴图片');\n\n                    reader.onload = function (e) {\n                        E.log('读取到粘贴的图片');\n\n                        // 执行上传\n                        var base64 = e.target.result || this.result;\n                        editor.xhrUploadImg({\n                            event: pasteEvent,\n                            base64: base64,\n                            fileType: fileType,\n                            name: uploadFileName\n                        });\n                    };\n\n                    //读取粘贴的文件\n                    reader.readAsDataURL(file);\n                });\n            } else {\n                // -------- 非 chrome 不能用 data.items 取图片 -----\n\n                E.log('未从 data.items 得到数据，使用检测粘贴图片的方式');\n\n                // 获取\n                $imgsBeforePaste = $txt.find('img');\n                E.log('粘贴前，检查到编辑器有' + $imgsBeforePaste.length + '个图片');\n\n                // 异步上传找到的图片\n                setTimeout(findPasteImgAndUpload, 0);\n            }\n        });\n\n    });\n});\n// 拖拽上传图片 插件 \n_e(function (E, $) {\n\n    E.plugin(function () {\n\n        var editor = this;\n        var txt = editor.txt;\n        var $txt = txt.$txt;\n        var config = editor.config;\n        var uploadImgUrl = config.uploadImgUrl;\n        var uploadFileName = config.uploadImgFileName || 'wangEditorDragFile';\n\n        // 未配置上传图片url，则忽略\n        if (!uploadImgUrl) {\n            return;\n        }\n\n        // 阻止浏览器默认行为\n        E.$document.on('dragleave drop dragenter dragover', function (e) {\n            e.preventDefault();\n        });\n\n        // 监控 $txt drop 事件\n        $txt.on('drop', function (dragEvent) {\n            dragEvent.preventDefault();\n\n            var originalEvent = dragEvent.originalEvent;\n            var files = originalEvent.dataTransfer && originalEvent.dataTransfer.files;\n\n            if (!files || !files.length) {\n                return;\n            }\n\n            $.each(files, function (k, file) {\n                var type = file.type;\n                var name = file.name;\n\n                if (type.indexOf('image/') < 0) {\n                    // 只接收图片\n                    return;\n                }\n\n                E.log('得到图片 ' + name);\n\n                var reader = new FileReader();\n                reader.onload = function (e) {\n                    E.log('读取到图片 ' + name);\n\n                    // 执行上传\n                    var base64 = e.target.result || this.result;\n                    editor.xhrUploadImg({\n                        event: dragEvent,\n                        base64: base64,\n                        fileType: type,\n                        name: uploadFileName\n                    });\n                };\n\n                //读取粘贴的文件\n                reader.readAsDataURL(file);\n\n            });\n        });\n    });\n\n});\n// 编辑器区域 table toolbar\n_e(function (E, $) {\n\n    E.plugin(function () {\n        var editor = this;\n        var txt = editor.txt;\n        var $txt = txt.$txt;\n        var html = '';\n        // 说明：设置了 max-height 之后，$txt.parent() 负责滚动处理\n        var $currentTxt = editor.useMaxHeight ? $txt.parent() : $txt;\n        var $currentTable;\n\n        // 用到的dom节点\n        var isRendered = false;\n        var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n        var $triangle = $('<div class=\"tip-triangle\"></div>');\n        var $delete = $('<a href=\"#\"><i class=\"wangeditor-menu-img-trash-o\"></i></a>');\n        var $zoomSmall = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-minus\"></i></a>');\n        var $zoomBig = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-plus\"></i></a>');\n\n        // 渲染到页面\n        function render() {\n            if (isRendered) {\n                return;\n            }\n            \n            // 绑定事件\n            bindEvent();\n\n            // 拼接 渲染到页面上\n            $toolbar.append($triangle)\n                    .append($delete)\n                    .append($zoomSmall)\n                    .append($zoomBig);\n            editor.$editorContainer.append($toolbar);\n            isRendered = true;\n        }\n\n        // 绑定事件\n        function bindEvent() {\n            // 统一执行命令的方法\n            var commandFn;\n            function command(e, callback) {\n                // 执行命令之前，先存储html内容\n                html = $txt.html();\n                // 监控内容变化\n                var cb = function  () {\n                    if (callback) {\n                        callback();\n                    }\n                    if (html !== $txt.html()) {\n                        $txt.change();\n                    }\n                };\n                // 执行命令\n                if (commandFn) {\n                    editor.customCommand(e, commandFn, cb);\n                }\n            }\n\n            // 删除\n            $delete.click(function (e) {\n                commandFn = function () {\n                    $currentTable.remove();\n                };\n                command(e, function () {\n                    setTimeout(hide, 100);\n                });\n            });\n\n            // 放大\n            $zoomBig.click(function (e) {\n                commandFn = function () {\n                    $currentTable.css({\n                        width: '100%'\n                    });\n                };\n                command(e, function () {\n                    setTimeout(show);\n                });\n            });\n\n            // 缩小\n            $zoomSmall.click(function (e) {\n                commandFn = function () {\n                    $currentTable.css({\n                        width: 'auto'\n                    });\n                };\n                command(e, function () {\n                    setTimeout(show);\n                });\n            });\n        }\n\n        // 显示 toolbar\n        function show() {\n            if (editor._disabled) {\n                // 编辑器已经被禁用，则不让显示\n                return;\n            }\n            if ($currentTable == null) {\n                return;\n            }\n            $currentTable.addClass('clicked');\n            var tablePosition = $currentTable.position();\n            var tableTop = tablePosition.top;\n            var tableLeft = tablePosition.left;\n            var tableHeight = $currentTable.outerHeight();\n            var tableWidth = $currentTable.outerWidth();\n\n            // --- 定位 toolbar ---\n\n            // 计算初步结果\n            var top = tableTop + tableHeight;\n            var left = tableLeft;\n            var marginLeft = 0;\n\n            var txtTop = $currentTxt.position().top;\n            var txtHeight = $currentTxt.outerHeight();\n            if (top > (txtTop + txtHeight)) {\n                // top 不得超出编辑范围\n                top = txtTop + txtHeight;\n            }\n\n            // 显示（方便计算 margin）\n            $toolbar.show();\n\n            // 计算 margin\n            var width = $toolbar.outerWidth();\n            marginLeft = tableWidth / 2 - width / 2;\n\n            // 定位\n            $toolbar.css({\n                top: top + 5,\n                left: left,\n                'margin-left': marginLeft\n            });\n            // 如果定位太靠左了\n            if (marginLeft < 0) {\n                // 得到三角形的margin-left\n                $toolbar.css('margin-left', '0');\n                $triangle.hide();\n            } else {\n                $triangle.show();\n            }\n        }\n        \n        // 隐藏 toolbar\n        function hide() {\n            if ($currentTable == null) {\n                return;\n            }\n            $currentTable.removeClass('clicked');\n            $currentTable = null;\n            $toolbar.hide();\n        }\n\n        // click table 事件\n        $currentTxt.on('click', 'table', function (e) {\n            var $table = $(e.currentTarget);\n\n            // 渲染\n            render();\n\n            if ($currentTable && ($currentTable.get(0) === $table.get(0))) {\n                setTimeout(hide, 100);\n                return;\n            }\n\n            // 显示 toolbar\n            $currentTable = $table;\n            show();\n\n            // 阻止冒泡\n            e.preventDefault();\n            e.stopPropagation();\n            \n        }).on('click keydown scroll', function (e) {\n            setTimeout(hide, 100);\n        });\n        E.$body.on('click keydown scroll', function (e) {\n            setTimeout(hide, 100);\n        });\n    });\n\n});\n// 编辑器区域 img toolbar\n_e(function (E, $) {\n\n    if (E.userAgent.indexOf('MSIE 8') > 0) {\n        return;\n    }\n    \n    E.plugin(function () {\n        var editor = this;\n        var lang = editor.config.lang;\n        var txt = editor.txt;\n        var $txt = txt.$txt;\n        var html = '';\n        // 说明：设置了 max-height 之后，$txt.parent() 负责滚动处理\n        var $currentTxt = editor.useMaxHeight ? $txt.parent() : $txt;\n        var $editorContainer = editor.$editorContainer;\n        var $currentImg;\n        var currentLink = '';\n\n        // 用到的dom节点\n        var isRendered = false;\n        var $dragPoint = $('<div class=\"img-drag-point\"></div>');\n\n        var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n        var $triangle = $('<div class=\"tip-triangle\"></div>');\n\n        var $menuContainer = $('<div></div>');\n        var $delete = $('<a href=\"#\"><i class=\"wangeditor-menu-img-trash-o\"></i></a>');\n        var $zoomSmall = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-minus\"></i></a>');\n        var $zoomBig = $('<a href=\"#\"><i class=\"wangeditor-menu-img-search-plus\"></i></a>');\n        // var $floatLeft = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-left\"></i></a>');\n        // var $noFloat = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-justify\"></i></a>');\n        // var $floatRight = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-right\"></i></a>');\n        var $alignLeft = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-left\"></i></a>');\n        var $alignCenter = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-center\"></i></a>');\n        var $alignRight = $('<a href=\"#\"><i class=\"wangeditor-menu-img-align-right\"></i></a>');\n        var $link = $('<a href=\"#\"><i class=\"wangeditor-menu-img-link\"></i></a>');\n        var $unLink = $('<a href=\"#\"><i class=\"wangeditor-menu-img-unlink\"></i></a>');\n\n        var $linkInputContainer = $('<div style=\"display:none;\"></div>');\n        var $linkInput = $('<input type=\"text\" style=\"height:26px; margin-left:10px; width:200px;\"/>');\n        var $linkBtnSubmit = $('<button class=\"right\">' + lang.submit + '</button>');\n        var $linkBtnCancel = $('<button class=\"right gray\">' + lang.cancel + '</button>');\n\n        // 记录是否正在拖拽\n        var isOnDrag = false;\n\n        // 获取 / 设置 链接\n        function imgLink(e, url) {\n            if (!$currentImg) {\n                return;\n            }\n            var commandFn;\n            var callback = function () {\n                // 及时保存currentLink\n                if (url != null) {\n                    currentLink = url;\n                }\n                if (html !== $txt.html()) {\n                    $txt.change();\n                }\n            };\n            var $link;\n            var inLink = false;\n            var $parent = $currentImg.parent();\n            if ($parent.get(0).nodeName.toLowerCase() === 'a') {\n                // 父元素就是图片链接\n                $link = $parent;\n                inLink = true;\n            } else {\n                // 父元素不是图片链接，则重新创建一个链接\n                $link = $('<a target=\"_blank\"></a>');\n            }\n\n            if (url == null) {\n                // url 无值，是获取链接\n                return $link.attr('href') || '';\n            } else if (url === '') {\n                // url 是空字符串，是取消链接\n                if (inLink) {\n                    commandFn = function () {\n                        $currentImg.unwrap();\n                    };\n                }\n            } else {\n                // url 有值，是设置链接\n                if (url === currentLink) {\n                    return;\n                }\n                commandFn = function () {\n                    $link.attr('href', url);\n\n                    if (!inLink) {\n                        // 当前图片未包含在链接中，则包含进来\n                        $currentImg.wrap($link);\n                    }\n                };\n            }\n\n            // 执行命令\n            if (commandFn) {\n                // 记录下执行命令之前的html内容\n                html = $txt.html();\n                // 执行命令\n                editor.customCommand(e, commandFn, callback);\n            }\n        }\n\n        // 渲染到页面\n        function render() {\n            if (isRendered) {\n                return;\n            }\n            \n            // 绑定事件\n            bindToolbarEvent();\n            bindDragEvent();\n\n            // 菜单放入 container\n            $menuContainer.append($delete)\n                            .append($zoomSmall)\n                            .append($zoomBig)\n                            // .append($floatLeft)\n                            // .append($noFloat)\n                            // .append($floatRight);\n                            .append($alignLeft)\n                            .append($alignCenter)\n                            .append($alignRight)\n                            .append($link)\n                            .append($unLink);\n\n            // 链接input放入container\n            $linkInputContainer.append($linkInput)\n                               .append($linkBtnCancel)\n                               .append($linkBtnSubmit);\n\n            // 拼接 渲染到页面上\n            $toolbar.append($triangle)\n                    .append($menuContainer)\n                    .append($linkInputContainer);\n                    \n            editor.$editorContainer.append($toolbar).append($dragPoint);\n            isRendered = true;\n        }\n\n        // 绑定toolbar事件\n        function bindToolbarEvent() {\n            // 统一执行命令的方法\n            var commandFn;\n            function customCommand(e, callback) {\n                var cb;\n                // 记录下执行命令之前的html内容\n                html = $txt.html();\n                cb = function () {\n                    if (callback) {\n                        callback();\n                    }\n                    if (html !== $txt.html()) {\n                        $txt.change();\n                    }\n                };\n                // 执行命令\n                if (commandFn) {\n                    editor.customCommand(e, commandFn, cb);\n                }\n            }\n\n            // 删除\n            $delete.click(function (e) {\n                // 删除之前先unlink\n                imgLink(e, '');\n\n                // 删除图片\n                commandFn = function () {\n                    $currentImg.remove();\n                };\n                customCommand(e, function () {\n                    setTimeout(hide, 100);\n                });\n            });\n\n            // 放大\n            $zoomBig.click(function (e) {\n                commandFn = function () {\n                    var img = $currentImg.get(0);\n                    var width = img.width;\n                    var height = img.height;\n                    width = width * 1.1;\n                    height = height * 1.1;\n\n                    $currentImg.css({\n                        width: width + 'px',\n                        height: height + 'px'\n                    });\n                };\n                customCommand(e, function () {\n                    setTimeout(show);\n                });\n            });\n\n            // 缩小\n            $zoomSmall.click(function (e) {\n                commandFn = function () {\n                    var img = $currentImg.get(0);\n                    var width = img.width;\n                    var height = img.height;\n                    width = width * 0.9;\n                    height = height * 0.9;\n\n                    $currentImg.css({\n                        width: width + 'px',\n                        height: height + 'px'\n                    });\n                };\n                customCommand(e, function () {\n                    setTimeout(show);\n                });\n            });\n\n            // // 左浮动\n            // $floatLeft.click(function (e) {\n            //     commandFn = function () {\n            //         $currentImg.css({\n            //             float: 'left'\n            //         });\n            //     };\n            //     customCommand(e, function () {\n            //         setTimeout(hide, 100);\n            //     });\n            // });\n\n            // alignLeft\n            $alignLeft.click(function (e) {\n                commandFn = function () {\n                    // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                    $currentImg.parents('p').css({\n                        'text-align': 'left'\n                    }).attr('align', 'left');\n                };\n                customCommand(e, function () {\n                    setTimeout(hide, 100);\n                });\n            });\n\n            // // 右浮动\n            // $floatRight.click(function (e) {\n            //     commandFn = function () {\n            //         $currentImg.css({\n            //             float: 'right'\n            //         });\n            //     };\n            //     customCommand(e, function () {\n            //         setTimeout(hide, 100);\n            //     });\n            // });\n\n            // alignRight\n            $alignRight.click(function (e) {\n                commandFn = function () {\n                    // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                    $currentImg.parents('p').css({\n                        'text-align': 'right'\n                    }).attr('align', 'right');\n                };\n                customCommand(e, function () {\n                    setTimeout(hide, 100);\n                });\n            });\n\n            // // 无浮动\n            // $noFloat.click(function (e) {\n            //     commandFn = function () {\n            //         $currentImg.css({\n            //             float: 'none'\n            //         });\n            //     };\n            //     customCommand(e, function () {\n            //         setTimeout(hide, 100);\n            //     });\n            // });\n\n            // alignCenter\n            $alignCenter.click(function (e) {\n                commandFn = function () {\n                    // 如果 img 增加了链接，那么 img.parent() 就是 a 标签，设置 align 没用的，因此必须找到 P 父节点来设置 align\n                    $currentImg.parents('p').css({\n                        'text-align': 'center'\n                    }).attr('align', 'center');\n                };\n                customCommand(e, function () {\n                    setTimeout(hide, 100);\n                });\n            });\n\n            // link\n            // 显示链接input\n            $link.click(function (e) {\n                e.preventDefault();\n\n                // 获取当前链接，并显示\n                currentLink = imgLink(e);\n                $linkInput.val(currentLink);\n\n                $menuContainer.hide();\n                $linkInputContainer.show();\n            });\n            // 设置链接\n            $linkBtnSubmit.click(function (e) {\n                e.preventDefault();\n\n                var url = $.trim($linkInput.val());\n                if (url) {\n                    // 设置链接，同时会自动更新 currentLink 的值\n                    imgLink(e, url);\n                }\n\n                // 隐藏 toolbar\n                setTimeout(hide);\n            });\n            // 取消设置链接\n            $linkBtnCancel.click(function (e) {\n                e.preventDefault();\n\n                // 重置链接 input\n                $linkInput.val(currentLink);\n\n                $menuContainer.show();\n                $linkInputContainer.hide();\n            });\n\n            // unlink\n            $unLink.click(function (e) {\n                e.preventDefault();\n\n                // 执行 unlink\n                imgLink(e, '');\n\n                // 隐藏 toolbar\n                setTimeout(hide);\n            });\n        }\n\n        // 绑定drag事件\n        function bindDragEvent() {\n            var _x, _y;\n            var dragMarginLeft, dragMarginTop;\n            var imgWidth, imgHeight;\n\n            function mousemove (e) {\n                var diffX, diffY;\n\n                // 计算差额\n                diffX = e.pageX - _x;\n                diffY = e.pageY - _y;\n\n                // --------- 计算拖拽点的位置 ---------\n                var currentDragMarginLeft = dragMarginLeft + diffX;\n                var currentDragMarginTop = dragMarginTop + diffY;\n                $dragPoint.css({\n                    'margin-left': currentDragMarginLeft,\n                    'margin-top': currentDragMarginTop\n                });\n\n                // --------- 计算图片的大小 ---------\n                var currentImgWidth = imgWidth + diffX;\n                var currentImggHeight = imgHeight + diffY;\n                $currentImg && $currentImg.css({\n                    width: currentImgWidth,\n                    height: currentImggHeight\n                });\n            }\n\n            $dragPoint.on('mousedown', function(e){\n                if (!$currentImg) {\n                    return;\n                }\n                // 当前鼠标位置\n                _x = e.pageX;\n                _y = e.pageY;\n\n                // 当前拖拽点的位置\n                dragMarginLeft = parseFloat($dragPoint.css('margin-left'), 10);\n                dragMarginTop = parseFloat($dragPoint.css('margin-top'), 10);\n\n                // 当前图片的大小\n                imgWidth = $currentImg.width();\n                imgHeight = $currentImg.height();\n\n                // 隐藏 $toolbar\n                $toolbar.hide();\n\n                // 绑定计算事件\n                E.$document.on('mousemove._dragResizeImg', mousemove);\n                E.$document.on('mouseup._dragResizeImg', function (e) {\n                    // 取消绑定\n                    E.$document.off('mousemove._dragResizeImg');\n                    E.$document.off('mouseup._dragResizeImg');\n\n                    // 隐藏，并还原拖拽点的位置\n                    hide();\n                    $dragPoint.css({\n                        'margin-left': dragMarginLeft,\n                        'margin-top': dragMarginTop\n                    });\n\n                    // 记录\n                    isOnDrag = false;\n                });\n\n                // 记录\n                isOnDrag = true;\n            });\n        }\n\n        // 显示 toolbar\n        function show() {\n            if (editor._disabled) {\n                // 编辑器已经被禁用，则不让显示\n                return;\n            }\n            if ($currentImg == null) {\n                return;\n            }\n            $currentImg.addClass('clicked');\n            var imgPosition = $currentImg.position();\n            var imgTop = imgPosition.top;\n            var imgLeft = imgPosition.left;\n            var imgHeight = $currentImg.outerHeight();\n            var imgWidth = $currentImg.outerWidth();\n\n\n            // --- 定位 dragpoint ---\n            $dragPoint.css({\n                top: imgTop + imgHeight,\n                left: imgLeft + imgWidth\n            });\n\n            // --- 定位 toolbar ---\n\n            // 计算初步结果\n            var top = imgTop + imgHeight;\n            var left = imgLeft;\n            var marginLeft = 0;\n\n            var txtTop = $currentTxt.position().top;\n            var txtHeight = $currentTxt.outerHeight();\n            if (top > (txtTop + txtHeight)) {\n                // top 不得超出编辑范围\n                top = txtTop + txtHeight;\n            } else {\n                // top 超出编辑范围，dragPoint就不显示了\n                $dragPoint.show();\n            }\n\n            // 显示（方便计算 margin）\n            $toolbar.show();\n\n            // 计算 margin\n            var width = $toolbar.outerWidth();\n            marginLeft = imgWidth / 2 - width / 2;\n\n            // 定位\n            $toolbar.css({\n                top: top + 5,\n                left: left,\n                'margin-left': marginLeft\n            });\n            // 如果定位太靠左了\n            if (marginLeft < 0) {\n                // 得到三角形的margin-left\n                $toolbar.css('margin-left', '0');\n                $triangle.hide();\n            } else {\n                $triangle.show();\n            }\n\n            // disable 菜单\n            editor.disableMenusExcept();\n        }\n        \n        // 隐藏 toolbar\n        function hide() {\n            if ($currentImg == null) {\n                return;\n            }\n            $currentImg.removeClass('clicked');\n            $currentImg = null;\n\n            $toolbar.hide();\n            $dragPoint.hide();\n\n            // enable 菜单\n            editor.enableMenusExcept();\n        }\n\n        // 判断img是否是一个表情\n        function isEmotion(imgSrc) {\n            var result = false;\n            if (!editor.emotionUrls) {\n                return result;\n            }\n            $.each(editor.emotionUrls, function (index, url) {\n                var flag = false;\n                if (imgSrc === url) {\n                    result = true;\n                    flag = true;\n                }\n                if (flag) {\n                    return false;  // break 循环\n                }\n            });\n            return result;\n        }\n\n        // click img 事件\n        $currentTxt.on('mousedown', 'img', function (e) {\n            e.preventDefault();\n        }).on('click', 'img', function (e) {\n            var $img = $(e.currentTarget);\n            var src = $img.attr('src');\n\n            if (!src || isEmotion(src)) {\n                // 是一个表情图标\n                return;\n            }\n\n            // ---------- 不是表情图标 ---------- \n\n            // 渲染\n            render();\n\n            if ($currentImg && ($currentImg.get(0) === $img.get(0))) {\n                setTimeout(hide, 100);\n                return;\n            }\n\n            // 显示 toolbar\n            $currentImg = $img;\n            show();\n\n            // 默认显示menuContainer，其他默认隐藏\n            $menuContainer.show();\n            $linkInputContainer.hide();\n\n            // 阻止冒泡\n            e.preventDefault();\n            e.stopPropagation();\n            \n        }).on('click keydown scroll', function (e) {\n            if (!isOnDrag) {\n                setTimeout(hide, 100);\n            }\n        });\n\n    });\n\n});\n// 编辑区域 link toolbar\n_e(function (E, $) {\n    E.plugin(function () {\n        var editor = this;\n        var lang = editor.config.lang;\n        var $txt = editor.txt.$txt;\n\n        // 当前命中的链接\n        var $currentLink;\n\n        var $toolbar = $('<div class=\"txt-toolbar\"></div>');\n        var $triangle = $('<div class=\"tip-triangle\"></div>');\n        var $triggerLink = $('<a href=\"#\" target=\"_blank\"><i class=\"wangeditor-menu-img-link\"></i> ' + lang.openLink + '</a>');\n        var isRendered;\n\n        // 记录当前的显示/隐藏状态\n        var isShow = false;\n\n        var showTimeoutId, hideTimeoutId;\n        var showTimeoutIdByToolbar, hideTimeoutIdByToolbar;\n\n        // 渲染 dom\n        function render() {\n            if (isRendered) {\n                return;\n            }\n\n            $toolbar.append($triangle)\n                    .append($triggerLink);\n\n            editor.$editorContainer.append($toolbar);\n\n            isRendered = true;\n        }\n\n        // 定位\n        function setPosition() {\n            if (!$currentLink) {\n                return;\n            }\n\n            var position = $currentLink.position();\n            var left = position.left;\n            var top = position.top;\n            var height = $currentLink.height();\n\n            // 初步计算top值\n            var topResult = top + height + 5;\n\n            // 判断 toolbar 是否超过了编辑器区域的下边界\n            var menuHeight = editor.menuContainer.height();\n            var txtHeight = editor.txt.$txt.outerHeight();\n            if (topResult > menuHeight + txtHeight) {\n                topResult = menuHeight + txtHeight + 5;\n            }\n\n            // 最终设置\n            $toolbar.css({\n                top: topResult,\n                left: left\n            });\n        }\n\n        // 显示 toolbar\n        function show() {\n            if (isShow) {\n                return;\n            }\n\n            if (!$currentLink) {\n                return;\n            }\n\n            render();\n\n            $toolbar.show();\n\n            // 设置链接\n            var href = $currentLink.attr('href');\n            $triggerLink.attr('href', href);\n\n            // 定位\n            setPosition();\n\n            isShow = true;\n        }\n\n        // 隐藏 toolbar\n        function hide() {\n            if (!isShow) {\n                return;\n            }\n\n            if (!$currentLink) {\n                return;\n            }\n\n            $toolbar.hide();\n            isShow = false;\n        }\n\n        // $txt 绑定事件\n        $txt.on('mouseenter', 'a', function (e) {\n            // 延时 500ms 显示toolbar\n            if (showTimeoutId) {\n                clearTimeout(showTimeoutId);\n            }\n            showTimeoutId = setTimeout(function () {\n                var a = e.currentTarget;\n                var $a = $(a);\n                $currentLink = $a;\n\n                var $img = $a.children('img');\n                if ($img.length) {\n                    // 该链接下包含一个图片\n\n                    // 图片点击时，隐藏toolbar\n                    $img.click(function (e) {\n                        hide();\n                    });\n\n                    if ($img.hasClass('clicked')) {\n                        // 图片还处于clicked状态，则不显示toolbar\n                        return;\n                    }\n                }\n\n                // 显示toolbar\n                show();\n            }, 500);\n        }).on('mouseleave', 'a', function (e) {\n            // 延时 500ms 隐藏toolbar\n            if (hideTimeoutId) {\n                clearTimeout(hideTimeoutId);\n            }\n            hideTimeoutId = setTimeout(hide, 500);\n        }).on('click keydown scroll', function (e) {\n            setTimeout(hide, 100);\n        });\n        // $toolbar 绑定事件\n        $toolbar.on('mouseenter', function (e) {\n            // 先中断掉 $txt.mouseleave 导致的隐藏\n            if (hideTimeoutId) {\n                clearTimeout(hideTimeoutId);\n            }\n        }).on('mouseleave', function (e) {\n            // 延时 500ms 显示toolbar\n            if (showTimeoutIdByToolbar) {\n                clearTimeout(showTimeoutIdByToolbar);\n            }\n            showTimeoutIdByToolbar = setTimeout(hide, 500);\n        });\n    });\n});\n// menu吸顶\n_e(function (E, $) {\n\n    E.plugin(function () {\n        var editor = this;\n        var menuFixed = editor.config.menuFixed;\n        if (menuFixed === false || typeof menuFixed !== 'number') {\n            // 没有配置菜单吸顶\n            return;\n        }\n        var bodyMarginTop = parseFloat(E.$body.css('margin-top'), 10);\n        if (isNaN(bodyMarginTop)) {\n            bodyMarginTop = 0;\n        }\n\n        var $editorContainer = editor.$editorContainer;\n        var editorTop = $editorContainer.offset().top;\n        var editorHeight = $editorContainer.outerHeight();\n\n        var $menuContainer = editor.menuContainer.$menuContainer;\n        var menuCssPosition = $menuContainer.css('position');\n        var menuCssTop = $menuContainer.css('top');\n        var menuTop = $menuContainer.offset().top;\n        var menuHeight = $menuContainer.outerHeight();\n        var menuWidth = $menuContainer.width();\n\n        //重新计算宽度\n        E.$window.resize(function () {\n            menuWidth = $menuContainer.width();\n        });\n        //编辑区高度变化\n        editor.onchange = function () {\n            editorHeight = $editorContainer.outerHeight();\n            menuWidth = $menuContainer.width();//可能出现滚动条\n            menuFixedFunc();\n        };\n\n        //这个变量未使用？\n        //var $txt = editor.txt.$txt;\n\n        E.$window.scroll(menuFixedFunc);\n\n        function menuFixedFunc () {\n            //全屏模式不支持\n            if (editor.isFullScreen) {\n                return;\n            }\n\n            var sTop = E.$window.scrollTop();\n\n\n            // 如果 menuTop === 0 说明此前编辑器一直隐藏，后来显示出来了，要重新计算相关数据\n            if (menuTop === 0) {\n                menuTop = $menuContainer.offset().top;\n                editorTop = $editorContainer.offset().top;\n                editorHeight = $editorContainer.outerHeight();\n                menuHeight = $menuContainer.outerHeight();\n            }\n\n            //菜单fixed条件由离开屏幕后（sTop >= menuTop）触发改为达到menuFixed高度时（sTop + menuFixed >= menuTop）触发\n            if (sTop + menuFixed >= menuTop && sTop + menuFixed + menuHeight + 30 < editorTop + editorHeight) {\n                // 吸顶\n                $menuContainer.css({\n                    position: 'fixed',\n                    top: menuFixed\n                });\n\n                // 固定宽度\n                $menuContainer.width(menuWidth);\n\n                // 增加body margin-top\n                E.$body.css({\n                    'margin-top': bodyMarginTop + menuHeight\n                });\n\n                // 记录\n                if (!editor._isMenufixed) {\n                    editor._isMenufixed = true;\n                }\n            } else {\n                // 取消吸顶\n                $menuContainer.css({\n                    position: menuCssPosition,\n                    top: menuCssTop\n                });\n\n                // 取消宽度固定\n                $menuContainer.css('width', '100%');\n\n                // 还原 body margin-top\n                E.$body.css({\n                    'margin-top': bodyMarginTop\n                });\n\n                // 撤销记录\n                if (editor._isMenufixed) {\n                    editor._isMenufixed = false;\n                }\n            }\n        }\n    });\n\n});\n// 缩进 菜单插件\n_e(function (E, $) {\n\n    // 用 createMenu 方法创建菜单\n    E.createMenu(function (check) {\n\n        // 定义菜单id，不要和其他菜单id重复。编辑器自带的所有菜单id，可通过『参数配置-自定义菜单』一节查看\n        var menuId = 'indent';\n\n        // check将检查菜单配置（『参数配置-自定义菜单』一节描述）中是否该菜单id，如果没有，则忽略下面的代码。\n        if (!check(menuId)) {\n            return;\n        }\n\n        // this 指向 editor 对象自身\n        var editor = this;\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,  // 编辑器对象\n            id: menuId,  // 菜单id\n            title: '缩进', // 菜单标题\n\n            // 正常状态和选中装下的dom对象，样式需要自定义\n            $domNormal: $('<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-indent-left\"></i></a>'),\n            $domSelected: $('<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-indent-left\"></i></a>')\n        });\n\n        // 菜单正常状态下，点击将触发该事件\n        menu.clickEvent = function (e) {\n            var elem = editor.getRangeElem();\n            var p = editor.getSelfOrParentByName(elem, 'p');\n            var $p;\n\n            if (!p) {\n                // 未找到 p 元素，则忽略\n                return e.preventDefault();\n            }\n            $p = $(p);\n\n            // 使用自定义命令\n            function commandFn() {\n                $p.css('text-indent', '2em');\n            }\n            editor.customCommand(e, commandFn);\n        };\n\n        // 菜单选中状态下，点击将触发该事件\n        menu.clickEventSelected = function (e) {\n            var elem = editor.getRangeElem();\n            var p = editor.getSelfOrParentByName(elem, 'p');\n            var $p;\n\n            if (!p) {\n                // 未找到 p 元素，则忽略\n                return e.preventDefault();\n            }\n            $p = $(p);\n\n            // 使用自定义命令\n            function commandFn() {\n                $p.css('text-indent', '0');\n            }\n            editor.customCommand(e, commandFn);\n        };\n\n        // 根据当前选区，自定义更新菜单的选中状态或者正常状态\n        menu.updateSelectedEvent = function () {\n            // 获取当前选区所在的父元素\n            var elem = editor.getRangeElem();\n            var p = editor.getSelfOrParentByName(elem, 'p');\n            var $p;\n            var indent;\n\n            if (!p) {\n                // 未找到 p 元素，则标记为未处于选中状态\n                return false;\n            }\n            $p = $(p);\n            indent = $p.css('text-indent');\n\n            if (!indent || indent === '0px') {\n                // 得到的p，text-indent 属性是 0，则标记为未处于选中状态\n                return false;\n            }\n\n            // 找到 p 元素，并且 text-indent 不是 0，则标记为选中状态\n            return true;\n        };\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n    });\n\n});\n// 行高 菜单插件\n_e(function (E, $) {\n\n    // 用 createMenu 方法创建菜单\n    E.createMenu(function (check) {\n\n        // 定义菜单id，不要和其他菜单id重复。编辑器自带的所有菜单id，可通过『参数配置-自定义菜单』一节查看\n        var menuId = 'lineheight';\n\n        // check将检查菜单配置（『参数配置-自定义菜单』一节描述）中是否该菜单id，如果没有，则忽略下面的代码。\n        if (!check(menuId)) {\n            return;\n        }\n\n        // this 指向 editor 对象自身\n        var editor = this;\n\n        // 由于浏览器自身不支持 lineHeight 命令，因此要做一个hook\n        editor.commandHooks.lineHeight = function (value) {\n            var rangeElem = editor.getRangeElem();\n            var targetElem = editor.getSelfOrParentByName(rangeElem, 'p,h1,h2,h3,h4,h5,pre');\n            if (!targetElem) {\n                return;\n            }\n            $(targetElem).css('line-height', value + '');\n        };\n\n        // 创建 menu 对象\n        var menu = new E.Menu({\n            editor: editor,  // 编辑器对象\n            id: menuId,  // 菜单id\n            title: '行高', // 菜单标题\n            commandName: 'lineHeight', // 命令名称\n\n            // 正常状态和选中装下的dom对象，样式需要自定义\n            $domNormal: $('<a href=\"#\" tabindex=\"-1\"><i class=\"wangeditor-menu-img-arrows-v\"></i></a>'),\n            $domSelected: $('<a href=\"#\" tabindex=\"-1\" class=\"selected\"><i class=\"wangeditor-menu-img-arrows-v\"></i></a>')\n        });\n\n        // 数据源\n        var data  = {\n            // 格式： 'value' : 'title'\n            '1.0': '1.0倍',\n            '1.5': '1.5倍',\n            '1.8': '1.8倍',\n            '2.0': '2.0倍',\n            '2.5': '2.5倍',\n            '3.0': '3.0倍'\n        };\n\n        // 为menu创建droplist对象\n        var tpl = '<span style=\"line-height:{#commandValue}\">{#title}</span>';\n        menu.dropList = new E.DropList(editor, menu, {\n            data: data,  // 传入数据源\n            tpl: tpl  // 传入模板\n        });\n\n        // 增加到editor对象中\n        editor.menus[menuId] = menu;\n\n    });\n\n});\n// 自定义上传\n_e(function (E, $) {\n\n    E.plugin(function () {\n\n        var editor = this;\n        var customUpload = editor.config.customUpload;\n        if (!customUpload) {\n            return;\n        } else if (editor.config.uploadImgUrl) {\n            alert('自定义上传无效，详看浏览器日志console.log');\n            E.error('已经配置了 uploadImgUrl ，就不能再配置 customUpload ，两者冲突。将导致自定义上传无效。');\n            return;\n        }\n\n        var $uploadContent = editor.$uploadContent;\n        if (!$uploadContent) {\n            E.error('自定义上传，无法获取 editor.$uploadContent');\n        }\n\n        // UI\n        var $uploadIcon = $('<div class=\"upload-icon-container\"><i class=\"wangeditor-menu-img-upload\"></i></div>');\n        $uploadContent.append($uploadIcon);\n\n        // 设置id，并暴露\n        var btnId = 'upload' + E.random();\n        var containerId = 'upload' + E.random();\n        $uploadIcon.attr('id', btnId);\n        $uploadContent.attr('id', containerId);\n\n        editor.customUploadBtnId = btnId;\n        editor.customUploadContainerId = containerId;\n    });\n\n});\n// 版权提示\n_e(function (E, $) {\n    E.info('本页面富文本编辑器由 wangEditor 提供 http://wangeditor.github.io/ ');\n});\n    \n    // 最终返回wangEditor构造函数\n    return window.wangEditor;\n});\n\n\n// WEBPACK FOOTER //\n// ./app/commons/wangEditor/js/wangEditor.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 3IRH\n// module chunks = 1","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \".wangEditor-container{position:relative;background-color:#fff;border:1px solid #ccc;z-index:1;width:100%}.wangEditor-container a:focus,.wangEditor-container button:focus{outline:none}.wangEditor-container,.wangEditor-container *{margin:0;padding:0;box-sizing:border-box;line-height:1}.wangEditor-container img{border:none}.wangEditor-container .clearfix:after{content:\\\"\\\";display:table;clear:both}.wangEditor-container .clearfix{*zoom:1}.wangEditor-container textarea{border:none}.wangEditor-container textarea:focus{outline:none}.wangEditor-container .height-tip{position:absolute;width:3px;background-color:#ccc;left:0;transition:top .2s}.wangEditor-container .txt-toolbar{position:absolute;background-color:#fff;padding:3px 5px;border-top:2px solid #666;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-container .txt-toolbar .tip-triangle{display:block;position:absolute;width:0;height:0;border:5px solid;border-color:transparent transparent #666;top:-12px;left:50%;margin-left:-5px}.wangEditor-container .txt-toolbar a{color:#666;display:inline-block;margin:0 3px;padding:5px;text-decoration:none;border-radius:3px}.wangEditor-container .txt-toolbar a:hover{background-color:#f1f1f1}.wangEditor-container .img-drag-point{display:block;position:absolute;width:12px;height:12px;border-radius:50%;cursor:se-resize;background-color:#666;margin-left:-6px;margin-top:-6px;box-shadow:1px 1px 5px #999}.wangEditor-container .wangEditor-upload-progress{position:absolute;height:1px;background:#1e88e5;width:0;display:none;-webkit-transition:width .5s;-o-transition:width .5s;transition:width .5s}.wangEditor-fullscreen{position:fixed;top:0;bottom:0;left:0;right:0}.wangEditor-container .code-textarea{resize:none;width:100%;font-size:14px;line-height:1.5;font-family:Verdana;color:#333;padding:0 15px}.wangEditor-menu-container{width:100%;border-bottom:1px solid #f1f1f1;background-color:#fff}.wangEditor-menu-container a{text-decoration:none}.wangEditor-menu-container .menu-group{float:left;padding:0 8px;border-right:1px solid #f1f1f1}.wangEditor-menu-container .menu-item{float:left;position:relative;text-align:center;height:31px;width:35px}.wangEditor-menu-container .menu-item:hover{background-color:#f1f1f1}.wangEditor-menu-container .menu-item a{display:block;text-align:center;color:#666;width:100%;padding:8px 0;font-size:.9em}.wangEditor-menu-container .menu-item .selected{color:#1e88e5}.wangEditor-menu-container .menu-item .active{background-color:#f1f1f1}.wangEditor-menu-container .menu-item .disable{opacity:.5;filter:alpha(opacity=50)}.wangEditor-menu-container .menu-tip{display:block;position:absolute;z-index:20;width:60px;text-align:center;background-color:#666;color:#fff;padding:7px 0;font-size:12px;top:100%;left:50%;margin-left:-30px;border-radius:2px;box-shadow:1px 1px 5px #999;display:none}.wangEditor-menu-container .menu-tip-40{width:40px;margin-left:-20px}.wangEditor-menu-container .menu-tip-50{width:50px;margin-left:-25px}.wangEditor-menu-shadow{border-bottom:1px\\\\9#f1f1f1\\\\9;box-shadow:0 1px 3px #999}.wangEditor-container .wangEditor-txt{width:100%;text-align:left;padding:15px;padding-top:0;margin-top:5px;overflow-y:auto}.wangEditor-container .wangEditor-txt h1,.wangEditor-container .wangEditor-txt h2,.wangEditor-container .wangEditor-txt h3,.wangEditor-container .wangEditor-txt h4,.wangEditor-container .wangEditor-txt h5,.wangEditor-container .wangEditor-txt p{margin:10px 0;line-height:1.8}.wangEditor-container .wangEditor-txt h1 *,.wangEditor-container .wangEditor-txt h2 *,.wangEditor-container .wangEditor-txt h3 *,.wangEditor-container .wangEditor-txt h4 *,.wangEditor-container .wangEditor-txt h5 *,.wangEditor-container .wangEditor-txt p *{line-height:1.8}.wangEditor-container .wangEditor-txt ol,.wangEditor-container .wangEditor-txt ul{padding-left:20px}.wangEditor-container .wangEditor-txt img{cursor:pointer}.wangEditor-container .wangEditor-txt img.clicked,.wangEditor-container .wangEditor-txt table.clicked{box-shadow:1px 1px 10px #999}.wangEditor-container .wangEditor-txt pre code{line-height:1.5}.wangEditor-container .wangEditor-txt:focus{outline:none}.wangEditor-container .wangEditor-txt blockquote{display:block;border-left:8px solid #d0e5f2;padding:5px 10px;margin:10px 0;line-height:1.4;font-size:100%;background-color:#f1f1f1}.wangEditor-container .wangEditor-txt table{border:none;border-collapse:collapse}.wangEditor-container .wangEditor-txt table td,.wangEditor-container .wangEditor-txt table th{border:1px solid #999;padding:3px 5px;min-width:50px;height:20px}.wangEditor-container .wangEditor-txt pre{border:1px solid #ccc;background-color:#f8f8f8;padding:10px;margin:5px 0;font-size:.8em;border-radius:3px}.wangEditor-drop-list{display:none;position:absolute;background-color:#fff;overflow:hidden;z-index:10;transition:height .7s;border-top:1px solid #f1f1f1;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-drop-list a{text-decoration:none;display:block;color:#666;padding:3px 5px}.wangEditor-drop-list a:hover{background-color:#f1f1f1}.txt-toolbar,.wangEditor-drop-panel{display:none;position:absolute;padding:10px;font-size:14px;background-color:#fff;z-index:10;border-top:2px solid #666;box-shadow:1px 3px 3px #999;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.txt-toolbar .tip-triangle,.wangEditor-drop-panel .tip-triangle{display:block;position:absolute;width:0;height:0;border:5px solid;border-color:transparent transparent #666;top:-12px;left:50%;margin-left:-5px}.txt-toolbar a,.wangEditor-drop-panel a{text-decoration:none}.txt-toolbar input[type=text],.wangEditor-drop-panel input[type=text]{border:none;border-bottom:1px solid #ccc;font-size:14px;height:20px;color:#333;padding:3px 0}.txt-toolbar input[type=text]:focus,.wangEditor-drop-panel input[type=text]:focus{outline:none;border-bottom:2px solid #1e88e5}.txt-toolbar input[type=text].block,.wangEditor-drop-panel input[type=text].block{display:block;width:100%}.txt-toolbar textarea,.wangEditor-drop-panel textarea{border:1px solid #ccc}.txt-toolbar textarea:focus,.wangEditor-drop-panel textarea:focus{outline:none;border-color:#1e88e5}.txt-toolbar button,.wangEditor-drop-panel button{font-size:14px;color:#1e88e5;border:none;padding:10px;background-color:#fff;cursor:pointer;border-radius:3px}.txt-toolbar button:hover,.wangEditor-drop-panel button:hover{background-color:#f1f1f1}.txt-toolbar button:focus,.wangEditor-drop-panel button:focus{outline:none}.txt-toolbar button.right,.wangEditor-drop-panel button.right{float:right;margin-left:10px}.txt-toolbar button.gray,.wangEditor-drop-panel button.gray{color:#999}.txt-toolbar button.link,.wangEditor-drop-panel button.link{padding:5px 10px}.txt-toolbar button.link:hover,.wangEditor-drop-panel button.link:hover{background-color:#fff;text-decoration:underline}.txt-toolbar .color-item,.wangEditor-drop-panel .color-item{display:block;float:left;width:25px;height:25px;text-align:center;padding:2px;border-radius:2px;text-decoration:underline}.txt-toolbar .color-item:hover,.wangEditor-drop-panel .color-item:hover{background-color:#f1f1f1}.txt-toolbar .list-menu-item,.wangEditor-drop-panel .list-menu-item{display:block;float:left;color:#333;padding:5px;border-radius:2px}.txt-toolbar .list-menu-item:hover,.wangEditor-drop-panel .list-menu-item:hover{background-color:#f1f1f1}.txt-toolbar table.choose-table,.wangEditor-drop-panel table.choose-table{border:none;border-collapse:collapse}.txt-toolbar table.choose-table td,.wangEditor-drop-panel table.choose-table td{border:1px solid #ccc;width:16px;height:12px}.txt-toolbar table.choose-table td.active,.wangEditor-drop-panel table.choose-table td.active{background-color:#ccc;opacity:.5;filter:alpha(opacity=50)}.txt-toolbar .panel-tab .tab-container,.wangEditor-drop-panel .panel-tab .tab-container{margin-bottom:5px}.txt-toolbar .panel-tab .tab-container a,.wangEditor-drop-panel .panel-tab .tab-container a{display:inline-block;color:#999;text-align:center;margin:0 5px;padding:5px}.txt-toolbar .panel-tab .tab-container a.selected,.wangEditor-drop-panel .panel-tab .tab-container a.selected{color:#1e88e5;border-bottom:2px solid #1e88e5}.txt-toolbar .panel-tab .content-container .content,.wangEditor-drop-panel .panel-tab .content-container .content{display:none}.txt-toolbar .panel-tab .content-container .content a,.wangEditor-drop-panel .panel-tab .content-container .content a{display:inline-block;margin:2px;padding:2px;border-radius:2px}.txt-toolbar .panel-tab .content-container .content a:hover,.wangEditor-drop-panel .panel-tab .content-container .content a:hover{background-color:#f1f1f1}.txt-toolbar .panel-tab .content-container .selected,.wangEditor-drop-panel .panel-tab .content-container .selected{display:block}.txt-toolbar .panel-tab .emotion-content-container,.wangEditor-drop-panel .panel-tab .emotion-content-container{height:200px;overflow-y:auto}.txt-toolbar .upload-icon-container,.wangEditor-drop-panel .upload-icon-container{color:#ccc;text-align:center;margin:20px 20px 15px!important;padding:5px!important;font-size:65px;cursor:pointer;border:2px dotted #f1f1f1;display:block!important}.txt-toolbar .upload-icon-container:hover,.wangEditor-drop-panel .upload-icon-container:hover{color:#666;border-color:#ccc}.wangEditor-modal{position:absolute;top:50%;left:50%;background-color:#fff;border-top:1px solid #f1f1f1;box-shadow:1px 3px 3px #999;border-top:1px\\\\9#ccc\\\\9;border-left:1px\\\\9#ccc\\\\9;border-bottom:1px\\\\9#999\\\\9;border-right:1px\\\\9#999\\\\9}.wangEditor-modal .wangEditor-modal-close{position:absolute;top:0;right:0;margin-top:-25px;margin-right:-25px;font-size:1.5em;color:#666;cursor:pointer}@font-face{font-family:icomoon;src:url(\" + require(\"../fonts/icomoon.eot?-qdfu1s\") + \");src:url(\" + require(\"../fonts/icomoon.eot\") + \"?#iefix-qdfu1s) format(\\\"embedded-opentype\\\"),url(\" + require(\"../fonts/icomoon.ttf?-qdfu1s\") + \") format(\\\"truetype\\\"),url(\" + require(\"../fonts/icomoon.woff?-qdfu1s\") + \") format(\\\"woff\\\"),url(\" + require(\"../fonts/icomoon.svg?-qdfu1s\") + \"#icomoon) format(\\\"svg\\\");font-weight:400;font-style:normal}[class*=\\\" wangeditor-menu-img-\\\"],[class^=wangeditor-menu-img-]{font-family:icomoon;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.wangeditor-menu-img-link:before{content:\\\"\\\\E800\\\"}.wangeditor-menu-img-unlink:before{content:\\\"\\\\E801\\\"}.wangeditor-menu-img-code:before{content:\\\"\\\\E802\\\"}.wangeditor-menu-img-cancel:before{content:\\\"\\\\E803\\\"}.wangeditor-menu-img-terminal:before{content:\\\"\\\\E804\\\"}.wangeditor-menu-img-angle-down:before{content:\\\"\\\\E805\\\"}.wangeditor-menu-img-font:before{content:\\\"\\\\E806\\\"}.wangeditor-menu-img-bold:before{content:\\\"\\\\E807\\\"}.wangeditor-menu-img-italic:before{content:\\\"\\\\E808\\\"}.wangeditor-menu-img-header:before{content:\\\"\\\\E809\\\"}.wangeditor-menu-img-align-left:before{content:\\\"\\\\E80A\\\"}.wangeditor-menu-img-align-center:before{content:\\\"\\\\E80B\\\"}.wangeditor-menu-img-align-right:before{content:\\\"\\\\E80C\\\"}.wangeditor-menu-img-list-bullet:before{content:\\\"\\\\E80D\\\"}.wangeditor-menu-img-indent-left:before{content:\\\"\\\\E80E\\\"}.wangeditor-menu-img-indent-right:before{content:\\\"\\\\E80F\\\"}.wangeditor-menu-img-list-numbered:before{content:\\\"\\\\E810\\\"}.wangeditor-menu-img-underline:before{content:\\\"\\\\E811\\\"}.wangeditor-menu-img-table:before{content:\\\"\\\\E812\\\"}.wangeditor-menu-img-eraser:before{content:\\\"\\\\E813\\\"}.wangeditor-menu-img-text-height:before{content:\\\"\\\\E814\\\"}.wangeditor-menu-img-brush:before{content:\\\"\\\\E815\\\"}.wangeditor-menu-img-pencil:before{content:\\\"\\\\E816\\\"}.wangeditor-menu-img-minus:before{content:\\\"\\\\E817\\\"}.wangeditor-menu-img-picture:before{content:\\\"\\\\E818\\\"}.wangeditor-menu-img-file-image:before{content:\\\"\\\\E819\\\"}.wangeditor-menu-img-cw:before{content:\\\"\\\\E81A\\\"}.wangeditor-menu-img-ccw:before{content:\\\"\\\\E81B\\\"}.wangeditor-menu-img-music:before{content:\\\"\\\\E911\\\"}.wangeditor-menu-img-play:before{content:\\\"\\\\E912\\\"}.wangeditor-menu-img-location:before{content:\\\"\\\\E947\\\"}.wangeditor-menu-img-happy:before{content:\\\"\\\\E9DF\\\"}.wangeditor-menu-img-sigma:before{content:\\\"\\\\EA67\\\"}.wangeditor-menu-img-enlarge2:before{content:\\\"\\\\E98B\\\"}.wangeditor-menu-img-shrink2:before{content:\\\"\\\\E98C\\\"}.wangeditor-menu-img-newspaper:before{content:\\\"\\\\E904\\\"}.wangeditor-menu-img-camera:before{content:\\\"\\\\E90F\\\"}.wangeditor-menu-img-video-camera:before{content:\\\"\\\\E914\\\"}.wangeditor-menu-img-file-zip:before{content:\\\"\\\\E92B\\\"}.wangeditor-menu-img-stack:before{content:\\\"\\\\E92E\\\"}.wangeditor-menu-img-credit-card:before{content:\\\"\\\\E93F\\\"}.wangeditor-menu-img-address-book:before{content:\\\"\\\\E944\\\"}.wangeditor-menu-img-envelop:before{content:\\\"\\\\E945\\\"}.wangeditor-menu-img-drawer:before{content:\\\"\\\\E95C\\\"}.wangeditor-menu-img-download:before{content:\\\"\\\\E960\\\"}.wangeditor-menu-img-upload:before{content:\\\"\\\\E961\\\"}.wangeditor-menu-img-lock:before{content:\\\"\\\\E98F\\\"}.wangeditor-menu-img-unlocked:before{content:\\\"\\\\E990\\\"}.wangeditor-menu-img-wrench:before{content:\\\"\\\\E991\\\"}.wangeditor-menu-img-eye:before{content:\\\"\\\\E9CE\\\"}.wangeditor-menu-img-eye-blocked:before{content:\\\"\\\\E9D1\\\"}.wangeditor-menu-img-command:before{content:\\\"\\\\EA4E\\\"}.wangeditor-menu-img-font2:before{content:\\\"\\\\EA5C\\\"}.wangeditor-menu-img-libreoffice:before{content:\\\"\\\\EADE\\\"}.wangeditor-menu-img-quotes-left:before{content:\\\"\\\\E977\\\"}.wangeditor-menu-img-strikethrough:before{content:\\\"\\\\EA65\\\"}.wangeditor-menu-img-desktop:before{content:\\\"\\\\F108\\\"}.wangeditor-menu-img-tablet:before{content:\\\"\\\\F10A\\\"}.wangeditor-menu-img-search-plus:before{content:\\\"\\\\F00E\\\"}.wangeditor-menu-img-search-minus:before{content:\\\"\\\\F010\\\"}.wangeditor-menu-img-trash-o:before{content:\\\"\\\\F014\\\"}.wangeditor-menu-img-align-justify:before{content:\\\"\\\\F039\\\"}.wangeditor-menu-img-arrows-v:before{content:\\\"\\\\F07D\\\"}.wangeditor-menu-img-sigma2:before{content:\\\"\\\\EA68\\\"}.wangeditor-menu-img-omega:before{content:\\\"\\\\E900\\\"}.wangeditor-menu-img-cancel-circle:before{content:\\\"\\\\E901\\\"}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment{color:#998;font-style:italic}.css .rule .hljs-keyword,.hljs-keyword,.hljs-request,.hljs-status,.hljs-subst,.hljs-winutils,.nginx .hljs-title{color:#333;font-weight:700}.hljs-hexcolor,.hljs-number,.ruby .hljs-constant{color:teal}.hljs-doctag,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#d14}.hljs-id,.hljs-title,.scss .hljs-preprocessor{color:#900;font-weight:700}.hljs-list .hljs-keyword,.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type,.tex .hljs-command,.vhdl .hljs-literal{color:#458;font-weight:700}.django .hljs-tag .hljs-keyword,.hljs-rule .hljs-property,.hljs-tag,.hljs-tag .hljs-title{color:navy;font-weight:400}.hljs-attribute,.hljs-name,.hljs-variable,.lisp .hljs-body{color:teal}.hljs-regexp{color:#009926}.clojure .hljs-keyword,.hljs-prompt,.hljs-symbol,.lisp .hljs-keyword,.ruby .hljs-symbol .hljs-string,.scheme .hljs-keyword,.tex .hljs-special{color:#990073}.hljs-built_in{color:#0086b3}.hljs-cdata,.hljs-doctype,.hljs-pi,.hljs-pragma,.hljs-preprocessor,.hljs-shebang{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.diff .hljs-change{background:#0086b3}.hljs-chunk{color:#aaa}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./app/commons/wangEditor/css/wangEditor.css\n// module id = Cgxu\n// module chunks = 1","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = DuR2\n// module chunks = 1","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction placeHoldersCount (b64) {\n  var len = b64.length\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // the number of equal signs (place holders)\n  // if there are two placeholders, than the two characters before it\n  // represent one byte\n  // if there is only one, then the three characters before it represent 2 bytes\n  // this is just a cheap hack to not do indexOf twice\n  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0\n}\n\nfunction byteLength (b64) {\n  // base64 is 4/3 + up to two characters of the original data\n  return b64.length * 3 / 4 - placeHoldersCount(b64)\n}\n\nfunction toByteArray (b64) {\n  var i, j, l, tmp, placeHolders, arr\n  var len = b64.length\n  placeHolders = placeHoldersCount(b64)\n\n  arr = new Arr(len * 3 / 4 - placeHolders)\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  l = placeHolders > 0 ? len - 4 : len\n\n  var L = 0\n\n  for (i = 0, j = 0; i < l; i += 4, j += 3) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]\n    arr[L++] = (tmp >> 16) & 0xFF\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  if (placeHolders === 2) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[L++] = tmp & 0xFF\n  } else if (placeHolders === 1) {\n    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[L++] = (tmp >> 8) & 0xFF\n    arr[L++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var output = ''\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    output += lookup[tmp >> 2]\n    output += lookup[(tmp << 4) & 0x3F]\n    output += '=='\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])\n    output += lookup[tmp >> 10]\n    output += lookup[(tmp >> 4) & 0x3F]\n    output += lookup[(tmp << 2) & 0x3F]\n    output += '='\n  }\n\n  parts.push(output)\n\n  return parts.join('')\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/base64-js/index.js\n// module id = EKta\n// module chunks = 1","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/buffer/index.js\n// module id = EuP9\n// module chunks = 1","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap) {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n  var base64 = new Buffer(JSON.stringify(sourceMap)).toString('base64');\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n  return '/*# ' + data + ' */';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader/lib/css-base.js\n// module id = FZ+f\n// module chunks = 1","module.exports = __webpack_public_path__ + \"/fonts/icomoon.svg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/fonts/icomoon.svg?-qdfu1s\n// module id = SY6W\n// module chunks = 1","module.exports = __webpack_public_path__ + \"/fonts/icomoon.woff\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/fonts/icomoon.woff?-qdfu1s\n// module id = Vdmf\n// module chunks = 1","module.exports = __webpack_public_path__ + \"/fonts/icomoon.eot\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/fonts/icomoon.eot\n// module id = ZB9v\n// module chunks = 1","module.exports = __webpack_public_path__ + \"/fonts/icomoon.ttf\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/fonts/icomoon.ttf?-qdfu1s\n// module id = bjMF\n// module chunks = 1","/**\r\n * Created by 米饭 on 2017-03-15.\r\n */\r\n\r\n\r\n\r\nimport * as angular from 'angular';\r\n\r\nimport wangEditor = require('./js/wangEditor');\r\n\r\n\r\nexport default angular.module('wangEditorDirective', [])\r\n    .directive('contentEditable', contentEditable)\r\n    .name;\r\n\r\nfunction contentEditable() {\r\n    return {\r\n        restrict: 'A',\r\n        require: '?ngModel',\r\n        replace: false,\r\n        link: function (scope, element, attrs, ngModel) {\r\n            // 初始化 编辑器内容\r\n            if (!ngModel) {\r\n                return;\r\n            }\r\n            ngModel.$render = function () {\r\n                element.html(ngModel.$viewValue || '');\r\n            };\r\n            element.on('blur keyup change', function () {\r\n                scope.$apply(readViewText);\r\n            });\r\n            function readViewText() {\r\n                let html = element.html();\r\n                if (attrs.stripBr && html === '<br>') {\r\n                    html = '';\r\n                }\r\n                ngModel.$setViewValue(html);\r\n            }\r\n\r\n            // 创建编辑器\r\n            let editor = new wangEditor(element);\r\n            editor.config.menus = [\r\n                'bold', 'italic', 'strikethrough', 'head', '|',\r\n                'quote', 'unorderlist', 'orderlist', 'alignleft', 'aligncenter', 'alignright', '|',\r\n                'link', 'table', 'img', 'insertcode', '|',\r\n                'undo', 'redo', 'eraser', '|',\r\n                'source'\r\n            ];\r\n            editor.config.menuFixed = 50;\r\n            editor.create();\r\n        }\r\n    }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/commons/wangEditor/wangEditorDirective.ts","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nvar stylesInDom = {},\n\tmemoize = function(fn) {\n\t\tvar memo;\n\t\treturn function () {\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\treturn memo;\n\t\t};\n\t},\n\tisOldIE = memoize(function() {\n\t\t// Test for IE <= 9 as proposed by Browserhacks\n\t\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t\t// Tests for existence of standard globals is to allow style-loader \n\t\t// to operate correctly into non-standard environments\n\t\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\t\treturn window && document && document.all && !window.atob;\n\t}),\n\tgetElement = (function(fn) {\n\t\tvar memo = {};\n\t\treturn function(selector) {\n\t\t\tif (typeof memo[selector] === \"undefined\") {\n\t\t\t\tmemo[selector] = fn.call(this, selector);\n\t\t\t}\n\t\t\treturn memo[selector]\n\t\t};\n\t})(function (styleTarget) {\n\t\treturn document.querySelector(styleTarget)\n\t}),\n\tsingletonElement = null,\n\tsingletonCounter = 0,\n\tstyleElementsInsertedAtTop = [],\n\tfixUrls = require(\"./fixUrls\");\n\nmodule.exports = function(list, options) {\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n\tif (typeof options.insertInto === \"undefined\") options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list);\n\taddStylesToDom(styles, options);\n\n\treturn function update(newList) {\n\t\tvar mayRemove = [];\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom(styles, options) {\n\tfor(var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles(list) {\n\tvar styles = [];\n\tvar newStyles = {};\n\tfor(var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\tif(!newStyles[id])\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse\n\t\t\tnewStyles[id].parts.push(part);\n\t}\n\treturn styles;\n}\n\nfunction insertStyleElement(options, styleElement) {\n\tvar styleTarget = getElement(options.insertInto)\n\tif (!styleTarget) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\tif (options.insertAt === \"top\") {\n\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\tstyleTarget.insertBefore(styleElement, styleTarget.firstChild);\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\tstyleTarget.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\tstyleTarget.appendChild(styleElement);\n\t\t}\n\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t} else if (options.insertAt === \"bottom\") {\n\t\tstyleTarget.appendChild(styleElement);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement(styleElement) {\n\tstyleElement.parentNode.removeChild(styleElement);\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\tif(idx >= 0) {\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement(options) {\n\tvar styleElement = document.createElement(\"style\");\n\toptions.attrs.type = \"text/css\";\n\n\tattachTagAttrs(styleElement, options.attrs);\n\tinsertStyleElement(options, styleElement);\n\treturn styleElement;\n}\n\nfunction createLinkElement(options) {\n\tvar linkElement = document.createElement(\"link\");\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\tattachTagAttrs(linkElement, options.attrs);\n\tinsertStyleElement(options, linkElement);\n\treturn linkElement;\n}\n\nfunction attachTagAttrs(element, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\telement.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle(obj, options) {\n\tvar styleElement, update, remove;\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t} else if(obj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\") {\n\t\tstyleElement = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, styleElement, options);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t\tif(styleElement.href)\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t};\n\t} else {\n\t\tstyleElement = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle(newObj) {\n\t\tif(newObj) {\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\treturn;\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = styleElement.childNodes;\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\tif (childNodes.length) {\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyleElement.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag(styleElement, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyleElement.setAttribute(\"media\", media)\n\t}\n\n\tif(styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = css;\n\t} else {\n\t\twhile(styleElement.firstChild) {\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t}\n\t\tstyleElement.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink(linkElement, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/* If convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls){\n\t\tcss = fixUrls(css);\n\t}\n\n\tif(sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = linkElement.href;\n\n\tlinkElement.href = URL.createObjectURL(blob);\n\n\tif(oldSrc)\n\t\tURL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/addStyles.js\n// module id = fjbf\n// module chunks = 1","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/fixUrls.js\n// module id = quY5\n// module chunks = 1","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/isarray/index.js\n// module id = sOR5\n// module chunks = 1","module.exports = __webpack_public_path__ + \"/fonts/icomoon.eot\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/fonts/icomoon.eot?-qdfu1s\n// module id = sP74\n// module chunks = 1","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = nBytes * 8 - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/ieee754/index.js\n// module id = ujcs\n// module chunks = 1","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!./wangEditor.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!./wangEditor.css\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!./wangEditor.css\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/commons/wangEditor/css/wangEditor.css\n// module id = x7Ro\n// module chunks = 1"],"sourceRoot":""}